(()=>{var e={};e.id=789,e.ids=[789],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4072:e=>{"use strict";e.exports=require("rimraf")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},61162:(e,t,l)=>{"use strict";l.r(t),l.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d}),l(32166),l(20461),l(24513),l(57198),l(12742),l(39614),l(26083),l(19644),l(96560);var r=l(23191),n=l(88716),a=l(37922),o=l.n(a),s=l(95231),i={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>s[e]);l.d(t,i);let d=["",{children:["(admin)",{children:["pestControl",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(l.bind(l,32166)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\pestControl\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(l.bind(l,20461)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,24513)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\error.tsx"],loading:[()=>Promise.resolve().then(l.bind(l,57198)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\loading.tsx"],"not-found":[()=>Promise.resolve().then(l.bind(l,12742)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\not-found.tsx"]}]},{layout:[()=>Promise.resolve().then(l.bind(l,39614)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,26083)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\error.tsx"],loading:[()=>Promise.resolve().then(l.bind(l,19644)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(l.bind(l,96560)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\not-found.tsx"]}],u=["D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\pestControl\\page.tsx"],c="/(admin)/pestControl/page",p={require:l,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(admin)/pestControl/page",pathname:"/pestControl",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},40987:(e,t,l)=>{Promise.resolve().then(l.bind(l,15654))},15654:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>S});var r=l(10326),n=l(17577),a=l(35047),o=l(99985),s=l(34626),i=l(82650),d=l(4139),u=l(38106),c=l(37619),p=l(46821),m=l(52279),g=l(58690),C=l.n(g),h=l(56317),x=l.n(h),f=l(30735),b=l(88295),y=l.n(b);l(55675);var E=l(20341),v=l(95425),$=l(44624),_=l(97194);let{Text:T,Title:A}=o.default,S=({})=>{let[e,t]=(0,n.useState)(!1),l=(0,n.useContext)(E.Z),o=(0,a.usePathname)(),g=s.Z.useApp(),{message:h,notification:b,modal:A}=g,[S,R]=(0,n.useState)(null),[M,P]=(0,n.useState)(null),N="PEST_CONTROL",[Y,I]=(0,n.useState)(!1),[w,z]=(0,n.useState)(!1),[U,O]=(0,n.useState)(!1),[B,D]=(0,n.useState)(!1),[L,q]=(0,n.useState)(!1),[H,j]=(0,n.useState)(!1),[F,k]=(0,n.useState)(),[Z,J]=(0,n.useState)([2,"month"]),[W,G]=(0,n.useState)("TOTAL PER BULAN"),[V,X]=(0,n.useState)(0),[K,Q]=(0,n.useState)();(0,n.useEffect)(()=>{null!==S?(t(!0),(async()=>{let e="",l="";if(0==Z[0]){let t=y()(y()(S).format("YYYY-01-01")).add(1,"year");t=y()(t).subtract(1,"day"),e=y()(y()(S).format("YYYY-01-01")).format("YYYY-MM-DD"),l=y()(t).format("YYYY-MM-DD"),P(`TAHUN ${y()(e).format("YYYY").toUpperCase()}`)}else if(1==Z[0]){let t=y()(S).add(2,"month");e=y()(S).format("YYYY-MM-DD").toUpperCase(),l=y()(t).format("YYYY-MM-DD"),P(`${y()(e).format("MMMM YYYY").toUpperCase()} S/D ${y()(l).format("MMMM YYYY").toUpperCase()}`),G("TOTAL PER TRIWULAN")}else 2==Z[0]&&(e=y()(S).format("YYYY-MM-DD"),l=y()(S).format("YYYY-MM-DD"),P(`${y()(e).format("MMMM YYYY").toUpperCase()}`),G("TOTAL PER BULAN"));let r=await (0,m.Z)().get(`/report-type/${N}`);if((0,$.Z)({res:r,app:g})){let e=r?.data;void 0!==e&&(I(e.n_line_1),z(e.n_line_2),O(e.n_line_3),D(e.n_name_1),q(e.n_position_1),j(e.i_nipp_1),Q(e))}let n=await (0,m.Z)().get("/report/pest-control?start_date="+e+"&end_date="+l);if((0,$.Z)({res:n,app:g})){let e=n?.data;void 0!==e&&k(e.map((e,t)=>({no:t+1,key:t,trainset:e.i_trainset,bulan:e.i_total_month})))}t(!1)})()):k(void 0)},[S,Z,g]);let ee=C().sortBy(F,[function(e){return Number(e.trainset.replace("Trainset ",""))}]).map((e,t)=>(e.key=t,e.no=t+1,e)),[et,el]=(0,n.useState)(!1),er=async(e,t)=>{el(!0);let n=async()=>{try{if("pdf"==t){let t=0;for(let l=0;l<e.length;l++)t+=Number(`${e[l].bulan??0}`.replaceAll("Rp ","").replaceAll(".",""));let r="PERIODE : "+M;_.x4.pdf({globalState:l,reportType:K,date:r,positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:-55,fontSize:8},headStyle:{cellPadding:1,marginLeft:70,marginRight:70},columnStyles:{0:{cellWidth:10},1:{cellWidth:25},2:{cellWidth:27}},dataHead:[[{content:"NO",styles:{fontSize:8}},{content:"TRAINSET",styles:{fontSize:8}},{content:"REALISASI PEST CONTROL",styles:{fontSize:8,width:30}}]],dataBody:[...ee.map((e,t)=>[{content:t+1,styles:{valign:"middle",halign:"center",fontSize:7}},{content:e.trainset,styles:{valign:"middle",halign:"left",fontSize:7}},{content:0==e.bulan?"-":x()(e.bulan).format("0,0"),styles:{valign:"middle",halign:"center",fontSize:7}}]),[{content:`${W}`,colSpan:2,styles:{fontStyle:"bold",valign:"middle",halign:"center",fontSize:7}},{content:`${0==t?"-":x()(t).format("0,0")}`,styles:{fontStyle:"bold",valign:"middle",halign:"center",fontSize:7}}]],nameFile:`${Y} ${M}`})}else if("excel"==t){let t=new f.Workbook,l=t.addWorksheet("Sheet 1");l.mergeCells("A1:C1"),l.getCell("A1").value=Y,l.mergeCells("A2:C2"),l.getCell("A2").value=w,l.mergeCells("A3:C3"),l.getCell("A3").value=`PERIODE : ${M}`,l.getCell("A5").value="NO",l.getCell("B5").value="TRAINSET",l.getCell("C5").value="REALISASI PEST CONTROL",l.getCell("A5").fill={type:"pattern",pattern:"solid",fgColor:{argb:"79c1eb"}},l.getCell("B5").fill={type:"pattern",pattern:"solid",fgColor:{argb:"79c1eb"}},l.getCell("C5").fill={type:"pattern",pattern:"solid",fgColor:{argb:"79c1eb"}},l.columns=[{key:"test"},{key:"no"},{key:"trainset",width:30,alignment:{vertical:"middle",horizontal:"left"}},{key:"bulan",width:15,alignment:{vertical:"middle",horizontal:"right"}}],l.getColumn("A").key="no",l.getColumn("B").key="trainset",l.getColumn("C").key="bulan",ee?.forEach(function(e,t){l.addRow({no:t+1,trainset:e.trainset,bulan:0==e.bulan?"-":x()(e.bulan).format("0,0")})});let r=l.rowCount;for(let e=6;e<=r;e++)l.getCell(`A${e}`).alignment={horizontal:"center"},l.getCell(`B${e}`).alignment={horizontal:"left"},l.getCell(`C${e}`).alignment={horizontal:"center"},l.getCell(`A${e}`).font={size:9},l.getCell(`B${e}`).font={size:9},l.getCell(`C${e}`).font={size:9},e%2!=0&&(l.getCell(`A${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F5F5F5"}},l.getCell(`B${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F5F5F5"}},l.getCell(`C${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F5F5F5"}});let n=0;for(let t=0;t<e.length;t++)n+=Number(`${e[t].bulan??0}`.replaceAll("Rp ","").replaceAll(".",""));l.mergeCells(`A${r+1}:B${r+1}`),l.getCell(`A${r+1}`).value=W,l.getCell(`C${r+1}`).value=`${n}`,l.getCell(`A${r+1}`).font={bold:!0,size:9},l.getCell(`C${r+1}`).font={bold:!0,size:9},l.getCell("A1").alignment={wrapText:!1,horizontal:"left",vertical:"middle"};for(let e=1;e<=5;e++)l.getRow(e).font={bold:!0};l.getRow(5).alignment={horizontal:"center",vertical:"middle"},l.getRow(5).font={bold:!0,size:10},l.getCell(`A${r+1}`).font={bold:!0,size:9},l.getCell(`C${r+1}`).font={bold:!0,size:9},l.getCell(`A${r+1}`).alignment={horizontal:"center"},l.getCell(`C${r+1}`).alignment={horizontal:"center"};for(let e=5;e<=l.rowCount;e++)for(let t=1;t<=3;t++)l.getCell(e,t).border={top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},l.getCell(e,t).numFmt="#,##0";let a=l.rowCount,o=L.split(" ");l.mergeCells(`B${a+3}:C${a+3}`),l.mergeCells(`B${a+4}:C${a+4}`),l.mergeCells(`B${a+8}:C${a+8}`),l.mergeCells(`B${a+9}:C${a+9}`),l.getCell(`C${a+3}`).value=o[0]+" "+o[1]+" "+o[2]+" "+o[3],l.getCell(`C${a+4}`).value=o[4]+" "+o[5],l.getCell(`C${a+8}`).value=B,l.getCell(`C${a+9}`).value=`Nipp. ${H}`,l.getColumn(2).width=15,l.getColumn(3).width=15,l.getCell(`C${a+3}`).alignment={horizontal:"center"},l.getCell(`C${a+4}`).alignment={horizontal:"center"},l.getCell(`C${a+4}`).alignment={horizontal:"center"},l.getCell(`C${a+8}`).alignment={horizontal:"center"},l.getCell(`C${a+9}`).alignment={horizontal:"center"},l.getCell(`C${a+3}`).font={bold:!0,size:10},l.getCell(`C${a+4}`).font={bold:!0,size:10},l.getCell(`C${a+8}`).font={bold:!0,underline:!0,size:10},l.getCell(`C${a+9}`).font={bold:!0,size:10},l.getCell("C5").alignment={wrapText:!0,horizontal:"center"};let s=await t.xlsx.writeBuffer(),i=document.createElement("a");i.href=URL.createObjectURL(new Blob([s])),i.download=`${Y} ${M}.xlsx`,document.body.appendChild(i),i.click(),document.body.removeChild(i)}return!0}catch(e){return!1}};setTimeout(async()=>{await n()?setTimeout(()=>{h.open({type:"success",content:r.jsx("span",{className:" capitalize",children:"Export Success"})}),el(!1)},1e3):setTimeout(()=>{h.open({type:"error",content:r.jsx("span",{className:" capitalize",children:"Export Invalid"})}),el(!1)},1e3)},500)};return r.jsx(v.Z,{pathname:o,globalState:l,children:r.jsx(p.Z,{loadingExport:et,type:2==Z[0]?"month":0==Z[0]?"year":"triwulan",childrenInput:(0,r.jsxs)("div",{className:"flex flex-col ml-2",children:[r.jsx("span",{id:"subject",className:"mb-5 mt-3  text-[14px]",children:"Tipe"}),r.jsx(i.default,{disabled:et,placeholder:"Select Filter",onChange:e=>{X(V+1),R(null);let t="",l=0;"year"==e?(t="year",l=0):"triwulan"==e?(t="triwulan",l=1):(t="month",l=2),J([l,t])},defaultValue:"month",className:"max-md:w-full",options:[{value:"month",label:"Per Bulan"},{value:"triwulan",label:"Per Triwulan"},{value:"year",label:"Per Tahun"}]})]}),codeDelete:2!=Z[0]?"":N,onDelete:()=>k(void 0),data:ee,loading:e,dateChange:e=>R(e),downloadPdf:()=>er(F,"pdf"),downloadExcel:()=>er(F,"excel"),onChangeTri:V,children:r.jsx(d.Z,{children:(0,r.jsxs)(u.Z,{span:8,offset:8,children:[_.x4.web.header(K,`PERIODE : ${M}`),r.jsx(c.Z,{bordered:!0,rowClassName:_.x4.web.striped,columns:_.x4.web.headerTable([{title:"NO",dataIndex:"no",key:"no",width:"5%",align:"center",render:e=>r.jsx("a",{children:e})},{title:"TRAINSET",dataIndex:"trainset",key:"trainset",align:"center",render:e=>r.jsx("div",{style:{textAlign:"left"},children:e})},{title:"REALISASI PEST CONTROL",align:"center",dataIndex:"bulan",key:"bulan",width:"44%",render:e=>0==e?"-":x()(e).format("0,0")}]),dataSource:ee,pagination:!1,summary:e=>{let t=0;return e.forEach(({bulan:e})=>{t+=Number(`${e??0}`.replaceAll("Rp ","").replaceAll(".",""))}),(0,r.jsxs)(c.Z.Summary.Row,{children:[r.jsx(c.Z.Summary.Cell,{index:0,colSpan:2,align:"center",children:r.jsx(T,{strong:!0,children:W})}),r.jsx(c.Z.Summary.Cell,{index:1,align:"center",children:r.jsx(T,{strong:!0,children:0===t?"-":x()(t).format("0,0")})})]})}})]})})})})}},38106:(e,t,l)=>{"use strict";l.d(t,{Z:()=>r});let r=l(18467).Z},4139:(e,t,l)=>{"use strict";l.d(t,{Z:()=>r});let r=l(8651).Z},32166:(e,t,l)=>{"use strict";l.r(t),l.d(t,{$$typeof:()=>o,__esModule:()=>a,default:()=>s});var r=l(68570);let n=(0,r.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\pestControl\page.tsx`),{__esModule:a,$$typeof:o}=n;n.default;let s=(0,r.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\pestControl\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var l=e=>t(t.s=e),r=t.X(0,[3023,9400,385,1862,7296,2653,1063,961,462,124,7619,678,2207,8809,8690,9985,3627,9899,7194,6821],()=>l(61162));module.exports=r})();