(()=>{var e={};e.id=5664,e.ids=[5664],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4072:e=>{"use strict";e.exports=require("rimraf")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},588:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(86387),r(20461),r(24513),r(57198),r(12742),r(39614),r(26083),r(19644),r(96560);var n=r(23191),l=r(88716),a=r(37922),i=r.n(a),o=r(95231),s={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>o[e]);r.d(t,s);let d=["",{children:["(admin)",{children:["trainFrequency",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,86387)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\trainFrequency\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,20461)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,24513)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,57198)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12742)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\not-found.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,39614)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,26083)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,19644)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\not-found.tsx"]}],c=["D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\trainFrequency\\page.tsx"],u="/(admin)/trainFrequency/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/(admin)/trainFrequency/page",pathname:"/trainFrequency",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},85442:(e,t,r)=>{Promise.resolve().then(r.bind(r,74232))},74232:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>E});var n=r(10326),l=r(20341),a=r(17577),i=r(35047),o=r(34626),s=r(82650),d=r(4139),c=r(38106),u=r(37619);r(88295),r(52279);var p=r(97194),m=r(46821);r(44624);var g=r(95425),f=r(30735),h=r.n(f);let x=(e,t,r,n,l)=>{if(!e||0===e.length)return;let a=new(h()).Workbook;a.creator="NUTECH",a.lastModifiedBy="LRT",a.created=new Date,a.modified=new Date,a.lastPrinted=new Date;let i="calibri";n[0][0],n[0][1],n[0][2];let o=s(n[1][0],n[1][1],n[1][2],"total");function s(e,t,r,n){return"column"==n?"FF"+(e<<16|t<<8|r).toString(16).toUpperCase().padStart(6,"0"):"total"==n?"FF"+(e<<16|t<<8|r).toString(16).toUpperCase().padStart(6,"0"):void 0}let d=s(n[2][0],n[2][1],n[2][2],"total"),c=a.addWorksheet();c.getCell("A1").value=l.headerColumn,c.mergeCells("A1:F1"),c.getCell("A1").font={size:11,bold:!0,name:i},c.getCell("A2").value=l.reportColumn,c.mergeCells("A2:F2"),c.getCell("A2").font={size:11,bold:!0,name:i},c.getCell("A3").value=l.periodeColumn+""+t.toUpperCase(),c.getCell("A3").font={size:11,bold:!0,name:i};let u=["A","B","C","D"];for(let e=0;e<u.length;e++){let t=u[e]+"5";c.getCell(t).alignment={horizontal:"center",vertical:"middle"},c.getCell(t).font={size:10,name:i,bold:!0,color:{argb:n[3][0]}},c.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:d}}}let m=["D","E","F"];for(let e=0;e<m.length;e++){let t=m[e]+"6";c.getCell(t).alignment={horizontal:"center",vertical:"middle"},c.getCell(t).font={size:10,name:i,bold:!0,color:{argb:n[3][0]}},c.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:d}}}c.getCell("A5").value="NO",c.mergeCells("A5:A6"),c.getCell("B5").value="NAMA KERETA",c.mergeCells("B5:B6"),c.getCell("C5").value="LINTAS PELAYANAN",c.mergeCells("C5:C6"),c.getCell("D5").value="FREKUENSI",c.mergeCells("D5:F5"),c.getCell("D6").value="KONTRAK",c.getCell("E6").value="REALISASI",c.getCell("F6").value="SELISIH";let g={};for(let e of u){g[e]=0;for(let t=5;t<=6;t++){let r=c.getCell(`${e}${t}`).value;r&&r.toString().length>g[e]&&(g[e]=r.toString().length)}}for(let e of u)c.getColumn(e).width=g[e]+2;let f=e=>{let t=1,r="";for(let n=e.length-1;n>=0;n--){let l=e.toUpperCase().charCodeAt(n);if((l+=t)>90?(l=66,t=1):t=0,r=String.fromCharCode(l)+r,!t){r=e.substring(0,n)+r;break}}return t&&(r="A"+r),r},x=7,C=6;e?.map((e,t)=>{e.data_rows?.map((e,t)=>{let r=[t+1,p.TM(e.train_name),p.TM(e.train_route),p.TM(e.program),p.TM(e.realization),p.TM(e.difference)],n="A";C+=1,r.map(e=>{let t=n+C;c.getCell(t).value=e,c.getCell(t).font={size:9,name:i},c.getCell(t).alignment={horizontal:"center",vertical:"middle"},c.getCell(t).numFmt="#,##0_);(#,##0)",n=f(n)})}),e.summary?.map((e,t)=>{let r=["","","TOTAL",p.TM(parseInt(e.program)),p.TM(parseInt(e.realization)),p.TM(parseInt(e.difference))],n="A";C+=1,c.mergeCells("A"+C+":C"+C),r.map(e=>{let t=n+C;c.getCell(t).value=e,c.getCell(t).font={size:9,name:i,bold:!0},c.getCell(t).alignment={horizontal:"center",vertical:"middle"},c.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:o}},c.getCell(t).numFmt="#,##0_);(#,##0)",n=f(n)})}),x+=1});var y={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};return c.eachRow({includeEmpty:!0},function(e){e._number>3&&e.eachCell({includeEmpty:!0},function(e){e.border=y})}),c.getCell(`D${C+3}`).value=r?.n_position_1,c.getCell(`D${C+7}`).value=r?.n_name_1,c.getCell(`D${C+8}`).value="Nipp. "+r?.i_nipp_1,c.getCell(`D${C+3}`).font={size:10,name:i,bold:!0},c.getCell(`D${C+7}`).font={size:10,name:i,bold:!0,underline:!0},c.getCell(`D${C+8}`).font={size:10,name:i,bold:!0},c.getCell(`D${C+3}`).alignment={horizontal:"center",vertical:"middle"},c.getCell(`D${C+7}`).alignment={horizontal:"center",vertical:"middle"},c.getCell(`D${C+8}`).alignment={horizontal:"center",vertical:"middle"},c.mergeCells(`D${C+3} : F${C+3}`),c.mergeCells(`D${C+7} : F${C+7}`),c.mergeCells(`D${C+8} : F${C+8}`),a.xlsx.writeBuffer().then(e=>{let r=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(r),l=document.createElement("a");document.body.appendChild(l),l.setAttribute("style","display: none"),l.href=n,l.download="FREKUENSI KA "+t.toUpperCase()+".xlsx",l.click(),window.URL.revokeObjectURL(n),l.remove()})};var C=r(87296);let y=(e,t,r,n,l,a,i)=>{if(!e||0===e.length)return;new C.default({format:"legal",orientation:"landscape"}).internal.pageSize.width,t.split("-"),l.headerColumn,l.reportColumn,l.periodeColumn,t.toUpperCase();let o=[];e?.map((e,t)=>{e.data_rows?.map((e,t)=>{let r=[{content:t+1,styles:{halign:"center"}},{content:p.TM(e.train_name),styles:{halign:"center"}},{content:p.TM(e.train_route),styles:{halign:"center"}},{content:p.TM(e.program,p.uf(e.program)),styles:{halign:"center"}},{content:p.TM(e.realization,p.uf(e.realization)),styles:{halign:"center"}},{content:p.TM(e.difference,p.uf(e.difference)),styles:{halign:"center"}}];o.push(r)}),e.summary?.map((e,t)=>{let r=[{content:"TOTAL",colSpan:3,styles:{halign:"center",fillColor:n[1],fontStyle:"bold"}},{content:p.TM(e.program,p.uf(e.program)),styles:{halign:"center",fillColor:n[1],fontStyle:"bold"}},{content:p.TM(e.realization,p.uf(e.realization)),styles:{halign:"center",fillColor:n[1],fontStyle:"bold"}},{content:p.TM(e.difference,p.uf(e.difference)),styles:{halign:"center",fillColor:n[1],fontStyle:"bold"}}];o.push(r)})}),p.x4.pdf({globalState:i,reportType:r,date:l.periodeColumn+t.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:-10,fontSize:8},headStyle:{cellPadding:1,marginLeft:45,marginRight:0,cellWidth:20},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center",cellWidth:10}},{content:"NAMA KERETA",rowSpan:2,styles:{halign:"center",cellWidth:28}},{content:"LINTAS PELAYANAN",rowSpan:2,styles:{halign:"center",cellWidth:30}},{content:"FREKUENSI",colSpan:3,styles:{halign:"center"}}],[{content:"KONTRAK",styles:{halign:"center"}},{content:"REALISASI",styles:{halign:"center"}},{content:"SELISIH",styles:{halign:"center"}}]],dataBody:o,nameFile:"FREKUENSI KA  "+t.toUpperCase(),landscape:!1,pageSize:{width:215.9,height:355.6}})};function E(){let e=(0,a.useContext)(l.Z),t=(0,i.usePathname)(),r=o.Z.useApp(),[f,h]=(0,a.useState)([]),[C,E]=(0,a.useState)(0),[b,T]=(0,a.useState)(null),[_,A]=(0,a.useState)(),[v,N]=(0,a.useState)(null),[S,I]=(0,a.useState)(!1),[M,R]=(0,a.useState)([1,"month"]),w=e?.dataUser?.user?.username,P=[[254,249,195],[255,255,255],[121,193,235],["000000"]],U={headerColumn:_?.n_line_1,reportColumn:_?.n_line_2,periodeColumn:_?.n_line_4,periodeColumn2:"Tahun  ",dateColumn:b},F=(t,r,n,l)=>{if("pdf"==t)y(r,n,l,P,U,w,e);else{if("excel"!=t)return"";x(r,n,l,P,U)}},{message:z,notification:q,modal:D}=r,[L,H]=(0,a.useState)(!1),j=async e=>{H(!0);let t=async()=>{try{return"pdf"==e?F("pdf",v,b,_):F("excel",v,b,_),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await t()?setTimeout(()=>{z.open({type:"success",content:n.jsx("span",{className:" capitalize",children:"Export Success"})}),H(!1)},1e3):setTimeout(()=>{z.open({type:"error",content:n.jsx("span",{className:" capitalize",children:"Export Invalid"})}),H(!1)},1e3)},500)};return n.jsx(g.Z,{pathname:t,globalState:e,children:n.jsx(m.Z,{type:M[1],loadingExport:L,childrenInput:(0,n.jsxs)("div",{className:"flex flex-col ml-2",children:[n.jsx("span",{id:"subject",className:"mb-5 mt-3  text-[14px]",children:"Tipe"}),n.jsx(s.default,{disabled:L,placeholder:"Select Filter",onChange:e=>{E(C+1),h(null);let t="",r=0;"month"==e?(t="month",r=1):"triwulan"==e?(t="triwulan",r=2):"rangepicker"==e?(t="rangepicker",r=3):(t="year",r=4),R([r,t])},defaultValue:"Per Bulan",className:"max-md:w-full",options:[{value:"month",label:"Per Bulan"},{value:"triwulan",label:"Per Triwulan"},{value:"year",label:"Per Tahun"},{value:"rangepicker",label:"Per Hari"}]})]}),codeDelete:1==M[0]?"":"TRAIN_FREQUENCY",onDelete:()=>N(void 0),downloadPdf:()=>j("pdf"),downloadExcel:()=>j("excel"),onChangeTri:C,data:v,loading:S,dateChange:e=>h(e),children:n.jsx(d.Z,{children:(0,n.jsxs)(c.Z,{span:28,offset:4,children:[p.x4.web.header(_,`${U.periodeColumn+b}`),n.jsx(u.Z,{bordered:!0,rowClassName:p.x4.web.striped,pagination:!1,columns:[{title:"NO",dataIndex:"no",key:"no",align:"center",width:"3%"},{title:"NAMA KERETA",dataIndex:"train_name",key:"train_name",align:"center",width:"150px"},{title:"LINTAS PELAYANAN",dataIndex:"train_route",key:"train_route",align:"center",width:"200px"},{title:"FREKUENSI",children:[{title:"KONTRAK",dataIndex:"program",key:"program",align:"center",width:"100px"},{title:"REALISASI",dataIndex:"realization",key:"realization",align:"center",width:"100px"},{title:"SELISIH",dataIndex:"difference",key:"difference",align:"center",width:"100px"}]}],dataSource:v&&v[0]?.data_rows?v[0]?.data_rows.map((e,t)=>{let r=p.TM(e.train_name),n=p.TM(e.train_route),l=p.TM(e.program,p.uf(e.program)),a=p.TM(e.realization,p.uf(e.realization)),i=p.TM(e.difference,p.uf(e.difference)),o={...e};return o.no=t+1,o.train_name=r,o.train_route=n,o.program=l,o.realization=a,o.difference=i,o}):[],summary:()=>{let e=[];return v&&v[0]?.summary&&v[0]?.summary.map((t,r)=>{let n=p.TM(t.program,p.uf(t.program)),l=p.TM(t.realization,p.uf(t.realization)),a=p.TM(t.difference,p.uf(t.difference)),i={...t};i.no=r+1,i.program=n,i.realization=l,i.difference=a;let o={program:i.program,realization:i.realization,difference:i.difference};e.push(o)}),(0,n.jsxs)(u.Z.Summary.Row,{className:"dark:bg-black bg-tbl-footer",style:p.wF.web.bodyTotal,children:[n.jsx(u.Z.Summary.Cell,{colSpan:3,index:0,className:"text-center uppercase font-bold",children:"Total"}),n.jsx(u.Z.Summary.Cell,{index:2,className:"text-center",children:e[0].program}),n.jsx(u.Z.Summary.Cell,{index:3,className:"text-center",children:e[0].realization}),n.jsx(u.Z.Summary.Cell,{index:4,className:"text-center",children:e[0].difference})]})}})]})})})})}},38106:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=r(18467).Z},4139:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=r(8651).Z},86387:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>o});var n=r(68570);let l=(0,n.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\trainFrequency\page.tsx`),{__esModule:a,$$typeof:i}=l;l.default;let o=(0,n.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\trainFrequency\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[3023,9400,385,1862,7296,2653,1063,961,462,124,7619,678,2207,8809,3627,9899,7194,6821],()=>r(588));module.exports=n})();