(()=>{var e={};e.id=9607,e.ids=[9607],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4072:e=>{"use strict";e.exports=require("rimraf")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},86435:(e,t,l)=>{"use strict";l.r(t),l.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>g,tree:()=>d}),l(10591),l(20461),l(24513),l(57198),l(12742),l(39614),l(26083),l(19644),l(96560);var r=l(23191),n=l(88716),a=l(37922),i=l.n(a),o=l(95231),s={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>o[e]);l.d(t,s);let d=["",{children:["(admin)",{children:["fumigasi",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(l.bind(l,10591)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\fumigasi\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(l.bind(l,20461)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,24513)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\error.tsx"],loading:[()=>Promise.resolve().then(l.bind(l,57198)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\loading.tsx"],"not-found":[()=>Promise.resolve().then(l.bind(l,12742)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\not-found.tsx"]}]},{layout:[()=>Promise.resolve().then(l.bind(l,39614)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,26083)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\error.tsx"],loading:[()=>Promise.resolve().then(l.bind(l,19644)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(l.bind(l,96560)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\not-found.tsx"]}],u=["D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\fumigasi\\page.tsx"],c="/(admin)/fumigasi/page",p={require:l,loadChunk:()=>Promise.resolve()},g=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(admin)/fumigasi/page",pathname:"/fumigasi",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},49159:(e,t,l)=>{Promise.resolve().then(l.bind(l,11060))},11060:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>T});var r=l(10326),n=l(35047),a=l(17577),i=l(20341),o=l(95425),s=l(30735),d=l(87296),u=l(88295),c=l.n(u),p=l(99985),g=l(34626),m=l(82650),C=l(4139),f=l(38106),x=l(37619),h=l(58690),b=l.n(h),y=l(56317),_=l.n(y),A=l(52279),E=l(46821),v=l(44624),M=l(97194);let{Text:$,Title:I}=p.default,R=()=>{let e=g.Z.useApp(),{message:t,notification:l,modal:n}=e,[o,u]=(0,a.useState)(),[p,h]=(0,a.useState)(!1),[y,I]=(0,a.useState)(),[R,T]=(0,a.useState)(),[N,S]=(0,a.useState)(null),P=(0,a.useContext)(i.Z),[Y,w]=(0,a.useState)([1,"rangepicker"]),[U,B]=(0,a.useState)("TOTAL PER BULAN"),[z,F]=(0,a.useState)(0),D=new Intl.NumberFormat("id-ID",{style:"decimal",maximumFractionDigits:2});(0,a.useEffect)(()=>{let t=async()=>{let t=await (0,A.Z)().get("report-type/FUMIGASI"),l="",r="";if(2==Y[0]){let e=c()(R).add(2,"month");l=c()(R).format("YYYY-MM-DD").toUpperCase(),r=c()(e).format("YYYY-MM-DD"),S(`${c()(l).format("MMMM YYYY").toUpperCase()} S/D ${c()(r).format("MMMM YYYY").toUpperCase()}`),B("TOTAL PER TRIWULAN")}else 1==Y[0]?(l=c()(R).format("YYYY-MM-DD"),r=c()(R).format("YYYY-MM-DD"),S(`${c()(l).format("MMMM YYYY").toUpperCase()}`),B("TOTAL PER BULAN")):3==Y[0]&&(l=`${c()(R).format("YYYY")}-01-01`,r=`${c()(R).format("YYYY")}-12-01`,S(`TAHUN ${c()(l).format("YYYY").toUpperCase()}`),B("TOTAL PER TAHUN"));let n=await (0,A.Z)().get("report/fumigasi?start_date="+l+"&end_date="+r);(0,v.Z)({res:n,app:e})&&(n.data.length?u(n.data.map((e,t)=>({no:t+1,key:t,trainset:e.i_trainset,bulan:e.i_total_month}))):u(void 0)),(0,v.Z)({res:t,app:e})&&I(t?.data),h(!1)};R&&(h(!0),t())},[R,Y,e]);let q=async(e,t)=>{new d.default;let l=0;for(let t=0;t<e.length;t++)l+=Number(`${e[t].bulan??0}`.replaceAll("Rp ","").replaceAll(".",""));let r="PERIODE : "+N;M.x4.pdf({globalState:P,reportType:t,date:r,positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:-43,fontSize:8},headStyle:{cellPadding:1,marginLeft:70,marginRight:60},columnStyles:{0:{cellWidth:10},1:{cellWidth:25},2:{cellWidth:40}},dataHead:[[{content:"NO",styles:{fontSize:8}},{content:"TRAINSET",styles:{fontSize:8}},{content:"REALISASI FUMIGASI",styles:{fontSize:8}}]],dataBody:[...k.map((e,t)=>[{content:t+1,styles:{valign:"middle",halign:"center",fontSize:7}},{content:e.trainset,styles:{valign:"middle",halign:"left",fontSize:7}},{content:0==e.bulan?"-":_()(e.bulan).format("0,0"),styles:{valign:"middle",halign:"center",fontSize:7}}]),[{content:`${U}`,colSpan:2,styles:{fontStyle:"bold",valign:"middle",halign:"center",fontSize:7}},{content:`${0==l?"-":_()(l).format("0,0")}`,styles:{fontStyle:"bold",valign:"middle",halign:"center",fontSize:7}}]],nameFile:t.n_line_1+" "+N})},H=async(e,t)=>{let l=new s.Workbook,r=l.addWorksheet("Sheet 1");c()(`${c()(R).format("YYYY")}-${c()(R).format("MM")}-01`).format("MMMM"),t.n_line_3.split(" "),t.n_position_1.split(" "),r.mergeCells("A1:C1"),r.getCell("A1").value=t.n_line_1,r.mergeCells("A2:C2"),r.getCell("A2").value=t.n_line_2,r.mergeCells("A3:C3"),r.getCell("A3").value=`PERIODE : ${N}`,r.getCell("A5").value="NO",r.getCell("B5").value="TRAINSET",r.getCell("C5").value="REALISASI FUMIGASI",r.columns=[{key:"no"},{key:"trainset",width:15},{key:"bulan",width:20}],r.getColumn("A").key="no",r.getColumn("B").key="trainset",r.getColumn("C").key="bulan",e.forEach(function(e,t){r.addRow({no:t+1,trainset:e.trainset,bulan:0==e.bulan?"-":e.bulan})});let n=r.rowCount;for(let e=6;e<=n;e++)r.getCell(`A${e}`).alignment={horizontal:"center"},r.getCell(`B${e}`).alignment={horizontal:"left"},r.getCell(`C${e}`).alignment={horizontal:"center"},r.getCell(`A${e}`).font={size:9},r.getCell(`B${e}`).font={size:9},r.getCell(`C${e}`).font={size:9},e%2!=0&&(r.getCell(`A${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F5F5F5"}},r.getCell(`B${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F5F5F5"}},r.getCell(`C${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F5F5F5"}});let a=0;for(let t=0;t<e.length;t++)a+=Number(`${e[t].bulan??0}`.replaceAll("Rp ","").replaceAll(".",""));r.mergeCells(`A${n+1}:B${n+1}`),r.getCell(`A${n+1}`).value=U,r.getCell(`C${n+1}`).value=`${0==a?"-":a}`,r.getCell("B1").font={bold:!0,size:11},r.getCell("A1").alignment={wrapText:!0},r.getCell(`A${n+1}`).font={bold:!0,size:9},r.getCell(`C${n+1}`).font={bold:!0,size:9},r.getRow(2).font={bold:!0},r.getRow(3).font={bold:!0},r.getRow(4).font={bold:!0},r.getRow(5).font={bold:!0},r.getRow(4).alignment={horizontal:"center",vertical:"middle"},r.getRow(5).alignment={horizontal:"center",vertical:"middle"},r.getCell(`A${n+1}`).alignment={horizontal:"center"},r.getCell(`C${n+1}`).alignment={horizontal:"center"};for(let e=5;e<=r.rowCount;e++)for(let t=1;t<=3;t++)r.getCell(e,t).border={top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},r.getCell(e,t).numFmt="#,##0";let i=r.rowCount;r.mergeCells(`B${i+3}:C${i+3}`),r.mergeCells(`B${i+4}:C${i+4}`),r.mergeCells(`B${i+8}:C${i+8}`),r.mergeCells(`B${i+9}:C${i+9}`);let o=(t?.n_position_1).split("AND");r.getCell(`B${i+3}`).value=o[0]?o[0]:t?.n_position_1,r.getCell(`B${i+4}`).value=o[1]?"AND "+o[1]:"",r.getCell(`B${i+8}`).value=`${t.n_name_1}`,r.getCell(`B${i+9}`).value=`Nipp. ${t.i_nipp_1}`,r.getCell(`C${i+3}`).font={bold:!0,size:10},r.getCell(`C${i+4}`).font={bold:!0,size:10},r.getCell(`C${i+8}`).font={bold:!0,underline:!0,size:10},r.getCell(`C${i+9}`).font={bold:!0,size:10},r.getCell(`C${i+3}`).alignment={horizontal:"center"},r.getCell(`C${i+4}`).alignment={horizontal:"center"},r.getCell(`C${i+8}`).alignment={horizontal:"center"},r.getCell(`C${i+9}`).alignment={horizontal:"center"},r.getCell("A5").fill={type:"pattern",pattern:"solid",fgColor:{argb:"79c1eb"}},r.getCell("B5").fill={type:"pattern",pattern:"solid",fgColor:{argb:"79c1eb"}},r.getCell("C5").fill={type:"pattern",pattern:"solid",fgColor:{argb:"79c1eb"}},r.getRow(5).font={bold:!0,size:10};let d=await l.xlsx.writeBuffer(),u=document.createElement("a");u.href=URL.createObjectURL(new Blob([d])),u.download=`${t.n_line_1} ${N}.xlsx`,document.body.appendChild(u),u.click(),document.body.removeChild(u)},[j,L]=(0,a.useState)(!1),O=async e=>{L(!0);let l=async()=>{try{return"pdf"==e?q(k,y):H(k,y),!0}catch(e){return!1}};setTimeout(async()=>{await l()?setTimeout(()=>{t.open({type:"success",content:r.jsx("span",{className:" capitalize",children:"Export Success"})}),L(!1)},1e3):setTimeout(()=>{t.open({type:"error",content:r.jsx("span",{className:" capitalize",children:"Export Invalid"})}),L(!1)},1e3)},500)},k=b().sortBy(o,[function(e){return Number(e.trainset.replace("Trainset ",""))}]).map((e,t)=>(e.key=t,e.no=t+1,e));return r.jsx(E.Z,{type:1==Y[0]?"month":2==Y[0]?"triwulan":"year",loadingExport:j,childrenInput:(0,r.jsxs)("div",{className:"flex flex-col ml-2",children:[r.jsx("span",{id:"subject",className:"mb-5 mt-3  text-[14px]",children:"Tipe"}),r.jsx(m.default,{disabled:j,placeholder:"Select Filter",onChange:e=>{F(z+1),T(null);let t="",l=0;"rangepicker"==e?(t="rangepicker",l=1):"triwulan"==e?(t="month",l=2):(t="year",l=3),w([l,t])},defaultValue:"Per Bulan",className:"max-md:w-full",options:[{value:"rangepicker",label:"Per Bulan"},{value:"triwulan",label:"Per Triwulan"},{value:"year",label:"Per Tahun"}]})]}),codeDelete:1!=Y[0]?"":"FUMIGASI",onDelete:()=>u(void 0),data:k,loading:p,dateChange:e=>{T(e)},downloadPdf:()=>O("pdf"),downloadExcel:()=>O("excel"),onChangeTri:z,children:r.jsx(C.Z,{children:(0,r.jsxs)(f.Z,{span:9,offset:7,children:[M.x4.web.header(y,`PERIODE : ${N}`),r.jsx(x.Z,{rowClassName:M.x4.web.striped,dataSource:k,columns:M.x4.web.headerTable([{title:"NO",dataIndex:"no",key:"no",width:"3%",align:"center",render:e=>r.jsx("a",{children:e})},{title:"TRAINSET",dataIndex:"trainset",key:"trainset",align:"center",width:"40%",render:e=>r.jsx("div",{style:{textAlign:"left"},children:e})},{title:"REALISASI FUMIGASI",dataIndex:"bulan",key:"bulan",width:"50%",align:"center",render:e=>0==e?"-":D.format(e)}]),bordered:!0,pagination:!1,summary:e=>{let t=0;return e.forEach(({bulan:e})=>{t+=Number(`${e??0}`.replaceAll("Rp ","").replaceAll(".",""))}),r.jsx(r.Fragment,{children:(0,r.jsxs)(x.Z.Summary.Row,{children:[r.jsx(x.Z.Summary.Cell,{index:0,colSpan:2,align:"center",children:r.jsx($,{strong:!0,children:U})}),r.jsx(x.Z.Summary.Cell,{className:"font-bold",index:1,align:"center",children:r.jsx($,{children:0===t?"-":_()(t).format("0,0")})})]})})}})]})})})},T=({})=>{let e=(0,a.useContext)(i.Z),t=(0,n.usePathname)();return r.jsx(o.Z,{pathname:t,globalState:e,children:r.jsx(R,{})})}},38106:(e,t,l)=>{"use strict";l.d(t,{Z:()=>r});let r=l(18467).Z},4139:(e,t,l)=>{"use strict";l.d(t,{Z:()=>r});let r=l(8651).Z},10591:(e,t,l)=>{"use strict";l.r(t),l.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>o});var r=l(68570);let n=(0,r.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\fumigasi\page.tsx`),{__esModule:a,$$typeof:i}=n;n.default;let o=(0,r.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\fumigasi\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var l=e=>t(t.s=e),r=t.X(0,[3023,9400,385,1862,7296,2653,1063,961,462,124,7619,678,2207,8809,8690,9985,3627,9899,7194,6821],()=>l(86435));module.exports=r})();