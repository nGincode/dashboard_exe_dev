(()=>{var e={};e.id=4879,e.ids=[4879],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4072:e=>{"use strict";e.exports=require("rimraf")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},36e3:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>_,originalPathname:()=>b,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(71282),r(20461),r(24513),r(57198),r(12742),r(39614),r(26083),r(19644),r(96560);var l=r(23191),n=r(88716),a=r(37922),o=r.n(a),i=r(95231),s={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>i[e]);r.d(t,s);let d=["",{children:["(admin)",{children:["recapPerformanceByRelation",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,71282)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\recapPerformanceByRelation\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,20461)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,24513)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,57198)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12742)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\not-found.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,39614)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,26083)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,19644)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\not-found.tsx"]}],c=["D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\recapPerformanceByRelation\\page.tsx"],b="/(admin)/recapPerformanceByRelation/page",_={require:r,loadChunk:()=>Promise.resolve()},p=new l.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(admin)/recapPerformanceByRelation/page",pathname:"/recapPerformanceByRelation",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},84446:(e,t,r)=>{Promise.resolve().then(r.bind(r,86793))},86793:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var l=r(10326),n=r(20341),a=r(17577),o=r.n(a),i=r(35047),s=r(88295),d=r.n(s),c=r(34626),b=r(82650);r(52279);var _=r(97194),p=r(46821),m=r(95425);r(44624);var h=r(87296);let g=(e,t,r,l,n,a,o)=>{if(!e||0===e.length)return;new h.default({format:"legal",orientation:"landscape"}).internal.pageSize.width;let i=n.dateColumn.split(" ");i[0],i[1],n.headerColumn,n.reportColumn,n.periodeColumn,t.toUpperCase();let s=[],c=[];e?.map((e,t)=>{0==t&&(e.data_rows.map((e,t)=>{let r=_.TM(e.c_station_start),l=_.TM(e.c_station_end),n=_.TM(e.i_distance,_.Gx(e.i_distance,".",",")),a=_.TM(e.i_train_frequency,_.uf(e.i_train_frequency)),o=_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat)),i=_.TM(e.i_td_km,_.uf(e.i_td_km)),c=_.TM(e.i_volume_pnp,_.uf(e.i_volume_pnp)),b=_.TM(e.i_km_pnp,_.uf(e.i_km_pnp)),p=_.TM(e.i_income,_.uf(e.i_income)),m=""===_.TM(e.i_o_static)?"":"-"===_.TM(e.i_o_static)?"-":e.i_o_static+"%",h=""===_.TM(e.i_o_dynamic)?"":"-"===_.TM(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",g=new Date(e?.d_opr),u=d()(g);d()(u).format("DD/MM/YYYY");let f=[{content:t+=1,styles:{halign:"center"}},{content:r,styles:{halign:"center"}},{content:l,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:a,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:i,styles:{halign:"center"}},{content:c,styles:{halign:"center"}},{content:b,styles:{halign:"center"}},{content:p,styles:{halign:"right"}},{content:m,styles:{halign:"center"}},{content:h,styles:{halign:"center"}}];s.push(f)}),e.summary.map((e,t)=>{let r=_.TM(e.i_train_frequency,_.uf(e.i_train_frequency)),n=_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat)),a=_.TM(e.i_td_km,_.uf(e.i_td_km)),o=_.TM(e.i_volume_pnp,_.uf(e.i_volume_pnp)),i=_.TM(e.i_km_pnp,_.uf(e.i_km_pnp)),d=_.TM(e.i_income,_.uf(e.i_income)),c=""===_.TM(e.i_o_static)?"":"-"===_.TM(e.i_o_static)?"-":e.i_o_static+"%",b=""===_.TM(e.i_o_dynamic)?"":"-"===_.TM(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",p=[{content:"TOTAL",colSpan:4,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:r,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:n,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:a,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:o,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:i,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:d,styles:{halign:"right",fillColor:l[1],fontStyle:"bold"}},{content:c,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:b,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}}];s.push(p)})),1==t&&(e.data_rows.map((e,t)=>{let r=_.TM(e.c_station_start),l=_.TM(e.c_station_end),n=_.TM(e.i_distance,_.Gx(e.i_distance,".",",")),a=_.TM(e.i_train_frequency,_.uf(e.i_train_frequency)),o=_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat)),i=_.TM(e.i_td_km,_.uf(e.i_td_km)),s=_.TM(e.i_volume_pnp,_.uf(e.i_volume_pnp)),b=_.TM(e.i_km_pnp,_.uf(e.i_km_pnp)),p=_.TM(e.i_income,_.uf(e.i_income)),m=""===_.TM(e.i_o_static)?"":"-"===_.TM(e.i_o_static)?"-":e.i_o_static+"%",h=""===_.TM(e.i_o_dynamic)?"":"-"===_.TM(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",g=new Date(e?.d_opr),u=d()(g);d()(u).format("DD/MM/YYYY");let f=[{content:t+=1,styles:{halign:"center"}},{content:r,styles:{halign:"center"}},{content:l,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:a,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:i,styles:{halign:"center"}},{content:s,styles:{halign:"center"}},{content:b,styles:{halign:"center"}},{content:p,styles:{halign:"right"}},{content:m,styles:{halign:"center"}},{content:h,styles:{halign:"center"}}];c.push(f)}),e.summary.map((e,t)=>{let r=_.TM(e.i_train_frequency,_.uf(e.i_train_frequency)),n=_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat)),a=_.TM(e.i_td_km,_.uf(e.i_td_km)),o=_.TM(e.i_volume_pnp,_.uf(e.i_volume_pnp)),i=_.TM(e.i_km_pnp,_.uf(e.i_km_pnp)),s=_.TM(e.i_income,_.uf(e.i_income)),d=""===_.TM(e.i_o_static)?"":"-"===_.TM(e.i_o_static)?"-":e.i_o_static+"%",b=""===_.TM(e.i_o_dynamic)?"":"-"===_.TM(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",p=[{content:"TOTAL",colSpan:4,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:r,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:n,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:a,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:o,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:i,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:s,styles:{halign:"right",fillColor:l[1],fontStyle:"bold"}},{content:d,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}},{content:b,styles:{halign:"center",fillColor:l[1],fontStyle:"bold"}}];c.push(p)}))}),_.x4.pdf({globalState:o,reportType:r,date:n.periodeColumn+t.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:10,fontSize:8},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center"}},{content:"ASAL",rowSpan:2,styles:{halign:"center"}},{content:"TUJUAN",rowSpan:2,styles:{halign:"center"}},{content:"JARAK (KM) \n GAPEKA",rowSpan:2,styles:{halign:"center",cellWidth:20}},{content:"FREK KA",rowSpan:2,styles:{halign:"center",cellWidth:18}},{content:"TEMPAT DUDUK PENUMPANG",rowSpan:2,styles:{halign:"center",cellWidth:24}},{content:"TD - KM",rowSpan:2,styles:{halign:"center"}},{content:"VOLUME PNP",rowSpan:2,styles:{halign:"center"}},{content:"KM - PNP",rowSpan:2,styles:{halign:"center"}},{content:"PENDAPATAN",rowSpan:2,styles:{halign:"center"}},{content:"OKUPANSI",colSpan:2,styles:{halign:"center"}}],[{content:"STATIS",styles:{halign:"center"}},{content:"DINAMIS",styles:{halign:"center"}}],[{content:"1",styles:{halign:"center"}},{content:"2",styles:{halign:"center"}},{content:"3",styles:{halign:"center"}},{content:"4",styles:{halign:"center"}},{content:"5",styles:{halign:"center"}},{content:"6",styles:{halign:"center"}},{content:"7",styles:{halign:"center"}},{content:"8",styles:{halign:"center"}},{content:"9",styles:{halign:"center"}},{content:"10",styles:{halign:"center"}},{content:"11",styles:{halign:"center"}},{content:"12",styles:{halign:"center"}},{content:"13",styles:{halign:"center"}}]],headStyle:{cellPadding:1},dataBody:s,newTable:[{headStyle:{cellPadding:1,marginLeft:14,marginRight:14},next:!0,dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center"}},{content:"ASAL",rowSpan:2,styles:{halign:"center"}},{content:"TUJUAN",rowSpan:2,styles:{halign:"center"}},{content:"JARAK (KM) \n GAPEKA",rowSpan:2,styles:{halign:"center",cellWidth:20}},{content:"FREK KA",rowSpan:2,styles:{halign:"center",cellWidth:18}},{content:"TEMPAT DUDUK PENUMPANG",rowSpan:2,styles:{halign:"center",cellWidth:24}},{content:"TD - KM",rowSpan:2,styles:{halign:"center"}},{content:"VOLUME PNP",rowSpan:2,styles:{halign:"center"}},{content:"KM - PNP",rowSpan:2,styles:{halign:"center"}},{content:"PENDAPATAN",rowSpan:2,styles:{halign:"center"}},{content:"OKUPANSI",colSpan:2,styles:{halign:"center"}}],[{content:"STATIS",styles:{halign:"center"}},{content:"DINAMIS",styles:{halign:"center"}}],[{content:"1",styles:{halign:"center"}},{content:"2",styles:{halign:"center"}},{content:"3",styles:{halign:"center"}},{content:"4",styles:{halign:"center"}},{content:"5",styles:{halign:"center"}},{content:"6",styles:{halign:"center"}},{content:"7",styles:{halign:"center"}},{content:"8",styles:{halign:"center"}},{content:"9",styles:{halign:"center"}},{content:"10",styles:{halign:"center"}},{content:"11",styles:{halign:"center"}},{content:"12",styles:{halign:"center"}},{content:"13",styles:{halign:"center"}}]],dataBody:c}],nameFile:"REKAPITULASI KINERJA PER RELASI "+t.toUpperCase()+".pdf",landscape:!1,pageSize:{width:215.9,height:355.6}})};var u=r(30735),f=r.n(u);let y=(e,t,r,l,n)=>{if(!e||0===e.length)return;let a=new(f()).Workbook;a.creator="NUTECH",a.lastModifiedBy="LRT",a.created=new Date,a.modified=new Date,a.lastPrinted=new Date;let o="calibri",i=l[0][0],s=l[0][1],c=l[0][2],b=l[1][0],p=l[1][1],m=l[1][2];function h(e,t,r,l){return"column"==l?"FF"+(e<<16|t<<8|r).toString(16).toUpperCase().padStart(6,"0"):"total"==l?"FF"+(e<<16|t<<8|r).toString(16).toUpperCase().padStart(6,"0"):void 0}h(i,s,c,"column");let g=h(b,p,m,"total"),u=h(l[2][0],l[2][1],l[2][2],"total"),y=a.addWorksheet();y.getCell("A1").value=n.headerColumn,y.mergeCells("A1:L1"),y.getCell("A1").font={size:11,bold:!0,name:o},y.getCell("A2").value=n.reportColumn,y.mergeCells("A2:L2"),y.getCell("A2").font={size:11,bold:!0,name:o},d()(e?.[0].i_period_year+"-"+e?.[0].i_period_month+"-1","YYYY-M-D").format("MMMM YYYY");let x=n.dateColumn.split(" ");x[0],x[1],y.getCell("A3").value=n.periodeColumn+t.toUpperCase(),y.mergeCells("A3:L3"),y.getCell("A3").font={size:11,bold:!0,name:o};let T=["A","B","C","D","E","F","G","H","I","J","K","L"];for(let e=0;e<T.length;e++){let t=T[e]+"5";y.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},y.getCell(t).font={size:9,name:o,bold:!0,color:{argb:l[3][0]}},y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}let C=["K","L"];for(let e=0;e<C.length;e++){let t=C[e]+"6";y.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},y.getCell(t).font={size:9,name:o,bold:!0,color:{argb:l[3][0]}},y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}y.getCell("A5").value="NO",y.mergeCells("A5:A6"),y.getCell("B5").value="ASAL",y.mergeCells("B5:B6"),y.getCell("C5").value="TUJUAN",y.mergeCells("C5:C6"),y.getCell("D5").value="JARAK (KM) \n GAPEKA",y.mergeCells("D5:D6"),y.getCell("E5").value="FREK KA",y.mergeCells("E5:E6"),y.getCell("F5").value="TEMPAT DUDUK \n PENUMPANG",y.mergeCells("F5:F6"),y.getCell("G5").value="TD-KM",y.mergeCells("G5:G6"),y.getCell("H5").value="VOLUME PNP",y.mergeCells("H5:H6"),y.getCell("I5").value="KM - PNP",y.mergeCells("I5:I6"),y.getCell("J5").value="PENDAPATAN",y.mergeCells("J5:J6"),y.getCell("K5").value="OKUPANSI",y.mergeCells("K5:L5"),y.getCell("K6").value="STATIS",y.getCell("L6").value="DINAMIS";let k={};for(let e of T){k[e]=0;for(let t=5;t<=6;t++){let r=y.getCell(`${e}${t}`).value;r&&r.toString().length>k[e]&&(k[e]=r.toString().length)}}for(let e of T)y.getColumn(e).width=k[e]+2;for(let e of T){let t=y.getColumn(e);"D"===e&&(t.width=13),"F"===e&&(t.width=16),"G"===e&&(t.width=10)}let M=e=>{let t=1,r="";for(let l=e.length-1;l>=0;l--){let n=e.toUpperCase().charCodeAt(l);if((n+=t)>90?(n=65,t=1):t=0,r=String.fromCharCode(n)+r,!t){r=e.substring(0,l)+r;break}}return t&&(r="A"+r),r},w=6,N=7;e?.map((e,t)=>{if(0==t){let t="A";for(let e=0;e<12;e++)y.getCell(t+7).value=e+1,y.getCell(t+7).font={bold:!0},y.getCell(t+7).alignment={horizontal:"center",vertical:"middle"},y.getCell(t+7).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}},y.getCell(t+7).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},t=M(t);e.data_rows?.map((e,t)=>{let r=[t+=1,_.TM(e.c_station_start),_.TM(e.c_station_end),_.TM(e.i_distance),_.TM(e.i_train_frequency),_.TM(e.i_passenger_seat),_.TM(e.i_td_km),_.TM(e.i_volume_pnp),_.TM(e.i_km_pnp),_.TM(e.i_income),""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%"],l="A",n="E",a=1;N+=1,r.map(e=>{let t=l+N;y.getCell(t).value=e,y.getCell(t).alignment={horizontal:"center",vertical:"middle"},y.getCell("J:"+N).alignment={horizontal:"right",vertical:"middle"},y.getCell(t).font={size:9,name:o},7!==a&&(y.getCell(n+N).numFmt="#,##0_);(#,##0)",n=M(n),a+=1),l=M(l)})}),e.summary?.map((e,t)=>{let r=_.TM(e.i_train_frequency),l=_.TM(e.i_passenger_seat),n=_.TM(e.i_td_km),a=_.TM(e.i_volume_pnp),i=_.TM(e.i_km_pnp),s=_.TM(e.i_income),d=""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",c=""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%",b="D",p="E",m=1;N+=1,["TOTAL",r,l,n,a,i,s,d,c].map((e,t)=>{if(0==t){let t="A"+N;y.getCell(t).value=e,y.mergeCells("A"+N+":D"+N),y.getCell("A"+N+":D"+N).alignment={horizontal:"center",vertical:"middle"},y.getCell("J:"+N).alignment={horizontal:"right",vertical:"middle"},y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},y.getCell(t).font={size:9,name:o,bold:!0}}else{let t=b+N;y.getCell(t).value=e,y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},y.getCell(t).alignment={horizontal:"center",vertical:"middle"},y.getCell("J:"+N).alignment={horizontal:"right",vertical:"middle"},y.getCell(t).font={size:9,name:o,bold:!0},7!==m&&(y.getCell(p+N).numFmt="#,##0_);(#,##0)",p=M(p),m+=1)}b=M(b)})}),w+=1}}),N+=1;for(let e=0;e<T.length;e++){let t=T[e]+(N+1);y.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},y.getCell(t).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}for(let e=0;e<C.length;e++){let t=C[e]+(N+2);y.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},y.getCell(t).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}for(let e of(y.getCell(`A${N+1}`).value="NO",y.mergeCells(`A${N+1}:A${N+2}`),y.getCell(`B${N+1}`).value="ASAL",y.mergeCells(`B${N+1}:B${N+2}`),y.getCell(`C${N+1}`).value="TUJUAN",y.mergeCells(`C${N+1}:C${N+2}`),y.getCell(`D${N+1}`).value="JARAK (KM) \n GAPEKA",y.mergeCells(`D${N+1}:D${N+2}`),y.getCell(`E${N+1}`).value="FREK KA",y.mergeCells(`E${N+1}:E${N+2}`),y.getCell(`F${N+1}`).value="TEMPAT DUDUK \n PENUMPANG",y.mergeCells(`F${N+1}:F${N+2}`),y.getCell(`G${N+1}`).value="TD-KM",y.mergeCells(`G${N+1}:G${N+2}`),y.getCell(`H${N+1}`).value="VOLUME PNP",y.mergeCells(`H${N+1}:H${N+2}`),y.getCell(`I${N+1}`).value="KM - PNP",y.mergeCells(`I${N+1}:I${N+2}`),y.getCell(`J${N+1}`).value="PENDAPATAN",y.mergeCells(`J${N+1}:J${N+2}`),y.getCell(`K${N+1}`).value="OKUPANSI",y.mergeCells(`K${N+1}:L${N+1}`),y.getCell(`K${N+2}`).value="STATIS",y.getCell(`L${N+2}`).value="DINAMIS",T)){k[e]=0;for(let t=5;t<=6;t++){let r=y.getCell(`${e}${t}`).value;r&&r.toString().length>k[e]&&(k[e]=r.toString().length)}}for(let e of T)y.getColumn(e).width=k[e]+2;for(let e of T){let t=y.getColumn(e);"D"===e&&(t.width=13),"F"===e&&(t.width=16),"G"===e&&(t.width=10)}N+=3,e?.map((e,t)=>{if(1==t){let t="A";for(let e=0;e<12;e++)y.getCell(t+N).value=e+1,y.getCell(t+N).font={bold:!0},y.getCell(t+N).alignment={horizontal:"center",vertical:"middle"},y.getCell(t+N).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}},y.getCell(t+N).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},t=M(t);e.data_rows?.map((e,t)=>{let r=[t+=1,_.TM(e.c_station_start),_.TM(e.c_station_end),_.TM(e.i_distance),_.TM(e.i_train_frequency),_.TM(e.i_passenger_seat),_.TM(e.i_td_km),_.TM(e.i_volume_pnp),_.TM(e.i_km_pnp),_.TM(e.i_income),""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%"],l="A",n="E",a=1;N+=1,r.map(e=>{let t=l+N;y.getCell(t).value=e,y.getCell(t).alignment={horizontal:"center",vertical:"middle"},y.getCell("J:"+N).alignment={horizontal:"right",vertical:"middle"},y.getCell(t).font={size:9,name:o},7!==a&&(y.getCell(n+N).numFmt="#,##0_);(#,##0)",n=M(n),a+=1),l=M(l)})}),e.summary?.map((e,t)=>{let r=_.TM(e.i_train_frequency),l=_.TM(e.i_passenger_seat),n=_.TM(e.i_td_km),a=_.TM(e.i_volume_pnp),i=_.TM(e.i_km_pnp),s=_.TM(e.i_income),d=""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",c=""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%",b="D",p="E",m=1;N+=1,["TOTAL",r,l,n,a,i,s,d,c].map((e,t)=>{if(0==t){let t="A"+N;y.getCell(t).value=e,y.mergeCells("A"+N+":D"+N),y.getCell("A"+N+":D"+N).alignment={horizontal:"center",vertical:"middle"},y.getCell("J:"+N).alignment={horizontal:"right",vertical:"middle"},y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},y.getCell(t).font={size:9,name:o,bold:!0}}else{let t=b+N;y.getCell(t).value=e,y.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},y.getCell(t).alignment={horizontal:"center",vertical:"middle"},y.getCell("J:"+N).alignment={horizontal:"right",vertical:"middle"},y.getCell(t).font={size:9,name:o,bold:!0},7!==m&&(y.getCell(p+N).numFmt="#,##0_);(#,##0)",p=M(p),m+=1)}b=M(b)})}),w+=1}});var v={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};y.eachRow({includeEmpty:!0},function(e){e._number>3&&e.eachCell({includeEmpty:!0},function(e){e.border=v})}),y.getRow(N+2);let A=r?.n_position_1.split(" "),S=" ",j=" ";for(let e=0;e<A.length;e++)e<=3?S+=` ${A[e]}`:j+=` ${A[e]}`;let P=y.rowCount+1;return y.addRow(["","","","","","","","",S]).font={name:"calibri",bold:!0},y.getCell(`I${P}`).alignment={vertical:"middle",horizontal:"center"},y.mergeCells(`I${P}:L${P}`),y.getCell(`I${P}`).font={size:10,name:o,bold:!0},P=y.rowCount+1,y.addRow(["","","","","","","","",j]).font={name:"calibri",bold:!0},y.getCell(`I${P}`).alignment={vertical:"middle",horizontal:"center"},y.mergeCells(`I${P}:L${P}`),y.getCell(`I${P}`).font={size:10,name:o,bold:!0},y.getCell(`I${N+8}`).value=r?.n_name_1,y.getCell(`I${N+8}`).font={size:10,name:o,bold:!0,underline:!0},y.getCell(`I${N+8}`).alignment={horizontal:"center",vertical:"middle",wrapText:!0},y.mergeCells(`I${N+8} : L${N+8}`),y.getCell(`I${N+9}`).value="Nipp. "+r?.i_nipp_1,y.getCell(`I${N+9}`).font={size:10,name:o,bold:!0},y.getCell(`I${N+9}`).alignment={horizontal:"center",vertical:"middle"},y.mergeCells(`I${N+9} : L${N+9}`),y.getRow(6).font={bold:!0,size:10},y.getRow(5).font={bold:!0,size:10},a.xlsx.writeBuffer().then(e=>{let r=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(r),n=document.createElement("a");document.body.appendChild(n),n.setAttribute("style","display: none"),n.href=l,n.download="REKAPITULASI KINERJA PER RELASI "+t.toUpperCase()+".xlsx",n.click(),window.URL.revokeObjectURL(l),n.remove()})};function x(){let e=(0,a.useContext)(n.Z),t=(0,i.usePathname)(),r=c.Z.useApp(),[s,h]=(0,a.useState)([null,null]),[u,f]=(0,a.useState)(null),[x,T]=(0,a.useState)(),[C,k]=(0,a.useState)(null),[M,w]=(0,a.useState)(!1),[N,v]=(0,a.useState)([1,"month"]),[A,S]=(0,a.useState)(0),j=e?.dataUser?.user?.username,P=[[254,249,195],[255,255,255],[121,193,235],["000000"]],E={headerColumn:x?.n_line_1,reportColumn:x?.n_line_2,periodeColumn:x?.n_line_4,periodeColumn2:"Tahun  ",dateColumn:u},I=(t,r,l,n)=>{if("pdf"==t)g(r,l,n,P,E,j,e);else{if("excel"!=t)return"";y(r,l,n,P,E)}},{message:U,notification:D,modal:$}=r,[R,K]=(0,a.useState)(!1),z=async e=>{K(!0);let t=async()=>{try{return"pdf"==e?I("pdf",C,u,x):I("excel",C,u,x),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await t()?setTimeout(()=>{U.open({type:"success",content:l.jsx("span",{className:" capitalize",children:"Export Success"})}),K(!1)},1e3):setTimeout(()=>{U.open({type:"error",content:l.jsx("span",{className:" capitalize",children:"Export Invalid"})}),K(!1)},1e3)},500)};return l.jsx(m.Z,{pathname:t,globalState:e,children:(0,l.jsxs)(p.Z,{type:N[1],loadingExport:R,childrenInput:(0,l.jsxs)("div",{className:"flex flex-col ml-2",children:[l.jsx("span",{id:"subject",className:"mb-5 mt-3  text-[14px]",children:"Tipe"}),l.jsx(b.default,{disabled:R,placeholder:"Select Filter",onChange:e=>{S(A+1);let t="",r=0;"month"==e?(t="month",r=1):"triwulan"==e?(t="triwulan",r=2):(t="year",r=4),v([r,t])},defaultValue:"month",className:"max-md:w-full",options:[{value:"month",label:"Per Bulan"},{value:"triwulan",label:"Per Triwulan"},{value:"year",label:"Per Tahun"}]})]}),onDelete:()=>k(void 0),data:C,loading:M,dateChange:e=>h(e),downloadPdf:()=>z("pdf"),downloadExcel:()=>z("excel"),onChangeTri:A,children:[_.x4.web.header(x,`${E.periodeColumn+u}`),(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"w-full mb-6 table-auto border-collapse border border-solid dark:border-white border-black uppercase",style:{whiteSpace:"nowrap"},children:[(0,l.jsxs)("thead",{className:"dark:bg-black bg-tbl-header",style:_.wF.web.headerTable,children:[(0,l.jsxs)("tr",{children:[l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Asal"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Tujuan"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[l.jsx("p",{children:"Jarak (Km)"}),l.jsx("p",{children:" Gapeka"})]})}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Frek KA"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[l.jsx("p",{children:" Tempat Duduk"}),l.jsx("p",{children:" Penumpang"})]})}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"TD-KM"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Volume PNP"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"KM-PNP"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Pendapatan"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",colSpan:2,children:"Okupansi"})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Statis"}),l.jsx("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Dinamis"})]}),l.jsx("tr",{children:(()=>{let e=[];for(let t=0;t<12;t++)e.push(l.jsx("td",{className:"border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),l.jsx("tbody",{style:_.wF.web.bodyTable,children:C?.map((e,t)=>{let r=new Date(e?.summary[0]?.d_opr);return d()(r),l.jsxs(o().Fragment,{children:[0==t&&e.data_rows?.map((e,t)=>{let r=t%2==0?"even-row dark:even-row":"";return l.jsxs("tr",{className:`text-center ${r}`,children:[l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:t+1}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.c_station_start)}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.c_station_end)}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_distance,_.Gx(e.i_distance,".",","))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_train_frequency,_.uf(e.i_train_frequency))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_td_km,_.uf(e.i_td_km))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.uf(e.i_volume_pnp)}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_volume_pnp,_.uf(e.i_km_pnp))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:_.TM(e.i_income,_.uf(e.i_income))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_static)?"-":""===_.TM(e.i_o_static)?_.TM(""):_.TM(e.i_o_static)+"%"}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_dynamic)?"-":""===_.TM(e.i_o_dynamic)?_.TM(""):_.TM(e.i_o_dynamic)+"%"})]},t)}),0==t&&e.summary?.map((e,t)=>l.jsxs("tr",{className:"text-center font-bold dark:bg-black bg-tbl-footer",style:_.wF.web.bodyTotal,children:[l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",colSpan:4,children:"Total"}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_train_frequency,_.uf(e.i_train_frequency))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_td_km,_.uf(e.i_td_km))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_volume_pnp,_.uf(e.i_volume_pnp))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_km_pnp,_.uf(e.i_km_pnp))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:_.TM(e.i_income,_.uf(e.i_income))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_static,_.uf(e.i_o_static))?"-":""===_.TM(e.i_o_static,_.uf(e.i_o_static))?_.TM(""):_.TM(e.i_o_static,_.uf(e.i_o_static))+"%"}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_dynamic,_.uf(e.i_o_dynamic))?"-":""===_.TM(e.i_o_dynamic,_.uf(e.i_o_dynamic))?_.TM(""):_.TM(e.i_o_dynamic,_.uf(e.i_o_dynamic))+"%"})]},`summary_${t}`))]},t)})})]}),(0,l.jsxs)("table",{className:"w-full mb-5 table-auto border-collapse border border-solid dark:border-white border-black uppercase",style:{whiteSpace:"nowrap"},children:[(0,l.jsxs)("thead",{className:"dark:bg-black bg-tbl-header",style:_.wF.web.headerTable,children:[(0,l.jsxs)("tr",{children:[l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Asal"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Tujuan"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[l.jsx("p",{children:"Jarak (Km)"}),l.jsx("p",{children:" Gapeka"})]})}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Frek KA"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[l.jsx("p",{children:" Tempat Duduk"}),l.jsx("p",{children:" Penumpang"})]})}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"TD-KM"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Volume PNP"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"KM-PNP"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Pendapatan"}),l.jsx("th",{className:" px-2 border border-solid dark:border-white border-black",colSpan:2,children:"Okupansi"})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Statis"}),l.jsx("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Dinamis"})]}),l.jsx("tr",{children:(()=>{let e=[];for(let t=0;t<12;t++)e.push(l.jsx("td",{className:"border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),l.jsx("tbody",{style:_.wF.web.bodyTable,children:C?.map((e,t)=>{let r=new Date(e?.summary[0]?.d_opr);return d()(r),l.jsxs(o().Fragment,{children:[1==t&&e.data_rows?.map((e,t)=>{let r=t%2==0?"even-row dark:even-row":"";return l.jsxs("tr",{className:`text-center ${r}`,children:[l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:t+1}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.c_station_start)}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.c_station_end)}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_distance,_.Gx(e.i_distance,".",","))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_train_frequency,_.uf(e.i_train_frequency))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_td_km,_.uf(e.i_td_km))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.uf(e.i_volume_pnp)}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_volume_pnp,_.uf(e.i_km_pnp))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:_.TM(e.i_income,_.uf(e.i_income))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_static)?"-":""===_.TM(e.i_o_static)?_.TM(""):_.TM(e.i_o_static)+"%"}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_dynamic)?"-":""===_.TM(e.i_o_dynamic)?_.TM(""):_.TM(e.i_o_dynamic)+"%"})]},t)}),1==t&&e.summary?.map((e,t)=>l.jsxs("tr",{className:"text-center font-bold dark:bg-black bg-tbl-footer",style:_.wF.web.bodyTotal,children:[l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",colSpan:4,children:"Total"}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_train_frequency,_.uf(e.i_train_frequency))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_passenger_seat,_.uf(e.i_passenger_seat))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_td_km,_.uf(e.i_td_km))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_volume_pnp,_.uf(e.i_volume_pnp))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:_.TM(e.i_km_pnp,_.uf(e.i_km_pnp))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:_.TM(e.i_income,_.uf(e.i_income))}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_static,_.uf(e.i_o_static))?"-":""===_.TM(e.i_o_static,_.uf(e.i_o_static))?_.TM(""):_.TM(e.i_o_static,_.uf(e.i_o_static))+"%"}),l.jsx("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===_.TM(e.i_o_dynamic,_.uf(e.i_o_dynamic))?"-":""===_.TM(e.i_o_dynamic,_.uf(e.i_o_dynamic))?_.TM(""):_.TM(e.i_o_dynamic,_.uf(e.i_o_dynamic))+"%"})]},`summary_${t}`))]},t)})})]})]})]})})}},71282:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>a,default:()=>i});var l=r(68570);let n=(0,l.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\recapPerformanceByRelation\page.tsx`),{__esModule:a,$$typeof:o}=n;n.default;let i=(0,l.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\recapPerformanceByRelation\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),l=t.X(0,[3023,9400,385,1862,7296,2653,678,2207,8809,3627,9899,7194,6821],()=>r(36e3));module.exports=l})();