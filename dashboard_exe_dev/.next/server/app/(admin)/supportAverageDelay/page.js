(()=>{var e={};e.id=9019,e.ids=[9019],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4072:e=>{"use strict";e.exports=require("rimraf")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},8266:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>d}),r(78061),r(20461),r(24513),r(57198),r(12742),r(39614),r(26083),r(19644),r(96560);var l=r(23191),a=r(88716),n=r(37922),o=r.n(n),s=r(95231),i={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>s[e]);r.d(t,i);let d=["",{children:["(admin)",{children:["supportAverageDelay",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,78061)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\supportAverageDelay\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,20461)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,24513)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,57198)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12742)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\not-found.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,39614)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,26083)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,19644)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\not-found.tsx"]}],c=["D:\\FEMBI NUR ILHAM\\NUTECH\\PROJECT\\dashboard_executive_cms\\app\\(admin)\\supportAverageDelay\\page.tsx"],p="/(admin)/supportAverageDelay/page",u={require:r,loadChunk:()=>Promise.resolve()},h=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(admin)/supportAverageDelay/page",pathname:"/supportAverageDelay",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},84206:(e,t,r)=>{Promise.resolve().then(r.bind(r,92581))},92581:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var l=r(10326),a=r(17577),n=r.n(a),o=r(35047),s=r(95425),i=r(88295),d=r.n(i),c=r(34626);r(52279);var p=r(46821),u=r(20341),h=r(97194);r(44624);var g=r(30735),b=r.n(g);let m=(e,t,r,l,a)=>{if(!e||0===e.length)return;let n=new(b()).Workbook;n.creator="NUTECH",n.lastModifiedBy="LRT",n.created=new Date,n.modified=new Date,n.lastPrinted=new Date;let o="calibri",s=l[0][0],i=l[0][1],c=l[0][2],p=l[1][0],u=l[1][2],g=l[1][3];function m(e,t,r,l){return"column"==l?"FF"+(e<<16|t<<8|r).toString(16).toUpperCase().padStart(6,"0"):"total"==l?"FF"+(e<<16|t<<8|r).toString(16).toUpperCase().padStart(6,"0"):void 0}let x=m(s,i,c,"column");m(p,u,g,"total");let C=m(l[2][0],l[2][1],l[2][2],"total"),f=n.addWorksheet();f.getCell("A1").value=a.headerColumn,f.mergeCells("A1:H1"),f.getCell("A1").font={size:11,bold:!0,name:o},f.getCell("A2").value=a.reportColumn,f.mergeCells("A2:H2"),f.getCell("A2").font={size:11,bold:!0,name:o},d()(e?.[0].i_period_year+"-"+e?.[0].i_period_month+"-1","YYYY-M-D").format("MMMM YYYY"),f.getCell("A3").value=a.periodeColumn+""+t.toUpperCase(),f.getCell("A3").font={size:11,bold:!0,name:o};let _=["A","B","C","D","E","H"];for(let e=0;e<_.length;e++){let t=_[e]+"5";f.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(t).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}}}let y=["E","F","G"];for(let e=0;e<y.length;e++){let t=y[e]+"6";f.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(t).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}}}f.getCell("A5").value="NO",f.mergeCells("A5:A6"),f.getCell("B5").value="TANGGAL",f.mergeCells("B5:B6"),f.getCell("C5").value="TRAINSET KA",f.mergeCells("C5:C6"),f.getCell("D5").value="NOMOR KA",f.mergeCells("D5:D6"),f.getCell("E5").value="REALISASI",f.mergeCells("E5:G5"),f.getCell("E6").value="BER",f.getCell("F6").value="DAT",f.getCell("G6").value="WT",f.getCell("H5").value="KETERANGAN",f.mergeCells("H5:H6");let w={};for(let e of _){w[e]=0;for(let t=5;t<=6;t++){let r=f.getCell(`${e}${t}`).value;r&&r.toString().length>w[e]&&(w[e]=r.toString().length)}}for(let e of _){let t=f.getColumn(e);"B"===e?t.width=20:t.width=w[e]+2}let A=e=>{let t=1,r="";for(let l=e.length-1;l>=0;l--){let a=e.toUpperCase().charCodeAt(l);if((a+=t)>90?(a=65,t=1):t=0,r=String.fromCharCode(a)+r,!t){r=e.substring(0,l)+r;break}}return t&&(r="A"+r),r},v=7,T=7,N=e.length;e?.map((e,t)=>{let r="A";if(0==t)for(let e=0;e<8;e++)f.getCell(r+7).value=e+1,f.getCell(r+7).font={bold:!0},f.getCell(r+7).alignment={horizontal:"center",vertical:"middle"},f.getCell(r+7).font={size:10,name:o,bold:!0,color:{argb:l[3][0]}},f.getCell(r+7).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}},r=A(r);e.data_rows.length,e.data_rows?.map((e,t)=>{let r=new Date(e.d_opr),l=d()(r),a=[t+1,d()(l).format("DD MMMM YYYY"),h.TM(e.n_train),h.TM(e.c_noka),h.TM(e.t_r_departure),h.TM(e.t_r_arrive),h.TM(e.t_r_traveling),""],n="A";T+=1,a.map((e,t)=>{let r=n+T;f.getCell(r).value=e,f.getCell(r).alignment={horizontal:"center",vertical:"middle"},f.getCell(r).font={size:9,name:o},f.getCell("C:"+T).numFmt="#,##0_);(#,##0)",n=A(n)})}),t+1!=N&&(T+=1,f.getCell("A"+T+":H"+T).value="",f.mergeCells("A"+T+":H"+T),f.getCell("A"+T).fill={type:"pattern",pattern:"solid",fgColor:{argb:x}}),v+=1});var E={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};return f.eachRow({includeEmpty:!0},function(e){e._number>3&&e.eachCell({includeEmpty:!0},function(e){e.border=E})}),f.getCell(`G${T+3}`).value=r?.n_position_1,f.getCell(`G${T+7}`).value=r?.n_name_1,f.getCell(`G${T+8}`).value="Nipp. "+r?.i_nipp_1,f.getCell(`G${T+3}`).font={size:10,name:o,bold:!0},f.getCell(`G${T+7}`).font={size:10,name:o,bold:!0,underline:!0},f.getCell(`G${T+8}`).font={size:10,name:o,bold:!0},f.getCell(`G${T+3}`).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(`G${T+7}`).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(`G${T+8}`).alignment={horizontal:"center",vertical:"middle"},f.mergeCells(`G${T+3} : H${T+3}`),f.mergeCells(`G${T+7} : H${T+7}`),f.mergeCells(`G${T+8} : H${T+8}`),n.xlsx.writeBuffer().then(e=>{let r=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(r),a=document.createElement("a");document.body.appendChild(a),a.setAttribute("style","display: none"),a.href=l,a.download="PENDUKUNG KELAMBATAN RATA RATA "+t.toUpperCase()+".xlsx",a.click(),window.URL.revokeObjectURL(l),a.remove()})};var x=r(87296);let C=(e,t,r,l,a,n,o)=>{if(!e||0===e.length)return;new x.default({format:"legal",orientation:"landscape"}).internal.pageSize.width,a.headerColumn,a.reportColumn,a.periodeColumn,t.toUpperCase();let s=[],i=[];[1,2,3,4,5,6,7,8].map(e=>{let t={content:e,styles:{halign:"center",fillColor:l[2],textColor:l[3],fontSize:"7",font:"calibri",fontStyle:"bold"}};i.push(t)}),s.push(i),e?.map((t,r)=>{let a=e.length;if(t.data_rows?.map((e,t)=>{let r=new Date(e.d_opr),l=d()(r),a=[{content:t+1,styles:{halign:"center"}},{content:d()(l).format("DD MMMM YYYY"),styles:{halign:"center"}},{content:h.TM(e.n_train,h.uf(e.n_train)),styles:{halign:"center"}},{content:h.TM(e.c_noka),styles:{halign:"center"}},{content:h.TM(e.t_r_departure),styles:{halign:"center"}},{content:h.TM(e.t_r_arrive),styles:{halign:"center"}},{content:h.TM(e.t_r_traveling),styles:{halign:"center"}},""];s.push(a)}),r+1!=a){let e=[{content:"",colSpan:19,styles:{halign:"center",fillColor:l[0]}}];s.push(e)}}),h.x4.pdf({globalState:o,reportType:r,date:a.periodeColumn+t.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:-4,fontSize:8},headStyle:{cellPadding:1,marginLeft:30,marginRight:30,cellWidth:20},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center",cellWidth:10}},{content:"TANGGAL",rowSpan:2,styles:{halign:"center"}},{content:"TRAINSET KA",rowSpan:2,styles:{halign:"center",cellWidth:20}},{content:"NOMOR KA",rowSpan:2,styles:{halign:"center"}},{content:"REALISASI",colSpan:3,styles:{halign:"center"}},{content:"KETERANGAN",rowSpan:2,styles:{halign:"center"}}],[{content:"BER",styles:{halign:"center"}},{content:"DAT",styles:{halign:"center"}},{content:"WT",styles:{halign:"center"}},{content:"MENIT",styles:{halign:"center"}},{content:"JAM",styles:{halign:"center"}},{content:"MENIT",styles:{halign:"center"}},{content:"PROGRAM",styles:{halign:"center"}},{content:"REALISASI",styles:{halign:"center"}},{content:"MENIT",styles:{halign:"center"}},{content:"(%)",styles:{halign:"center"}}]],dataBody:s,nameFile:"PENDUKUNG KELAMBATAN RATA RATA "+t.toUpperCase(),landscape:!1})};function f(){let e=(0,a.useContext)(u.Z),t=(0,o.usePathname)(),r=c.Z.useApp(),[i,g]=(0,a.useState)([null,null]),[b,x]=(0,a.useState)(null),[f,_]=(0,a.useState)(),[y,w]=(0,a.useState)(null),[A,v]=(0,a.useState)(!1),T=1,N=[[219,215,215],[244,244,244],[121,193,235],["000000"]],E=e?.dataUser?.user?.username,M={headerColumn:f?.n_line_1,reportColumn:f?.n_line_2,periodeColumn:f?.n_line_4,periodeColumn2:"Tahun  ",dateColumn:b},k=(t,r,l,a)=>{if("pdf"==t)C(r,l,a,N,M,E,e);else{if("excel"!=t)return"";m(r,l,a,N,M)}},{message:R,notification:S,modal:D}=r,[P,U]=(0,a.useState)(!1),j=async e=>{U(!0);let t=async()=>{try{return"pdf"==e?k("pdf",y,b,f):k("excel",y,b,f),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await t()?setTimeout(()=>{R.open({type:"success",content:l.jsx("span",{className:" capitalize",children:"Export Success"})}),U(!1)},1e3):setTimeout(()=>{R.open({type:"error",content:l.jsx("span",{className:" capitalize",children:"Export Invalid"})}),U(!1)},1e3)},500)};return l.jsx(s.Z,{pathname:t,globalState:e,children:(0,l.jsxs)(p.Z,{loadingExport:P,downloadPdf:()=>j("pdf"),downloadExcel:()=>j("excel"),data:y,loading:A,type:"rangemonth",dateChange:e=>g(e),children:[h.x4.web.header(f,`${M.periodeColumn+b}`),l.jsx("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full table-auto border-collapse border border-solid dark:border-white border-black",style:{whiteSpace:"nowrap"},children:[(0,l.jsxs)("thead",{className:"dark:bg-black bg-tbl-header uppercase",style:h.wF.web.headerTable,children:[(0,l.jsxs)("tr",{children:[l.jsx("th",{className:" border border-solid dark:border-white border-black ",rowSpan:2,style:{width:"50px"},children:"No"}),l.jsx("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"70"},children:"Tanggal"}),l.jsx("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"70"},children:"Trainset KA"}),l.jsx("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"150px"},children:"Nomor KA"}),l.jsx("th",{className:" border border-solid dark:border-white border-black",colSpan:3,children:"Realisasi"}),l.jsx("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"120px"},children:"Keterangan"})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"border border-solid dark:border-white border-black",style:{width:"100px",height:"20px"},children:"Ber"}),l.jsx("th",{className:"border border-solid dark:border-white border-black",style:{width:"100px",height:"20px"},children:"Dat"}),l.jsx("th",{className:"border border-solid dark:border-white border-black",style:{width:"100px",height:"20px"},children:"WT"})]}),l.jsx("tr",{children:(()=>{let e=[];for(let t=0;t<8;t++)e.push(l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),l.jsx("tbody",{style:h.wF.web.bodyTable,children:y?.map((e,t)=>{let r=y.length;return T=1,l.jsxs(n().Fragment,{children:[e.data_rows?.map((e,t)=>{let r=new Date(e.d_opr),a=d()(r),n=d()(a).format("DD MMMM YYYY"),o=t%2==0?"even-row dark:even-row":"";return l.jsxs("tr",{className:`text-center ${o}`,children:[l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:e.summaryRow?"-":T++}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:n}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:h.TM(e.n_train,h.uf(e.n_train))}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:h.TM(e.c_noka)}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:h.TM(e.t_r_departure)}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:h.TM(e.t_r_arrive)}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black",children:h.TM(e.t_r_traveling)}),l.jsx("td",{className:"p-1 border border-solid dark:border-white border-black"})]},t)}),t+1!==r&&l.jsx("tr",{className:"dark:bg-black bg-tbl-row",children:l.jsx("td",{colSpan:8,className:"p-4 border border-solid dark:border-white border-black"})})]},t)})})]})})]})})}},78061:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>n,default:()=>s});var l=r(68570);let a=(0,l.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\supportAverageDelay\page.tsx`),{__esModule:n,$$typeof:o}=a;a.default;let s=(0,l.createProxy)(String.raw`D:\FEMBI NUR ILHAM\NUTECH\PROJECT\dashboard_executive_cms\app\(admin)\supportAverageDelay\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),l=t.X(0,[3023,9400,385,1862,7296,2653,678,2207,8809,3627,9899,7194,6821],()=>r(8266));module.exports=l})();