(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8392],{96872:function(e,r,t){Promise.resolve().then(t.bind(t,95872))},95872:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return A}});var l=t(57437),a=t(2265),o=t(16463),n=t(62737),d=t.n(n),i=t(68348),s=t(72100),c=t(71275),b=t(41105),h=t(30939),p=t(65188),g=t(38797),m=t(42005),_=t(97501);let v=(e,r,t,l,a,o,n)=>{if(!e||0===e.length)return;new _.default({format:"legal",orientation:"landscape"}).internal.pageSize.width,a.headerColumn,a.reportColumn,a.periodeColumn,r.toUpperCase();let i=[],s=[];e.length,null==e||e.map((e,t)=>{var a,o,n,c,b,h;if(0==t){let t=new Date(null==e?void 0:null===(a=e.summary[0])||void 0===a?void 0:a.d_opr),s=d()(t);d()(s).format("DD MMMM YYYY"),null===(o=e.data_rows)||void 0===o||o.map((e,t)=>{let l=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(l);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),n=(0,g.TM)(e.t_r_arrive),s=(0,g.TM)(e.t_l_arrive),c=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":(0,g.Gx)(e.t_percent_arrive,".",",")+"%",b=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",",")),h=[{content:"Rata - Rata Lintas "+e.c_station_start+"-"+e.c_station_end+" "+r,colSpan:9,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:s,styles:{halign:"center"}},{content:c,styles:{halign:"center"}},{content:b,styles:{halign:"center"}}];i.push(h)}),null===(n=e.summary)||void 0===n||n.map((e,t)=>{let a=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),o=d()(a);d()(o).format("MMMM YYYY");let n=(0,g.TM)(e.t_p_arrive),s=(0,g.TM)(e.t_r_arrive),c=(0,g.TM)(e.t_l_arrive),b=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":(0,g.Gx)(e.t_percent_arrive,".",",")+"%",h=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",",")),p=[{content:"TOTAL RATA - RATA LINTAS "+r.toUpperCase(),colSpan:9,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:n,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:s,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:c,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:b,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:h,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}}];i.push(p)})}if(1==t){let t=new Date(null==e?void 0:null===(c=e.summary[0])||void 0===c?void 0:c.d_opr),a=d()(t);d()(a).format("DD MMMM YYYY"),null===(b=e.data_rows)||void 0===b||b.map((e,t)=>{let l=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(l);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),n=(0,g.TM)(e.t_r_arrive),i=(0,g.TM)(e.t_l_arrive),c=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":(0,g.Gx)(e.t_percent_arrive,".",",")+"%",b=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",",")),h=[{content:"Rata - Rata Lintas "+e.c_station_start+"-"+e.c_station_end+" "+r,colSpan:9,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:i,styles:{halign:"center"}},{content:c,styles:{halign:"center"}},{content:b,styles:{halign:"center"}}];s.push(h)}),null===(h=e.summary)||void 0===h||h.map((e,t)=>{let a=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),o=d()(a);d()(o).format("MMMM YYYY");let n=(0,g.TM)(e.t_p_arrive),i=(0,g.TM)(e.t_r_arrive),c=(0,g.TM)(e.t_l_arrive),b=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":(0,g.Gx)(e.t_percent_arrive,".",",")+"%",h=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",",")),p=[{content:"TOTAL RATA - RATA LINTAS "+r.toUpperCase(),colSpan:9,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:n,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:i,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:c,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:b,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}},{content:h,bold:!0,styles:{halign:"center",fontStyle:"bold",fillColor:l[1]}}];s.push(p)})}}),g.x4.pdf({globalState:n,reportType:t,date:a.periodeColumn+r.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:80,fontSize:8},headStyle:{cellPadding:1,marginLeft:40},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center",cellWidth:8}},{content:"NAMA KERETA API",rowSpan:2,styles:{halign:"center",cellWidth:28}},{content:"LINTAS",colSpan:2,styles:{halign:"center"}},{content:"JARAK \n (KM)",rowSpan:2,styles:{halign:"center",cellWidth:14}},{content:"WAKTU TEMPUH \n (PROGRAM)",colSpan:2,styles:{halign:"center"}},{content:"WAKTU TEMPUH \n (REALISASI)",colSpan:2,styles:{halign:"center"}},{content:"KA DATANG",colSpan:2,styles:{halign:"center"}},{content:"KELAMBATAN KA",colSpan:2,styles:{halign:"center"}},{content:"KECEPATAN \n (RATA-RATA/JAM)",rowSpan:2,styles:{halign:"center",cellWidth:30}}],[{content:"ASAL",styles:{halign:"center",cellWidth:10}},{content:"TUJUAN",styles:{halign:"center",cellWidth:14}},{content:"JAM",styles:{halign:"center",cellWidth:10}},{content:"MENIT",styles:{halign:"center",cellWidth:16}},{content:"JAM",styles:{halign:"center",cellWidth:10}},{content:"MENIT",styles:{halign:"center",cellWidth:16}},{content:"PROGRAM",styles:{halign:"center",cellWidth:18}},{content:"REALISASI",styles:{halign:"center",cellWidth:18}},{content:"MENIT",styles:{halign:"center",cellWidth:16}},{content:"(%)",styles:{halign:"center",cellWidth:10}}]],dataBody:i,newTable:[{headStyle:{cellPadding:1,marginLeft:40,marginTop:12},next:!0,dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center",cellWidth:8}},{content:"NAMA KERETA API",rowSpan:2,styles:{halign:"center",cellWidth:28}},{content:"LINTAS",colSpan:2,styles:{halign:"center"}},{content:"JARAK \n (KM)",rowSpan:2,styles:{halign:"center",cellWidth:14}},{content:"WAKTU TEMPUH \n (PROGRAM)",colSpan:2,styles:{halign:"center"}},{content:"WAKTU TEMPUH \n (REALISASI)",colSpan:2,styles:{halign:"center"}},{content:"KA DATANG",colSpan:2,styles:{halign:"center"}},{content:"KELAMBATAN KA",colSpan:2,styles:{halign:"center"}},{content:"KECEPATAN \n (RATA-RATA/JAM)",rowSpan:2,styles:{halign:"center",cellWidth:30}}],[{content:"ASAL",styles:{halign:"center",cellWidth:10}},{content:"TUJUAN",styles:{halign:"center",cellWidth:14}},{content:"JAM",styles:{halign:"center",cellWidth:10}},{content:"MENIT",styles:{halign:"center",cellWidth:16}},{content:"JAM",styles:{halign:"center",cellWidth:10}},{content:"MENIT",styles:{halign:"center",cellWidth:16}},{content:"PROGRAM",styles:{halign:"center",cellWidth:18}},{content:"REALISASI",styles:{halign:"center",cellWidth:18}},{content:"MENIT",styles:{halign:"center",cellWidth:16}},{content:"(%)",styles:{halign:"center",cellWidth:10}}]],dataBody:s}],nameFile:"REKAP KELAMBATAN LINTAS "+r.toUpperCase()+".pdf",landscape:!0})};var u=t(61438),M=t.n(u);let x=(e,r,t,l,a)=>{if(!e||0===e.length)return;let o=new(M()).Workbook,n="calibri";o.creator="NUTECH",o.lastModifiedBy="LRT",o.created=new Date,o.modified=new Date,o.lastPrinted=new Date;let i=l[0][0],s=l[0][1],c=l[0][2],b=l[1][0],h=l[1][1],p=l[1][2];function m(e,r,t,l){return"column"==l?"FF"+(e<<16|r<<8|t).toString(16).toUpperCase().padStart(6,"0"):"total"==l?"FF"+(e<<16|r<<8|t).toString(16).toUpperCase().padStart(6,"0"):void 0}m(i,s,c,"column");let _=m(b,h,p,"total"),v=m(l[2][0],l[2][1],l[2][2],"total"),u=o.addWorksheet();u.getCell("A1").value=a.headerColumn,u.mergeCells("A1:N1"),u.getCell("A1").font={size:11,bold:!0,name:n},u.getCell("A2").value=a.reportColumn,u.mergeCells("A2:N2"),u.getCell("A2").font={size:11,bold:!0,name:n},u.getCell("A3").value=a.periodeColumn+""+r.toUpperCase(),u.getCell("A3").font={size:11,bold:!0,name:n};let x=["A","B","C","E","F","H","I","J","L","N"];for(let e=0;e<x.length;e++){let r=x[e]+"5";u.getCell(r).alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.getCell(r).font={size:10,name:n,bold:!0,color:{argb:l[3][0]}},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:v}}}let A=["C","D","F","G","H","I","J","K","L","M"];for(let e=0;e<A.length;e++){let r=A[e]+"6";u.getCell(r).alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.getCell(r).font={size:10,name:n,bold:!0,color:{argb:l[3][0]}},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:v}}}u.getCell("A5").value="NO",u.mergeCells("A5:A6"),u.getCell("B5").value="NAMA KERETA API",u.mergeCells("B5:B6"),u.getCell("C5").value="LINTAS",u.mergeCells("C5:D5"),u.getCell("C6").value="ASAL",u.getCell("D6").value="TUJUAN",u.getCell("E5").value="JARAK \n(KM)",u.mergeCells("E5:E6"),u.getCell("F5").value="WAKTU TEMPUH \n (PROGRAM)",u.mergeCells("F5:G5"),u.getCell("F6").value="JAM",u.getCell("G6").value="MENIT",u.getCell("H5").value="WAKTU TEMPUH \n (REALISASI)",u.mergeCells("H5:I5"),u.getCell("H6").value="JAM",u.getCell("I6").value="MENIT",u.getCell("J5").value="KA DATANG",u.mergeCells("J5:K5"),u.getCell("J6").value="PROGRAM",u.getCell("K6").value="REALISASI",u.getCell("L5").value="KELAMBATAN KA",u.mergeCells("L5:M5"),u.getCell("L6").value="MENIT",u.getCell("M6").value="(%)",u.getCell("N5").value="KECEPATAN \n (RATA-RATA/JAM)",u.mergeCells("N5:N6");let C={};for(let e of x){C[e]=0;for(let r=5;r<=6;r++){let t=u.getCell("".concat(e).concat(r)).value;t&&t.toString().length>C[e]&&(C[e]=t.toString().length)}}for(let e of x)u.getColumn(e).width=C[e]+2;for(let e of x){let r=u.getColumn(e);("F"===e||"G"===e||"H"===e||"I"===e)&&(r.width=10),"N"===e&&(r.width=18),"E"===e&&(r.width=7)}let f=["J","K"],T=20/f.length;for(let e of(f.forEach(e=>{u.getColumn(e).width=T}),[5,6]))u.getRow(e).height=30;let w=e=>{let r=1,t="";for(let l=e.length-1;l>=0;l--){let a=e.toUpperCase().charCodeAt(l);if((a+=r)>90?(a=65,r=1):r=0,t=String.fromCharCode(a)+t,!r){t=e.substring(0,l)+t;break}}return r&&(t="A"+t),t},y=7,N=6;e.length,null==e||e.map((e,t)=>{if(0==t){var l,a;null===(l=e.data_rows)||void 0===l||l.map((e,t)=>{let l=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(l);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),i=(0,g.TM)(e.t_r_arrive),s=(0,g.TM)(e.t_l_arrive),c=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":e.t_percent_arrive+"%",b=(0,g.TM)(e.i_avg_speed);"-"!==b&&(b=parseFloat(b));let h=["Rata-Rata Lintas "+e.c_station_start+"-"+e.c_station_end+" "+r,o,i,s,c,b],p="I";N+=1,h.map((e,r)=>{if(0==r){let r="A"+N;u.getCell(r).value=e,u.mergeCells("A"+N+":I"+N),u.getCell("A"+N+":L"+N).alignment={horizontal:"center",vertical:"middle"},u.getCell("A"+N+":N"+N).font={size:9,name:n},u.getCell("N"+N).numFmt="0.00"}else{let r=p+N;u.getCell(r).alignment={horizontal:"center",vertical:"middle"},u.getCell(r).font={size:9,name:n},u.getCell(r).value=e}u.getCell("N"+N).numFmt="0.00",p=w(p)})}),null===(a=e.summary)||void 0===a||a.map((e,t)=>{let l=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(l);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),i=(0,g.TM)(e.t_r_arrive),s=(0,g.TM)(e.t_l_arrive),c=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":e.t_percent_arrive+"%",b=(0,g.TM)(e.i_avg_speed);"-"!==b&&(b=parseFloat(b));let h=["RATA-RATA LINTAS "+r.toUpperCase(),o,i,s,c,b],p="I";N+=1,h.map((e,r)=>{if(0==r){let r="A"+N;u.getCell(r).value=e,u.mergeCells("A"+N+":I"+N),u.getCell("A"+N+":L"+N).alignment={horizontal:"center",vertical:"middle"},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:_}},u.getCell(r).font={size:9,bold:!0,name:n},u.getCell("N"+N).numFmt="0.00"}else{let r=p+N;u.getCell(r).value=e,u.getCell(r).alignment={horizontal:"center",vertical:"middle"},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:_}},u.getCell(r).font={size:9,bold:!0,name:n},u.getCell("N"+N).numFmt="0.00"}p=w(p)})}),y+=1}}),N+=1;for(let e=0;e<x.length;e++){let r=x[e]+(N+1);u.getCell(r).alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.getCell(r).font={size:10,name:n,bold:!0,color:{argb:l[3][0]}},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:v}}}for(let e=0;e<A.length;e++){let r=A[e]+(N+2);u.getCell(r).alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.getCell(r).font={size:10,name:n,bold:!0,color:{argb:l[3][0]}},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:v}}}for(let e of(u.getCell("A".concat(N+1)).value="NO",u.mergeCells("A".concat(N+1,":A").concat(N+2)),u.getCell("B".concat(N+1)).value="NAMA KERETA API",u.mergeCells("B".concat(N+1,":B").concat(N+2)),u.getCell("C".concat(N+1)).value="LINTAS",u.mergeCells("C".concat(N+1,":D").concat(N+1)),u.getCell("C".concat(N+2)).value="ASAL",u.getCell("D".concat(N+2)).value="TUJUAN",u.getCell("E".concat(N+1)).value="JARAK \n(KM)",u.mergeCells("E".concat(N+1,":E").concat(N+2)),u.getCell("F".concat(N+1)).value="WAKTU TEMPUH \n (PROGRAM)",u.mergeCells("F".concat(N+1,":G").concat(N+1)),u.getCell("F".concat(N+2)).value="JAM",u.getCell("G".concat(N+2)).value="MENIT",u.getCell("H".concat(N+1)).value="WAKTU TEMPUH \n (REALISASI)",u.mergeCells("H".concat(N+1,":I").concat(N+1)),u.getCell("H".concat(N+2)).value="JAM",u.getCell("I".concat(N+2)).value="MENIT",u.getCell("J".concat(N+1)).value="KA DATANG",u.mergeCells("J".concat(N+1,":K").concat(N+1)),u.getCell("J".concat(N+2)).value="PROGRAM",u.getCell("K".concat(N+2)).value="REALISASI",u.getCell("L".concat(N+1)).value="KELAMBATAN KA",u.mergeCells("L".concat(N+1,":M").concat(N+1)),u.getCell("L".concat(N+2)).value="MENIT",u.getCell("M".concat(N+2)).value="(%)",u.getCell("N".concat(N+1)).value="KECEPATAN \n (RATA-RATA/JAM)",u.mergeCells("N".concat(N+1,":N").concat(N+2)),x)){C[e]=0;for(let r=5;r<=6;r++){let t=u.getCell("".concat(e).concat(r)).value;t&&t.toString().length>C[e]&&(C[e]=t.toString().length)}}for(let e of x)u.getColumn(e).width=C[e]+2;for(let e of x){let r=u.getColumn(e);("F"===e||"G"===e||"H"===e||"I"===e)&&(r.width=10),"N"===e&&(r.width=18),"E"===e&&(r.width=7)}let k=20/f.length;for(let e of(f.forEach(e=>{u.getColumn(e).width=k}),[N+1,N+2]))u.getRow(e).height=30;N+=2,null==e||e.map((e,t)=>{if(1==t){var l,a;null===(l=e.data_rows)||void 0===l||l.map((e,t)=>{let l=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(l);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),i=(0,g.TM)(e.t_r_arrive),s=(0,g.TM)(e.t_l_arrive),c=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":e.t_percent_arrive+"%",b=(0,g.TM)(e.i_avg_speed);"-"!=b&&(b=parseFloat(b));let h=["Rata-Rata Lintas "+e.c_station_start+"-"+e.c_station_end+" "+r,o,i,s,c,b],p="I";N+=1,h.map((e,r)=>{if(0==r){let r="A"+N;u.getCell(r).value=e,u.mergeCells("A"+N+":I"+N),u.getCell("A"+N+":L"+N).alignment={horizontal:"center",vertical:"middle"},u.getCell("A"+N+":N"+N).font={size:9,name:n},u.getCell("N"+N).numFmt="0.00"}else{let r=p+N;u.getCell(r).alignment={horizontal:"center",vertical:"middle"},u.getCell(r).font={size:9,name:n},u.getCell(r).value=e}u.getCell("N"+N).numFmt="0.00",p=w(p)})}),null===(a=e.summary)||void 0===a||a.map((e,t)=>{let l=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(l);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),i=(0,g.TM)(e.t_r_arrive),s=(0,g.TM)(e.t_l_arrive),c=""===e.t_percent_arrive?"":0===e.t_percent_arrive?"-":e.t_percent_arrive+"%",b=(0,g.TM)(e.i_avg_speed);"-"!=b&&(b=parseFloat(b));let h=["RATA-RATA LINTAS "+r.toUpperCase(),o,i,s,c,b],p="I";N+=1,h.map((e,r)=>{if(0==r){let r="A"+N;u.getCell(r).value=e,u.mergeCells("A"+N+":I"+N),u.getCell("A"+N+":L"+N).alignment={horizontal:"center",vertical:"middle"},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:_}},u.getCell(r).font={size:9,bold:!0,name:n},u.getCell("N"+N).numFmt="0.00"}else{let r=p+N;u.getCell(r).value=e,u.getCell(r).alignment={horizontal:"center",vertical:"middle"},u.getCell(r).fill={type:"pattern",pattern:"solid",fgColor:{argb:_}},u.getCell(r).font={size:9,bold:!0,name:n},u.getCell("N"+N).numFmt="0.00"}p=w(p)})}),y+=1}});var j={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};return u.eachRow({includeEmpty:!0},function(e){e._number>4&&e.eachCell({includeEmpty:!0},function(e){e.border=j})}),u.getCell("M".concat(N+3)).value=null==t?void 0:t.n_position_1,u.getCell("M".concat(N+7)).value=null==t?void 0:t.n_name_1,u.getCell("M".concat(N+8)).value="Nipp. "+(null==t?void 0:t.i_nipp_1),u.getCell("M".concat(N+3)).font={size:10,name:n,bold:!0},u.getCell("M".concat(N+7)).font={size:10,name:n,bold:!0,underline:!0},u.getCell("M".concat(N+8)).font={size:10,name:n,bold:!0},u.getCell("M".concat(N+3)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.getCell("M".concat(N+7)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.getCell("M".concat(N+8)).alignment={horizontal:"center",vertical:"middle"},u.mergeCells("M".concat(N+3," : N").concat(N+3)),u.mergeCells("M".concat(N+7," : N").concat(N+7)),u.mergeCells("M".concat(N+8," : N").concat(N+8)),o.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(t),a=document.createElement("a");document.body.appendChild(a),a.setAttribute("style","display: none"),a.href=l,a.download="REKAP KELAMBATAN LINTAS "+r.toUpperCase()+".xlsx",a.click(),window.URL.revokeObjectURL(l),a.remove()})};function A(){var e,r;let t=(0,a.useContext)(c.Z),n=(0,o.usePathname)(),_=i.Z.useApp(),[u,M]=(0,a.useState)([null,null]),[A,C]=(0,a.useState)(null),[f,T]=(0,a.useState)(),[w,y]=(0,a.useState)([]),[N,k]=(0,a.useState)(null),[j,S]=(0,a.useState)(!1),[Y,R]=(0,a.useState)([1,"month"]),[E,I]=(0,a.useState)(0),L=[[219,215,215],[255,255,255],[121,193,235],["000000"]],K=null==t?void 0:null===(r=t.dataUser)||void 0===r?void 0:null===(e=r.user)||void 0===e?void 0:e.username,D={headerColumn:null==f?void 0:f.n_line_1,reportColumn:null==f?void 0:f.n_line_2,periodeColumn:null==f?void 0:f.n_line_4,periodeColumn2:"Tahun  ",dateColumn:A};(0,a.useEffect)(()=>{if(null!=u){let a="",o="",n=0;if(1==Y[0])a=u,o=u;else if(2==Y[0]){if(u){a=u;var e=new Date(u);e.setMonth(e.getMonth()+2);var r=d()(e).format("DD"),t=d()(e).format("MM");o=d()(e).format("YYYY")+"-"+t+"-"+r}}else if(4==Y[0]&&u){n=1,a=u;var l=d()(u).startOf("year").format("YYYY").toString();a=d()(l).format(),o=d()(l).endOf("year").format()}let i=a,s=o,c=d()(i).format("MMMM YYYY"),b=d()(s).format("MMMM YYYY");C((1==n?"Tahun "+d()(i).format("YYYY"):c==b?c:c+" - "+b).toUpperCase())}if(u){let e=async()=>{let e="",r="",t="",l="";if(1==Y[0])e=d()(u).format("MM"),r=d()(u).format("YYYY"),t=d()(u).format("MM"),l=d()(u).format("YYYY");else if(2==Y[0]){if(u){e=d()(u).format("MM"),r=d()(u).format("YYYY");var a=new Date(u);a.setMonth(a.getMonth()+2),t=d()(a).format("MM"),l=d()(a).format("YYYY")}}else u&&(e="01",r=d()(u).format("YYYY"),t="12",l=d()(u).format("YYYY"));let o=e+"_"+t,n=r+"_"+l,i=await (0,m.Z)().get("report-type/REC_AVG_DELAY"),s=await (0,m.Z)().get("report/recap-traffic-delay?period_month="+o+"&period_year="+n);(0,h.Z)({res:s,app:_})&&k(s.data),(0,h.Z)({res:i,app:_})&&T(null==i?void 0:i.data),S(!1)};u&&"Invalid Date"!==d()(u).format("YYYY-MM-DD")&&"Invalid Date"!==d()(u).format("YYYY-MM-DD")?(S(!0),e()):k(null)}},[u,Y,_]);let U=(e,r,l,a)=>{if("pdf"==e)v(r,l,a,L,D,K,t);else{if("excel"!=e)return"";x(r,l,a,L,D)}},{message:W,notification:P,modal:z}=_,[J,F]=(0,a.useState)(!1),G=async e=>{F(!0);let r=async()=>{try{return"pdf"==e?U("pdf",N,A,f):U("excel",N,A,f),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await r()?setTimeout(()=>{W.open({type:"success",content:(0,l.jsx)("span",{className:" capitalize",children:"Export Success"})}),F(!1)},1e3):setTimeout(()=>{W.open({type:"error",content:(0,l.jsx)("span",{className:" capitalize",children:"Export Invalid"})}),F(!1)},1e3)},500)};return(0,l.jsx)(p.Z,{pathname:n,globalState:t,children:(0,l.jsxs)(b.Z,{type:Y[1],loadingExport:J,childrenInput:(0,l.jsxs)("div",{className:"flex flex-col ml-2",children:[(0,l.jsx)("span",{id:"subject",className:"mb-5 mt-3  text-[14px]",children:"Tipe"}),(0,l.jsx)(s.default,{disabled:J,placeholder:"Select Filter",onChange:e=>{I(E+1);let r="",t=0;"month"==e?(r="month",t=1):"triwulan"==e?(r="triwulan",t=2):(r="year",t=4),R([t,r])},defaultValue:"Per Bulan",className:"max-md:w-full",options:[{value:"month",label:"Per Bulan"},{value:"triwulan",label:"Per Triwulan"},{value:"year",label:"Per Tahun"}]})]}),onDelete:()=>k(void 0),downloadPdf:()=>G("pdf"),downloadExcel:()=>G("excel"),data:N,loading:j,dateChange:e=>M(e),onChangeTri:E,children:[g.x4.web.header(f,"".concat(D.periodeColumn+A)),(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"w-full mb-5 table-auto border-collapse border border-solid dark:border-white border-black",style:{whiteSpace:"nowrap"},children:[(0,l.jsxs)("thead",{className:"dark:bg-black bg-tbl-header uppercase",style:g.wF.web.headerTable,children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:"Nama Kereta Api"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"Lintas"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:"Jarak"}),(0,l.jsx)("p",{children:" (Km)"})]})}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:" Waktu Tempuh"}),(0,l.jsx)("p",{children:" (Program)"})]})}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:" Waktu Tempuh"}),(0,l.jsx)("p",{children:" (Realisasi)"})]})}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"KA Datang"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"Kelambatan KA"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:"Kecepatan"}),(0,l.jsx)("p",{children:" (Rata-rata/Jam)"})]})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",style:{height:"10px"},children:"Asal"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Tujuan"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Jam"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Menit"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Jam"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Menit"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Program"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Realisasi"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Menit"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"%"})]})]}),(0,l.jsx)("tbody",{style:g.wF.web.bodyTable,children:null==N?void 0:N.map((e,r)=>{var t,o;if(N.length,0==r)return(0,l.jsxs)(a.Fragment,{children:[null===(t=e.data_rows)||void 0===t?void 0:t.map((e,r)=>{let t=r%2==0?"even-row dark:even-row":"",a=new Date(e.i_period_year+"-"+e.i_period_month+"-01");d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),n=(0,g.TM)(e.t_r_arrive),i=(0,g.TM)(e.t_l_arrive),s="-"===(0,g.TM)(e.t_percent_arrive)?"-":""===(0,g.TM)(e.t_percent_arrive)?(0,g.TM)(""):(0,g.TM)(e.t_percent_arrive,(0,g.Gx)(e.t_percent_arrive,".",","))+"%",c=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",","));return(0,l.jsxs)("tr",{className:"text-center ".concat(t),children:[(0,l.jsxs)("td",{colSpan:9,className:"px-3 border border-solid dark:border-white border-black",children:["Rata - Rata Lintas ",e.c_station_start,"-",e.c_station_end," ",A]}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:o}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:n}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:i}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:s}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:c})]},r)}),null===(o=e.summary)||void 0===o?void 0:o.map((e,r)=>{let t=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(t);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),n=(0,g.TM)(e.t_r_arrive),i=(0,g.TM)(e.t_l_arrive),s="-"===(0,g.TM)(e.t_percent_arrive)?"-":""===(0,g.TM)(e.t_percent_arrive)?(0,g.TM)(""):(0,g.TM)(e.t_percent_arrive,(0,g.Gx)(e.t_percent_arrive,".",","))+"%",c=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",","));return(0,l.jsxs)("tr",{className:"text-center font-bold dark:bg-black bg-tbl-footer",style:g.wF.web.bodyTotal,children:[(0,l.jsxs)("td",{colSpan:9,className:"px-3 border border-solid dark:border-white border-black uppercase",children:["Rata - Rata Lintas ",A]}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:o}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:n}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:i}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:s}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:c})]},"summary_".concat(r))})]},r)})})]}),(0,l.jsxs)("table",{className:"w-full mb-5 table-auto border-collapse border border-solid dark:border-white border-black",style:{whiteSpace:"nowrap"},children:[(0,l.jsxs)("thead",{className:"dark:bg-black bg-tbl-header uppercase",style:g.wF.web.headerTable,children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:"Nama Kereta Api"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"Lintas"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:"Jarak"}),(0,l.jsx)("p",{children:" (Km)"})]})}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:" Waktu Tempuh"}),(0,l.jsx)("p",{children:" (Program)"})]})}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:" Waktu Tempuh"}),(0,l.jsx)("p",{children:" (Realisasi)"})]})}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"KA Datang"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"Kelambatan KA"}),(0,l.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:(0,l.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,l.jsx)("p",{children:"Kecepatan"}),(0,l.jsx)("p",{children:" (Rata-rata/Jam)"})]})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",style:{height:"10px"},children:"Asal"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Tujuan"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Jam"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Menit"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Jam"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Menit"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Program"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Realisasi"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"Menit"}),(0,l.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black",children:"%"})]})]}),(0,l.jsx)("tbody",{style:g.wF.web.bodyTable,children:null==N?void 0:N.map((e,r)=>{var t,o;let n=N.length;if(1==r)return(0,l.jsxs)(a.Fragment,{children:[null===(t=e.data_rows)||void 0===t?void 0:t.map((e,r)=>{let t=r%2==0?"even-row dark:even-row":"",a=new Date(e.i_period_year+"-"+e.i_period_month+"-01");d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),n=(0,g.TM)(e.t_r_arrive),i=(0,g.TM)(e.t_l_arrive),s="-"===(0,g.TM)(e.t_percent_arrive)?"-":""===(0,g.TM)(e.t_percent_arrive)?(0,g.TM)(""):(0,g.TM)(e.t_percent_arrive,(0,g.Gx)(e.t_percent_arrive,".",","))+"%",c=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",","));return(0,l.jsxs)("tr",{className:"text-center ".concat(t),children:[(0,l.jsxs)("td",{colSpan:9,className:"px-3 border border-solid dark:border-white border-black",children:["Rata - Rata Lintas ",e.c_station_start,"-",e.c_station_end," ",A]}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:o}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:n}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:i}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:s}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:c})]},r)}),null===(o=e.summary)||void 0===o?void 0:o.map((e,r)=>{let t=new Date(e.i_period_year+"-"+e.i_period_month+"-01"),a=d()(t);d()(a).format("MMMM YYYY");let o=(0,g.TM)(e.t_p_arrive),n=(0,g.TM)(e.t_r_arrive),i=(0,g.TM)(e.t_l_arrive),s="-"===(0,g.TM)(e.t_percent_arrive)?"-":""===(0,g.TM)(e.t_percent_arrive)?(0,g.TM)(""):(0,g.TM)(e.t_percent_arrive,(0,g.Gx)(e.t_percent_arrive,".",","))+"%",c=(0,g.TM)(e.i_avg_speed,(0,g.Gx)(e.i_avg_speed,".",","));return(0,l.jsxs)("tr",{className:"text-center font-bold dark:bg-black bg-tbl-footer",style:g.wF.web.bodyTotal,children:[(0,l.jsxs)("td",{colSpan:9,className:"px-3 border border-solid dark:border-white border-black uppercase",children:["Rata - Rata Lintas ",A]}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:o}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:n}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:i}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:s}),(0,l.jsx)("td",{className:"px-3 border border-solid dark:border-white border-black",children:c})]},"summary_".concat(r))}),r+1!=n&&(0,l.jsx)("td",{className:"p-4 border border-solid dark:border-white border-black bg-tbl-row",colSpan:14})]},r)})})]})]})]})})}}},function(e){e.O(0,[2505,3113,8173,9141,2470,3919,8348,2100,4309,5053,5458,2034,9155,7824,4746,5141,7642,1105,2971,7023,1744],function(){return e(e.s=96872)}),_N_E=e.O()}]);