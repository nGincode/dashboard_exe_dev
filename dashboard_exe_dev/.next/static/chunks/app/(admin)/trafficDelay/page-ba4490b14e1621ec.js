(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7490],{35906:function(e,t,l){Promise.resolve().then(l.bind(l,20225))},20225:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return C}});var r=l(57437),n=l(2265),a=l(16463),o=l(68348),d=l(62737),i=l.n(d),s=l(42005),c=l(38797),h=l(71275),b=l(41105),p=l(30939),g=l(65188),m=l(61438),u=l.n(m);let _=(e,t,l,r,n)=>{if(!e||0===e.length)return;let a=new(u()).Workbook;a.creator="NUTECH",a.lastModifiedBy="LRT",a.created=new Date,a.modified=new Date,a.lastPrinted=new Date;let o="calibri",d=r[0][0],s=r[0][1],h=r[0][2],b=r[1][0],p=r[1][1],g=r[1][2],m=r[2][0],_=r[2][1],x=r[2][2];function M(e,t,l,r){return"column"==r?"FF"+(e<<16|t<<8|l).toString(16).toUpperCase().padStart(6,"0"):"total"==r?"FF"+(e<<16|t<<8|l).toString(16).toUpperCase().padStart(6,"0"):void 0}M(d,s,h,"column"),M(b,p,g,"total");let C=M(m,_,x,"total"),A=a.addWorksheet();A.getCell("A1").value=n.headerColumn,A.mergeCells("A1:N1"),A.getCell("A1").font={size:11,bold:!0,name:o},A.getCell("A2").value=n.reportColumn,A.mergeCells("A2:N2"),A.getCell("A2").font={size:11,bold:!0,name:o},i()((null==e?void 0:e[0].i_period_year)+"-"+(null==e?void 0:e[0].i_period_month)+"-1","YYYY-M-D").format("MMMM YYYY"),A.getCell("A3").value=n.periodeColumn+""+t.toUpperCase(),A.getCell("A3").font={size:11,bold:!0,name:o};let w=["A","B","C","E","F","H","I","J","L","N"];for(let e=0;e<w.length;e++){let t=w[e]+"5";A.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},A.getCell(t).font={name:o,size:10,bold:!0,color:{argb:r[3][0]}},A.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}}}let T=["C","D","F","G","H","I","J","K","L","M"];for(let e=0;e<T.length;e++){let t=T[e]+"6";A.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},A.getCell(t).font={name:o,size:10,bold:!0,color:{argb:r[3][0]}},A.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}}}A.getCell("A5").value="NO",A.mergeCells("A5:A6"),A.getCell("B5").value="NAMA KERETA API",A.mergeCells("B5:B6"),A.getCell("C5").value="LINTAS",A.mergeCells("C5:D5"),A.getCell("C6").value="ASAL",A.getCell("D6").value="TUJUAN",A.getCell("E5").value="JARAK \n (KM)",A.mergeCells("E5:E6"),A.getCell("F5").value="WAKTU TEMPUH \n (PROGRAM)",A.mergeCells("F5:G5"),A.getCell("F6").value="JAM",A.getCell("G6").value="MENIT",A.getCell("H5").value="WAKTU TEMPUH \n (REALISASI)",A.mergeCells("H5:I5"),A.getCell("H6").value="JAM",A.getCell("I6").value="MENIT",A.getCell("J5").value="KA DATANG",A.mergeCells("J5:K5"),A.getCell("J6").value="PROGRAM",A.getCell("K6").value="REALISASI",A.getCell("L5").value="KELAMBATAN KA",A.mergeCells("L5:M5"),A.getCell("L6").value="MENIT",A.getCell("M6").value="(%)",A.getCell("N5").value="KECEPATAN \n (RATA-RATA/JAM)",A.mergeCells("N5:N6");let y={};for(let e of w){y[e]=0;for(let t=5;t<=6;t++){let l=A.getCell("".concat(e).concat(t)).value;l&&l.toString().length>y[e]&&(y[e]=l.toString().length)}}for(let e of w)A.getColumn(e).width=y[e]+2;for(let e of w){let t=A.getColumn(e);("F"===e||"G"===e||"H"===e||"I"===e||"J"===e||"K"===e)&&(t.width=15),"N"===e&&(t.width=20),"E"===e&&(t.width=10)}for(let e of[5,6])A.getRow(e).height=30;A.getRow(5).height=27,A.getRow(6).height=19;let k=e=>{let t=1,l="";for(let r=e.length-1;r>=0;r--){let n=e.toUpperCase().charCodeAt(r);if((n+=t)>90?(n=65,t=1):t=0,l=String.fromCharCode(n)+l,!t){l=e.substring(0,r)+l;break}}return t&&(l="A"+l),l},f=7,v=7;null==e||e.map((e,t)=>{let l="A";if(0==t)for(let e=0;e<14;e++)A.getCell(l+7).value=e+1,A.getCell(l+7).font={size:10,bold:!0,name:o,color:{argb:r[3][0]}},A.getCell(l+7).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}},A.getCell(l+7).alignment={horizontal:"center",vertical:"middle"},l=k(l);let n=(0,c.TM)(e.c_noka),a=(0,c.TM)(e.c_station_start),d=(0,c.TM)(e.c_station_end),i=(0,c.TM)(e.i_distance),s=(0,c.TM)(e.t_p_hour),h=(0,c.TM)(e.t_p_minute),b=(0,c.TM)(e.t_r_hour),p=(0,c.TM)(e.t_r_minute),g=(0,c.TM)(e.t_p_arrive),m=(0,c.TM)(e.t_r_arrive),u=(0,c.TM)(e.t_l_minute),_=""===e.t_l_percent?"":0===e.t_l_percent?"-":e.t_l_percent+"%",x=(0,c.TM)(e.i_avg_speed);"-"!=x&&(x=parseFloat(x));let M="A";v+=1,[t+1,n,a,d,i,s,h,b,p,g,m,u,_,x].map(e=>{let t=M+v;A.getCell(t).value=e,A.getCell(t).font={size:9,name:o},A.getCell(t).alignment={horizontal:"center",vertical:"middle"},A.getCell("N"+v).numFmt="0.00",M=k(M)}),f+=1});var N={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};return A.eachRow({includeEmpty:!0},function(e){e._number>3&&e.eachCell({includeEmpty:!0},function(e){e.border=N})}),A.getCell("M".concat(v+3)).value=null==l?void 0:l.n_position_1,A.getCell("M".concat(v+7)).value=null==l?void 0:l.n_name_1,A.getCell("M".concat(v+8)).value="Nipp. "+(null==l?void 0:l.i_nipp_1),A.getCell("M".concat(v+3)).font={size:10,name:o,bold:!0},A.getCell("M".concat(v+7)).font={size:10,name:o,bold:!0,underline:!0},A.getCell("M".concat(v+8)).font={size:10,name:o,bold:!0},A.getCell("M".concat(v+3)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},A.getCell("M".concat(v+7)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},A.getCell("M".concat(v+8)).alignment={horizontal:"center",vertical:"middle"},A.mergeCells("M".concat(v+3," : N").concat(v+3)),A.mergeCells("M".concat(v+7," : N").concat(v+7)),A.mergeCells("M".concat(v+8," : N").concat(v+8)),a.xlsx.writeBuffer().then(e=>{let l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(l),n=document.createElement("a");document.body.appendChild(n),n.setAttribute("style","display: none"),n.href=r,n.download="KELAMBATAN LINTAS "+t.toUpperCase()+".xlsx",n.click(),window.URL.revokeObjectURL(r),n.remove()})};var x=l(97501);let M=(e,t,l,r,n,a,o)=>{if(!e||0===e.length)return;new x.default({format:"legal",orientation:"landscape"}).internal.pageSize.width,n.headerColumn,n.reportColumn,n.periodeColumn,t.toUpperCase();let d=[];null==e||e.map((e,t)=>{let l=(0,c.TM)(e.c_noka),r=(0,c.TM)(e.c_station_start),n=(0,c.TM)(e.c_station_end),a=(0,c.TM)(e.i_distance),o=(0,c.TM)(e.t_p_hour),i=(0,c.TM)(e.t_p_minute),s=(0,c.TM)(e.t_r_hour),h=(0,c.TM)(e.t_r_minute),b=(0,c.TM)(e.t_p_arrive),p=(0,c.TM)(e.t_r_arrive),g=(0,c.TM)(e.t_l_minute),m="-"===(0,c.TM)(e.t_l_percent)?"-":""===(0,c.TM)(e.t_l_percent)?(0,c.TM)(""):(0,c.TM)(e.t_l_percent,(0,c.Gx)(e.t_l_percent,".",","))+"%",u=(0,c.TM)(e.i_avg_speed,(0,c.Gx)(e.i_avg_speed,".",","));d.push([{content:t+1,styles:{halign:"center"}},{content:l,styles:{halign:"center"}},{content:r,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:a,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:i,styles:{halign:"center"}},{content:s,styles:{halign:"center"}},{content:h,styles:{halign:"center"}},{content:b,styles:{halign:"center"}},{content:p,styles:{halign:"center"}},{content:g,styles:{halign:"center"}},{content:m,styles:{halign:"center"}},{content:u,styles:{halign:"center"}}])}),c.x4.pdf({globalState:o,reportType:l,date:n.periodeColumn+t.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:120,fontSize:8},headStyle:{cellPadding:1,marginLeft:60,marginRight:60},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center",cellWidth:10}},{content:"NAMA KERETA API",rowSpan:2,styles:{halign:"center",cellWidth:30}},{content:"LINTAS",colSpan:2,styles:{halign:"center"}},{content:"JARAK \n (KM)",rowSpan:2,styles:{halign:"center",cellWidth:15}},{content:"WAKTU TEMPUH \n (PROGRAM)",colSpan:2,styles:{halign:"center"}},{content:"WAKTU TEMPUH \n (REALISASI)",colSpan:2,styles:{halign:"center"}},{content:"KA DATANG",colSpan:2,styles:{halign:"center"}},{content:"KELAMBATAN KA",colSpan:2,styles:{halign:"center"}},{content:"KECEPATAN \n (RATA-RATA/JAM)",rowSpan:2,styles:{halign:"center",cellWidth:30}}],[{content:"ASAL",styles:{halign:"center",cellWidth:15}},{content:"TUJUAN",styles:{halign:"center",cellWidth:15}},{content:"JAM",styles:{halign:"center",cellWidth:15}},{content:"MENIT",styles:{halign:"center",cellWidth:15}},{content:"JAM",styles:{halign:"center",cellWidth:15}},{content:"MENIT",styles:{halign:"center",cellWidth:15}},{content:"PROGRAM",styles:{halign:"center",cellWidth:18}},{content:"REALISASI",styles:{halign:"center",cellWidth:18}},{content:"MENIT",styles:{halign:"center",cellWidth:15}},{content:"(%)",styles:{halign:"center",cellWidth:15}}],[{content:"1",styles:{halign:"center"}},{content:"2",styles:{halign:"center"}},{content:"3",styles:{halign:"center"}},{content:"4",styles:{halign:"center"}},{content:"5",styles:{halign:"center"}},{content:"6",styles:{halign:"center"}},{content:"7",styles:{halign:"center"}},{content:"8",styles:{halign:"center"}},{content:"9",styles:{halign:"center"}},{content:"10",styles:{halign:"center"}},{content:"11",styles:{halign:"center"}},{content:"12",styles:{halign:"center"}},{content:"13",styles:{halign:"center"}},{content:"14",styles:{halign:"center"}}]],dataBody:d,nameFile:"KELAMBATAN LINTAS "+t.toUpperCase(),landscape:!0,pageSize:{width:215.9,height:355.6}})};function C(){var e,t;let l=(0,n.useContext)(h.Z),d=(0,a.usePathname)(),m=o.Z.useApp(),[u,x]=(0,n.useState)([null,null]),[C,A]=(0,n.useState)(null),[w,T]=(0,n.useState)(),[y,k]=(0,n.useState)(null),[f,v]=(0,n.useState)(!1),N=[[254,249,195],[255,255,255],[121,193,235],["000000"]],j=null==l?void 0:null===(t=l.dataUser)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.username,S={headerColumn:null==w?void 0:w.n_line_1,reportColumn:null==w?void 0:w.n_line_2,periodeColumn:null==w?void 0:w.n_line_4,periodeColumn2:"Tahun  ",dateColumn:C};(0,n.useEffect)(()=>{if(null!=u){let e=i()(u[0]),t=i()(u[1]),l=i()(e).format("MMMM YYYY"),r=i()(t).format("MMMM YYYY");A((l==r?l:l+" - "+r).toUpperCase())}if(null==u?void 0:u[0]){let e=async()=>{let e=i()(u[0]).format("MM"),t=i()(u[0]).format("YYYY"),l=i()(u[1]).format("MM"),r=i()(u[1]).format("YYYY"),n=await (0,s.Z)().get("report-type/TRF_DELAY"),a=await (0,s.Z)().get("report/traffic-delay?period_month="+e+"_"+l+"&period_year="+t+"_"+r);(0,p.Z)({res:a,app:m})&&k(a.data),(0,p.Z)({res:n,app:m})&&T(null==n?void 0:n.data),v(!1)};u&&"Invalid Date"!==i()(u[0]).format("YYYY-MM-DD")&&"Invalid Date"!==i()(u[1]).format("YYYY-MM-DD")?(v(!0),e()):k(null)}},[u,m]);let E=(e,t,r,n)=>{if("pdf"==e)M(t,r,n,N,S,j,l);else{if("excel"!=e)return"";_(t,r,n,N,S)}},{message:R,notification:Y,modal:K}=m,[I,L]=(0,n.useState)(!1),U=async e=>{L(!0);let t=async()=>{try{return"pdf"==e?E("pdf",y,C,w):E("excel",y,C,w),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await t()?setTimeout(()=>{R.open({type:"success",content:(0,r.jsx)("span",{className:" capitalize",children:"Export Success"})}),L(!1)},1e3):setTimeout(()=>{R.open({type:"error",content:(0,r.jsx)("span",{className:" capitalize",children:"Export Invalid"})}),L(!1)},1e3)},500)};return(0,r.jsx)(g.Z,{pathname:d,globalState:l,children:(0,r.jsxs)(b.Z,{loadingExport:I,downloadPdf:()=>U("pdf"),downloadExcel:()=>U("excel"),data:y,loading:f,type:"rangemonth",dateChange:e=>x(e),children:[c.x4.web.header(w,"".concat(S.periodeColumn+C)),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full mb-5 table-auto border-collapse border border-solid dark:border-white border-black",style:{whiteSpace:"nowrap"},children:[(0,r.jsxs)("thead",{className:"dark:bg-black bg-tbl-header uppercase",style:c.wF.web.headerTable,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black ",rowSpan:2,children:"Nama Kereta Api"}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"Lintas"}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:"Jarak"}),(0,r.jsx)("p",{children:" (Km)"})]})}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:" Waktu Tempuh"}),(0,r.jsx)("p",{children:" (Program)"})]})}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:" Waktu Tempuh"}),(0,r.jsx)("p",{children:" (Realisasi)"})]})}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"KA Datang"}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",colSpan:2,children:"Kelambatan KA"}),(0,r.jsx)("th",{className:" px-3 border border-solid dark:border-white border-black",rowSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:"Kecepatan"}),(0,r.jsx)("p",{children:" (Rata-rata/Jam)"})]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Asal"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Tujuan"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Jam"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Menit"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Jam"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Menit"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Program"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Realisasi"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"Menit"}),(0,r.jsx)("th",{className:"px-3 border border-solid dark:border-white border-black ",style:{width:"100px"},children:"%"})]}),(0,r.jsx)("tr",{children:(()=>{let e=[];for(let t=0;t<14;t++)e.push((0,r.jsx)("td",{className:"border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),(0,r.jsx)("tbody",{style:c.wF.web.bodyTable,children:null==y?void 0:y.map((e,t)=>{let l=t%2==0?"even-row dark:even-row":"",a=(0,c.TM)(e.c_noka),o=(0,c.TM)(e.c_station_start),d=(0,c.TM)(e.c_station_end),i=(0,c.TM)(e.i_distance,(0,c.Gx)(e.i_distance,".",",")),s=(0,c.TM)(e.t_p_hour),h=(0,c.TM)(e.t_p_minute),b=(0,c.TM)(e.t_r_hour),p=(0,c.TM)(e.t_r_minute),g=(0,c.TM)(e.t_p_arrive),m=(0,c.TM)(e.t_r_arrive),u=(0,c.TM)(e.t_l_minute),_="-"===(0,c.TM)(e.t_l_percent)?"-":""===(0,c.TM)(e.t_l_percent)?(0,c.TM)(""):(0,c.TM)(e.t_l_percent,(0,c.Gx)(e.t_l_percent,".",","))+"%",x=(0,c.TM)(e.i_avg_speed,(0,c.Gx)(e.i_avg_speed,".",","));return(0,r.jsx)(n.Fragment,{children:(0,r.jsxs)("tr",{className:"text-center ".concat(l),children:[(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:t+1}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:a}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:o}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:d}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:i}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:s}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:h}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:b}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:p}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:g}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:m}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:u}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:_}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:x})]},t)},t)})})]})})]})})}}},function(e){e.O(0,[2505,3113,8173,9141,2470,3919,8348,2100,4309,5053,5458,2034,9155,7824,4746,5141,7642,1105,2971,7023,1744],function(){return e(e.s=35906)}),_N_E=e.O()}]);