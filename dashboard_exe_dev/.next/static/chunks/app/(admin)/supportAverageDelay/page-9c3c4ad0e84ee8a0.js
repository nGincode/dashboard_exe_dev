(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9019],{47338:function(e,t,l){Promise.resolve().then(l.bind(l,5149))},5149:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return v}});var r=l(57437),n=l(2265),a=l(16463),o=l(65188),d=l(62737),i=l.n(d),s=l(68348),c=l(42005),h=l(41105),p=l(71275),b=l(38797),g=l(30939),u=l(61438),m=l.n(u);let C=(e,t,l,r,n)=>{if(!e||0===e.length)return;let a=new(m()).Workbook;a.creator="NUTECH",a.lastModifiedBy="LRT",a.created=new Date,a.modified=new Date,a.lastPrinted=new Date;let o="calibri",d=r[0][0],s=r[0][1],c=r[0][2],h=r[1][0],p=r[1][2],g=r[1][3];function u(e,t,l,r){return"column"==r?"FF"+(e<<16|t<<8|l).toString(16).toUpperCase().padStart(6,"0"):"total"==r?"FF"+(e<<16|t<<8|l).toString(16).toUpperCase().padStart(6,"0"):void 0}let C=u(d,s,c,"column");u(h,p,g,"total");let f=u(r[2][0],r[2][1],r[2][2],"total"),w=a.addWorksheet();w.getCell("A1").value=n.headerColumn,w.mergeCells("A1:H1"),w.getCell("A1").font={size:11,bold:!0,name:o},w.getCell("A2").value=n.reportColumn,w.mergeCells("A2:H2"),w.getCell("A2").font={size:11,bold:!0,name:o},i()((null==e?void 0:e[0].i_period_year)+"-"+(null==e?void 0:e[0].i_period_month)+"-1","YYYY-M-D").format("MMMM YYYY"),w.getCell("A3").value=n.periodeColumn+""+t.toUpperCase(),w.getCell("A3").font={size:11,bold:!0,name:o};let v=["A","B","C","D","E","H"];for(let e=0;e<v.length;e++){let t=v[e]+"5";w.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},w.getCell(t).font={size:10,name:o,bold:!0,color:{argb:r[3][0]}},w.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:f}}}let y=["E","F","G"];for(let e=0;e<y.length;e++){let t=y[e]+"6";w.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},w.getCell(t).font={size:10,name:o,bold:!0,color:{argb:r[3][0]}},w.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:f}}}w.getCell("A5").value="NO",w.mergeCells("A5:A6"),w.getCell("B5").value="TANGGAL",w.mergeCells("B5:B6"),w.getCell("C5").value="TRAINSET KA",w.mergeCells("C5:C6"),w.getCell("D5").value="NOMOR KA",w.mergeCells("D5:D6"),w.getCell("E5").value="REALISASI",w.mergeCells("E5:G5"),w.getCell("E6").value="BER",w.getCell("F6").value="DAT",w.getCell("G6").value="WT",w.getCell("H5").value="KETERANGAN",w.mergeCells("H5:H6");let x={};for(let e of v){x[e]=0;for(let t=5;t<=6;t++){let l=w.getCell("".concat(e).concat(t)).value;l&&l.toString().length>x[e]&&(x[e]=l.toString().length)}}for(let e of v){let t=w.getColumn(e);"B"===e?t.width=20:t.width=x[e]+2}let A=e=>{let t=1,l="";for(let r=e.length-1;r>=0;r--){let n=e.toUpperCase().charCodeAt(r);if((n+=t)>90?(n=65,t=1):t=0,l=String.fromCharCode(n)+l,!t){l=e.substring(0,r)+l;break}}return t&&(l="A"+l),l},_=7,k=7,M=e.length;null==e||e.map((e,t)=>{var l;let n="A";if(0==t)for(let e=0;e<8;e++)w.getCell(n+7).value=e+1,w.getCell(n+7).font={bold:!0},w.getCell(n+7).alignment={horizontal:"center",vertical:"middle"},w.getCell(n+7).font={size:10,name:o,bold:!0,color:{argb:r[3][0]}},w.getCell(n+7).fill={type:"pattern",pattern:"solid",fgColor:{argb:f}},n=A(n);e.data_rows.length,null===(l=e.data_rows)||void 0===l||l.map((e,t)=>{let l=new Date(e.d_opr),r=i()(l),n=[t+1,i()(r).format("DD MMMM YYYY"),(0,b.TM)(e.n_train),(0,b.TM)(e.c_noka),(0,b.TM)(e.t_r_departure),(0,b.TM)(e.t_r_arrive),(0,b.TM)(e.t_r_traveling),""],a="A";k+=1,n.map((e,t)=>{let l=a+k;w.getCell(l).value=e,w.getCell(l).alignment={horizontal:"center",vertical:"middle"},w.getCell(l).font={size:9,name:o},w.getCell("C:"+k).numFmt="#,##0_);(#,##0)",a=A(a)})}),t+1!=M&&(k+=1,w.getCell("A"+k+":H"+k).value="",w.mergeCells("A"+k+":H"+k),w.getCell("A"+k).fill={type:"pattern",pattern:"solid",fgColor:{argb:C}}),_+=1});var N={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};return w.eachRow({includeEmpty:!0},function(e){e._number>3&&e.eachCell({includeEmpty:!0},function(e){e.border=N})}),w.getCell("G".concat(k+3)).value=null==l?void 0:l.n_position_1,w.getCell("G".concat(k+7)).value=null==l?void 0:l.n_name_1,w.getCell("G".concat(k+8)).value="Nipp. "+(null==l?void 0:l.i_nipp_1),w.getCell("G".concat(k+3)).font={size:10,name:o,bold:!0},w.getCell("G".concat(k+7)).font={size:10,name:o,bold:!0,underline:!0},w.getCell("G".concat(k+8)).font={size:10,name:o,bold:!0},w.getCell("G".concat(k+3)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},w.getCell("G".concat(k+7)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},w.getCell("G".concat(k+8)).alignment={horizontal:"center",vertical:"middle"},w.mergeCells("G".concat(k+3," : H").concat(k+3)),w.mergeCells("G".concat(k+7," : H").concat(k+7)),w.mergeCells("G".concat(k+8," : H").concat(k+8)),a.xlsx.writeBuffer().then(e=>{let l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(l),n=document.createElement("a");document.body.appendChild(n),n.setAttribute("style","display: none"),n.href=r,n.download="PENDUKUNG KELAMBATAN RATA RATA "+t.toUpperCase()+".xlsx",n.click(),window.URL.revokeObjectURL(r),n.remove()})};var f=l(97501);let w=(e,t,l,r,n,a,o)=>{if(!e||0===e.length)return;new f.default({format:"legal",orientation:"landscape"}).internal.pageSize.width,n.headerColumn,n.reportColumn,n.periodeColumn,t.toUpperCase();let d=[],s=[];[1,2,3,4,5,6,7,8].map(e=>{let t={content:e,styles:{halign:"center",fillColor:r[2],textColor:r[3],fontSize:"7",font:"calibri",fontStyle:"bold"}};s.push(t)}),d.push(s),null==e||e.map((t,l)=>{var n;let a=e.length;if(null===(n=t.data_rows)||void 0===n||n.map((e,t)=>{let l=new Date(e.d_opr),r=i()(l),n=[{content:t+1,styles:{halign:"center"}},{content:i()(r).format("DD MMMM YYYY"),styles:{halign:"center"}},{content:(0,b.TM)(e.n_train,(0,b.uf)(e.n_train)),styles:{halign:"center"}},{content:(0,b.TM)(e.c_noka),styles:{halign:"center"}},{content:(0,b.TM)(e.t_r_departure),styles:{halign:"center"}},{content:(0,b.TM)(e.t_r_arrive),styles:{halign:"center"}},{content:(0,b.TM)(e.t_r_traveling),styles:{halign:"center"}},""];d.push(n)}),l+1!=a){let e=[{content:"",colSpan:19,styles:{halign:"center",fillColor:r[0]}}];d.push(e)}}),b.x4.pdf({globalState:o,reportType:l,date:n.periodeColumn+t.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:-4,fontSize:8},headStyle:{cellPadding:1,marginLeft:30,marginRight:30,cellWidth:20},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center",cellWidth:10}},{content:"TANGGAL",rowSpan:2,styles:{halign:"center"}},{content:"TRAINSET KA",rowSpan:2,styles:{halign:"center",cellWidth:20}},{content:"NOMOR KA",rowSpan:2,styles:{halign:"center"}},{content:"REALISASI",colSpan:3,styles:{halign:"center"}},{content:"KETERANGAN",rowSpan:2,styles:{halign:"center"}}],[{content:"BER",styles:{halign:"center"}},{content:"DAT",styles:{halign:"center"}},{content:"WT",styles:{halign:"center"}},{content:"MENIT",styles:{halign:"center"}},{content:"JAM",styles:{halign:"center"}},{content:"MENIT",styles:{halign:"center"}},{content:"PROGRAM",styles:{halign:"center"}},{content:"REALISASI",styles:{halign:"center"}},{content:"MENIT",styles:{halign:"center"}},{content:"(%)",styles:{halign:"center"}}]],dataBody:d,nameFile:"PENDUKUNG KELAMBATAN RATA RATA "+t.toUpperCase(),landscape:!1})};function v(){var e,t;let l=(0,n.useContext)(p.Z),d=(0,a.usePathname)(),u=s.Z.useApp(),[m,f]=(0,n.useState)([null,null]),[v,y]=(0,n.useState)(null),[x,A]=(0,n.useState)(),[_,k]=(0,n.useState)(null),[M,N]=(0,n.useState)(!1),T=1,S=[[219,215,215],[244,244,244],[121,193,235],["000000"]],Y=null==l?void 0:null===(t=l.dataUser)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.username,E={headerColumn:null==x?void 0:x.n_line_1,reportColumn:null==x?void 0:x.n_line_2,periodeColumn:null==x?void 0:x.n_line_4,periodeColumn2:"Tahun  ",dateColumn:v};(0,n.useEffect)(()=>{if(null!=m){let e=i()(m[0]),t=i()(m[1]),l=i()(e).format("MMMM YYYY"),r=i()(t).format("MMMM YYYY");y((l==r?l:l+" - "+r).toUpperCase())}if(null==m?void 0:m[0]){let e=async()=>{let e=i()(m[0]).format("MM"),t=i()(m[0]).format("YYYY"),l=i()(m[1]).format("MM"),r=i()(m[1]).format("YYYY"),n=await (0,c.Z)().get("report-type/SUP_AVG_DELAY"),a=await (0,c.Z)().get("report/support-average-delay?period_month="+e+"_"+l+"&period_year="+t+"_"+r);(0,g.Z)({res:a,app:u})&&k(a.data),(0,g.Z)({res:n,app:u})&&A(null==n?void 0:n.data),N(!1)};m&&"Invalid Date"!==i()(m[0]).format("YYYY-MM-DD")&&"Invalid Date"!==i()(m[1]).format("YYYY-MM-DD")?(N(!0),e()):k(null)}},[m,u]);let j=(e,t,r,n)=>{if("pdf"==e)w(t,r,n,S,E,Y,l);else{if("excel"!=e)return"";C(t,r,n,S,E)}},{message:D,notification:R,modal:G}=u,[z,U]=(0,n.useState)(!1),L=async e=>{U(!0);let t=async()=>{try{return"pdf"==e?j("pdf",_,v,x):j("excel",_,v,x),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await t()?setTimeout(()=>{D.open({type:"success",content:(0,r.jsx)("span",{className:" capitalize",children:"Export Success"})}),U(!1)},1e3):setTimeout(()=>{D.open({type:"error",content:(0,r.jsx)("span",{className:" capitalize",children:"Export Invalid"})}),U(!1)},1e3)},500)};return(0,r.jsx)(o.Z,{pathname:d,globalState:l,children:(0,r.jsxs)(h.Z,{loadingExport:z,downloadPdf:()=>L("pdf"),downloadExcel:()=>L("excel"),data:_,loading:M,type:"rangemonth",dateChange:e=>f(e),children:[b.x4.web.header(x,"".concat(E.periodeColumn+v)),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full table-auto border-collapse border border-solid dark:border-white border-black",style:{whiteSpace:"nowrap"},children:[(0,r.jsxs)("thead",{className:"dark:bg-black bg-tbl-header uppercase",style:b.wF.web.headerTable,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:" border border-solid dark:border-white border-black ",rowSpan:2,style:{width:"50px"},children:"No"}),(0,r.jsx)("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"70"},children:"Tanggal"}),(0,r.jsx)("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"70"},children:"Trainset KA"}),(0,r.jsx)("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"150px"},children:"Nomor KA"}),(0,r.jsx)("th",{className:" border border-solid dark:border-white border-black",colSpan:3,children:"Realisasi"}),(0,r.jsx)("th",{className:" border border-solid dark:border-white border-black",rowSpan:2,style:{width:"120px"},children:"Keterangan"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border border-solid dark:border-white border-black",style:{width:"100px",height:"20px"},children:"Ber"}),(0,r.jsx)("th",{className:"border border-solid dark:border-white border-black",style:{width:"100px",height:"20px"},children:"Dat"}),(0,r.jsx)("th",{className:"border border-solid dark:border-white border-black",style:{width:"100px",height:"20px"},children:"WT"})]}),(0,r.jsx)("tr",{children:(()=>{let e=[];for(let t=0;t<8;t++)e.push((0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),(0,r.jsx)("tbody",{style:b.wF.web.bodyTable,children:null==_?void 0:_.map((e,t)=>{var l;let a=_.length;return T=1,(0,r.jsxs)(n.Fragment,{children:[null===(l=e.data_rows)||void 0===l?void 0:l.map((e,t)=>{let l=new Date(e.d_opr),n=i()(l),a=i()(n).format("DD MMMM YYYY"),o=t%2==0?"even-row dark:even-row":"";return(0,r.jsxs)("tr",{className:"text-center ".concat(o),children:[(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:e.summaryRow?"-":T++}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:a}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:(0,b.TM)(e.n_train,(0,b.uf)(e.n_train))}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:(0,b.TM)(e.c_noka)}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:(0,b.TM)(e.t_r_departure)}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:(0,b.TM)(e.t_r_arrive)}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black",children:(0,b.TM)(e.t_r_traveling)}),(0,r.jsx)("td",{className:"p-1 border border-solid dark:border-white border-black"})]},t)}),t+1!==a&&(0,r.jsx)("tr",{className:"dark:bg-black bg-tbl-row",children:(0,r.jsx)("td",{colSpan:8,className:"p-4 border border-solid dark:border-white border-black"})})]},t)})})]})})]})})}}},function(e){e.O(0,[2505,3113,8173,9141,2470,3919,8348,2100,4309,5053,5458,2034,9155,7824,4746,5141,7642,1105,2971,7023,1744],function(){return e(e.s=47338)}),_N_E=e.O()}]);