(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4879],{60699:function(e,t,l){Promise.resolve().then(l.bind(l,20795))},20795:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return C}});var r=l(57437),n=l(71275),o=l(2265),a=l(16463),i=l(62737),d=l.n(i),s=l(68348),c=l(72100),b=l(42005),_=l(38797),m=l(41105),h=l(65188),p=l(30939),g=l(97501);let u=(e,t,l,r,n,o,a)=>{if(!e||0===e.length)return;new g.default({format:"legal",orientation:"landscape"}).internal.pageSize.width;let i=n.dateColumn.split(" ");i[0],i[1],n.headerColumn,n.reportColumn,n.periodeColumn,t.toUpperCase();let s=[],c=[];null==e||e.map((e,t)=>{0==t&&(e.data_rows.map((e,t)=>{let l=(0,_.TM)(e.c_station_start),r=(0,_.TM)(e.c_station_end),n=(0,_.TM)(e.i_distance,(0,_.Gx)(e.i_distance,".",",")),o=(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency)),a=(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat)),i=(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km)),c=(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_volume_pnp)),b=(0,_.TM)(e.i_km_pnp,(0,_.uf)(e.i_km_pnp)),m=(0,_.TM)(e.i_income,(0,_.uf)(e.i_income)),h=""===(0,_.TM)(e.i_o_static)?"":"-"===(0,_.TM)(e.i_o_static)?"-":e.i_o_static+"%",p=""===(0,_.TM)(e.i_o_dynamic)?"":"-"===(0,_.TM)(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",g=new Date(null==e?void 0:e.d_opr),u=d()(g);d()(u).format("DD/MM/YYYY");let f=[{content:t+=1,styles:{halign:"center"}},{content:l,styles:{halign:"center"}},{content:r,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:a,styles:{halign:"center"}},{content:i,styles:{halign:"center"}},{content:c,styles:{halign:"center"}},{content:b,styles:{halign:"center"}},{content:m,styles:{halign:"right"}},{content:h,styles:{halign:"center"}},{content:p,styles:{halign:"center"}}];s.push(f)}),e.summary.map((e,t)=>{let l=(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency)),n=(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat)),o=(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km)),a=(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_volume_pnp)),i=(0,_.TM)(e.i_km_pnp,(0,_.uf)(e.i_km_pnp)),d=(0,_.TM)(e.i_income,(0,_.uf)(e.i_income)),c=""===(0,_.TM)(e.i_o_static)?"":"-"===(0,_.TM)(e.i_o_static)?"-":e.i_o_static+"%",b=""===(0,_.TM)(e.i_o_dynamic)?"":"-"===(0,_.TM)(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",m=[{content:"TOTAL",colSpan:4,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:l,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:n,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:o,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:a,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:i,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:d,styles:{halign:"right",fillColor:r[1],fontStyle:"bold"}},{content:c,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:b,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}}];s.push(m)})),1==t&&(e.data_rows.map((e,t)=>{let l=(0,_.TM)(e.c_station_start),r=(0,_.TM)(e.c_station_end),n=(0,_.TM)(e.i_distance,(0,_.Gx)(e.i_distance,".",",")),o=(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency)),a=(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat)),i=(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km)),s=(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_volume_pnp)),b=(0,_.TM)(e.i_km_pnp,(0,_.uf)(e.i_km_pnp)),m=(0,_.TM)(e.i_income,(0,_.uf)(e.i_income)),h=""===(0,_.TM)(e.i_o_static)?"":"-"===(0,_.TM)(e.i_o_static)?"-":e.i_o_static+"%",p=""===(0,_.TM)(e.i_o_dynamic)?"":"-"===(0,_.TM)(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",g=new Date(null==e?void 0:e.d_opr),u=d()(g);d()(u).format("DD/MM/YYYY");let f=[{content:t+=1,styles:{halign:"center"}},{content:l,styles:{halign:"center"}},{content:r,styles:{halign:"center"}},{content:n,styles:{halign:"center"}},{content:o,styles:{halign:"center"}},{content:a,styles:{halign:"center"}},{content:i,styles:{halign:"center"}},{content:s,styles:{halign:"center"}},{content:b,styles:{halign:"center"}},{content:m,styles:{halign:"right"}},{content:h,styles:{halign:"center"}},{content:p,styles:{halign:"center"}}];c.push(f)}),e.summary.map((e,t)=>{let l=(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency)),n=(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat)),o=(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km)),a=(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_volume_pnp)),i=(0,_.TM)(e.i_km_pnp,(0,_.uf)(e.i_km_pnp)),d=(0,_.TM)(e.i_income,(0,_.uf)(e.i_income)),s=""===(0,_.TM)(e.i_o_static)?"":"-"===(0,_.TM)(e.i_o_static)?"-":e.i_o_static+"%",b=""===(0,_.TM)(e.i_o_dynamic)?"":"-"===(0,_.TM)(e.i_o_dynamic)?"-":e.i_o_dynamic+"%",m=[{content:"TOTAL",colSpan:4,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:l,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:n,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:o,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:a,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:i,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:d,styles:{halign:"right",fillColor:r[1],fontStyle:"bold"}},{content:s,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}},{content:b,styles:{halign:"center",fillColor:r[1],fontStyle:"bold"}}];c.push(m)}))}),_.x4.pdf({globalState:a,reportType:l,date:n.periodeColumn+t.toUpperCase(),positionSignature:{column:2,underlinePadding:-2,paddingTop:-1,marginLeft:10,fontSize:8},dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center"}},{content:"ASAL",rowSpan:2,styles:{halign:"center"}},{content:"TUJUAN",rowSpan:2,styles:{halign:"center"}},{content:"JARAK (KM) \n GAPEKA",rowSpan:2,styles:{halign:"center",cellWidth:20}},{content:"FREK KA",rowSpan:2,styles:{halign:"center",cellWidth:18}},{content:"TEMPAT DUDUK PENUMPANG",rowSpan:2,styles:{halign:"center",cellWidth:24}},{content:"TD - KM",rowSpan:2,styles:{halign:"center"}},{content:"VOLUME PNP",rowSpan:2,styles:{halign:"center"}},{content:"KM - PNP",rowSpan:2,styles:{halign:"center"}},{content:"PENDAPATAN",rowSpan:2,styles:{halign:"center"}},{content:"OKUPANSI",colSpan:2,styles:{halign:"center"}}],[{content:"STATIS",styles:{halign:"center"}},{content:"DINAMIS",styles:{halign:"center"}}],[{content:"1",styles:{halign:"center"}},{content:"2",styles:{halign:"center"}},{content:"3",styles:{halign:"center"}},{content:"4",styles:{halign:"center"}},{content:"5",styles:{halign:"center"}},{content:"6",styles:{halign:"center"}},{content:"7",styles:{halign:"center"}},{content:"8",styles:{halign:"center"}},{content:"9",styles:{halign:"center"}},{content:"10",styles:{halign:"center"}},{content:"11",styles:{halign:"center"}},{content:"12",styles:{halign:"center"}},{content:"13",styles:{halign:"center"}}]],headStyle:{cellPadding:1},dataBody:s,newTable:[{headStyle:{cellPadding:1,marginLeft:14,marginRight:14},next:!0,dataHead:[[{content:"NO",rowSpan:2,styles:{halign:"center"}},{content:"ASAL",rowSpan:2,styles:{halign:"center"}},{content:"TUJUAN",rowSpan:2,styles:{halign:"center"}},{content:"JARAK (KM) \n GAPEKA",rowSpan:2,styles:{halign:"center",cellWidth:20}},{content:"FREK KA",rowSpan:2,styles:{halign:"center",cellWidth:18}},{content:"TEMPAT DUDUK PENUMPANG",rowSpan:2,styles:{halign:"center",cellWidth:24}},{content:"TD - KM",rowSpan:2,styles:{halign:"center"}},{content:"VOLUME PNP",rowSpan:2,styles:{halign:"center"}},{content:"KM - PNP",rowSpan:2,styles:{halign:"center"}},{content:"PENDAPATAN",rowSpan:2,styles:{halign:"center"}},{content:"OKUPANSI",colSpan:2,styles:{halign:"center"}}],[{content:"STATIS",styles:{halign:"center"}},{content:"DINAMIS",styles:{halign:"center"}}],[{content:"1",styles:{halign:"center"}},{content:"2",styles:{halign:"center"}},{content:"3",styles:{halign:"center"}},{content:"4",styles:{halign:"center"}},{content:"5",styles:{halign:"center"}},{content:"6",styles:{halign:"center"}},{content:"7",styles:{halign:"center"}},{content:"8",styles:{halign:"center"}},{content:"9",styles:{halign:"center"}},{content:"10",styles:{halign:"center"}},{content:"11",styles:{halign:"center"}},{content:"12",styles:{halign:"center"}},{content:"13",styles:{halign:"center"}}]],dataBody:c}],nameFile:"REKAPITULASI KINERJA PER RELASI "+t.toUpperCase()+".pdf",landscape:!1,pageSize:{width:215.9,height:355.6}})};var f=l(61438),y=l.n(f);let k=(e,t,l,r,n)=>{if(!e||0===e.length)return;let o=new(y()).Workbook;o.creator="NUTECH",o.lastModifiedBy="LRT",o.created=new Date,o.modified=new Date,o.lastPrinted=new Date;let a="calibri",i=r[0][0],s=r[0][1],c=r[0][2],b=r[1][0],m=r[1][1],h=r[1][2];function p(e,t,l,r){return"column"==r?"FF"+(e<<16|t<<8|l).toString(16).toUpperCase().padStart(6,"0"):"total"==r?"FF"+(e<<16|t<<8|l).toString(16).toUpperCase().padStart(6,"0"):void 0}p(i,s,c,"column");let g=p(b,m,h,"total"),u=p(r[2][0],r[2][1],r[2][2],"total"),f=o.addWorksheet();f.getCell("A1").value=n.headerColumn,f.mergeCells("A1:L1"),f.getCell("A1").font={size:11,bold:!0,name:a},f.getCell("A2").value=n.reportColumn,f.mergeCells("A2:L2"),f.getCell("A2").font={size:11,bold:!0,name:a},d()((null==e?void 0:e[0].i_period_year)+"-"+(null==e?void 0:e[0].i_period_month)+"-1","YYYY-M-D").format("MMMM YYYY");let k=n.dateColumn.split(" ");k[0],k[1],f.getCell("A3").value=n.periodeColumn+t.toUpperCase(),f.mergeCells("A3:L3"),f.getCell("A3").font={size:11,bold:!0,name:a};let C=["A","B","C","D","E","F","G","H","I","J","K","L"];for(let e=0;e<C.length;e++){let t=C[e]+"5";f.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(t).font={size:9,name:a,bold:!0,color:{argb:r[3][0]}},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}let T=["K","L"];for(let e=0;e<T.length;e++){let t=T[e]+"6";f.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(t).font={size:9,name:a,bold:!0,color:{argb:r[3][0]}},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}f.getCell("A5").value="NO",f.mergeCells("A5:A6"),f.getCell("B5").value="ASAL",f.mergeCells("B5:B6"),f.getCell("C5").value="TUJUAN",f.mergeCells("C5:C6"),f.getCell("D5").value="JARAK (KM) \n GAPEKA",f.mergeCells("D5:D6"),f.getCell("E5").value="FREK KA",f.mergeCells("E5:E6"),f.getCell("F5").value="TEMPAT DUDUK \n PENUMPANG",f.mergeCells("F5:F6"),f.getCell("G5").value="TD-KM",f.mergeCells("G5:G6"),f.getCell("H5").value="VOLUME PNP",f.mergeCells("H5:H6"),f.getCell("I5").value="KM - PNP",f.mergeCells("I5:I6"),f.getCell("J5").value="PENDAPATAN",f.mergeCells("J5:J6"),f.getCell("K5").value="OKUPANSI",f.mergeCells("K5:L5"),f.getCell("K6").value="STATIS",f.getCell("L6").value="DINAMIS";let M={};for(let e of C){M[e]=0;for(let t=5;t<=6;t++){let l=f.getCell("".concat(e).concat(t)).value;l&&l.toString().length>M[e]&&(M[e]=l.toString().length)}}for(let e of C)f.getColumn(e).width=M[e]+2;for(let e of C){let t=f.getColumn(e);"D"===e&&(t.width=13),"F"===e&&(t.width=16),"G"===e&&(t.width=10)}let w=e=>{let t=1,l="";for(let r=e.length-1;r>=0;r--){let n=e.toUpperCase().charCodeAt(r);if((n+=t)>90?(n=65,t=1):t=0,l=String.fromCharCode(n)+l,!t){l=e.substring(0,r)+l;break}}return t&&(l="A"+l),l},x=6,v=7;null==e||e.map((e,t)=>{if(0==t){var l,n;let t="A";for(let e=0;e<12;e++)f.getCell(t+7).value=e+1,f.getCell(t+7).font={bold:!0},f.getCell(t+7).alignment={horizontal:"center",vertical:"middle"},f.getCell(t+7).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}},f.getCell(t+7).font={size:10,name:a,bold:!0,color:{argb:r[3][0]}},t=w(t);null===(l=e.data_rows)||void 0===l||l.map((e,t)=>{let l=[t+=1,(0,_.TM)(e.c_station_start),(0,_.TM)(e.c_station_end),(0,_.TM)(e.i_distance),(0,_.TM)(e.i_train_frequency),(0,_.TM)(e.i_passenger_seat),(0,_.TM)(e.i_td_km),(0,_.TM)(e.i_volume_pnp),(0,_.TM)(e.i_km_pnp),(0,_.TM)(e.i_income),""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%"],r="A",n="E",o=1;v+=1,l.map(e=>{let t=r+v;f.getCell(t).value=e,f.getCell(t).alignment={horizontal:"center",vertical:"middle"},f.getCell("J:"+v).alignment={horizontal:"right",vertical:"middle"},f.getCell(t).font={size:9,name:a},7!==o&&(f.getCell(n+v).numFmt="#,##0_);(#,##0)",n=w(n),o+=1),r=w(r)})}),null===(n=e.summary)||void 0===n||n.map((e,t)=>{let l=(0,_.TM)(e.i_train_frequency),r=(0,_.TM)(e.i_passenger_seat),n=(0,_.TM)(e.i_td_km),o=(0,_.TM)(e.i_volume_pnp),i=(0,_.TM)(e.i_km_pnp),d=(0,_.TM)(e.i_income),s=""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",c=""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%",b="D",m="E",h=1;v+=1,["TOTAL",l,r,n,o,i,d,s,c].map((e,t)=>{if(0==t){let t="A"+v;f.getCell(t).value=e,f.mergeCells("A"+v+":D"+v),f.getCell("A"+v+":D"+v).alignment={horizontal:"center",vertical:"middle"},f.getCell("J:"+v).alignment={horizontal:"right",vertical:"middle"},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},f.getCell(t).font={size:9,name:a,bold:!0}}else{let t=b+v;f.getCell(t).value=e,f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},f.getCell(t).alignment={horizontal:"center",vertical:"middle"},f.getCell("J:"+v).alignment={horizontal:"right",vertical:"middle"},f.getCell(t).font={size:9,name:a,bold:!0},7!==h&&(f.getCell(m+v).numFmt="#,##0_);(#,##0)",m=w(m),h+=1)}b=w(b)})}),x+=1}}),v+=1;for(let e=0;e<C.length;e++){let t=C[e]+(v+1);f.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(t).font={size:10,name:a,bold:!0,color:{argb:r[3][0]}},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}for(let e=0;e<T.length;e++){let t=T[e]+(v+2);f.getCell(t).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.getCell(t).font={size:10,name:a,bold:!0,color:{argb:r[3][0]}},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}}}for(let e of(f.getCell("A".concat(v+1)).value="NO",f.mergeCells("A".concat(v+1,":A").concat(v+2)),f.getCell("B".concat(v+1)).value="ASAL",f.mergeCells("B".concat(v+1,":B").concat(v+2)),f.getCell("C".concat(v+1)).value="TUJUAN",f.mergeCells("C".concat(v+1,":C").concat(v+2)),f.getCell("D".concat(v+1)).value="JARAK (KM) \n GAPEKA",f.mergeCells("D".concat(v+1,":D").concat(v+2)),f.getCell("E".concat(v+1)).value="FREK KA",f.mergeCells("E".concat(v+1,":E").concat(v+2)),f.getCell("F".concat(v+1)).value="TEMPAT DUDUK \n PENUMPANG",f.mergeCells("F".concat(v+1,":F").concat(v+2)),f.getCell("G".concat(v+1)).value="TD-KM",f.mergeCells("G".concat(v+1,":G").concat(v+2)),f.getCell("H".concat(v+1)).value="VOLUME PNP",f.mergeCells("H".concat(v+1,":H").concat(v+2)),f.getCell("I".concat(v+1)).value="KM - PNP",f.mergeCells("I".concat(v+1,":I").concat(v+2)),f.getCell("J".concat(v+1)).value="PENDAPATAN",f.mergeCells("J".concat(v+1,":J").concat(v+2)),f.getCell("K".concat(v+1)).value="OKUPANSI",f.mergeCells("K".concat(v+1,":L").concat(v+1)),f.getCell("K".concat(v+2)).value="STATIS",f.getCell("L".concat(v+2)).value="DINAMIS",C)){M[e]=0;for(let t=5;t<=6;t++){let l=f.getCell("".concat(e).concat(t)).value;l&&l.toString().length>M[e]&&(M[e]=l.toString().length)}}for(let e of C)f.getColumn(e).width=M[e]+2;for(let e of C){let t=f.getColumn(e);"D"===e&&(t.width=13),"F"===e&&(t.width=16),"G"===e&&(t.width=10)}v+=3,null==e||e.map((e,t)=>{if(1==t){var l,n;let t="A";for(let e=0;e<12;e++)f.getCell(t+v).value=e+1,f.getCell(t+v).font={bold:!0},f.getCell(t+v).alignment={horizontal:"center",vertical:"middle"},f.getCell(t+v).fill={type:"pattern",pattern:"solid",fgColor:{argb:u}},f.getCell(t+v).font={size:10,name:a,bold:!0,color:{argb:r[3][0]}},t=w(t);null===(l=e.data_rows)||void 0===l||l.map((e,t)=>{let l=[t+=1,(0,_.TM)(e.c_station_start),(0,_.TM)(e.c_station_end),(0,_.TM)(e.i_distance),(0,_.TM)(e.i_train_frequency),(0,_.TM)(e.i_passenger_seat),(0,_.TM)(e.i_td_km),(0,_.TM)(e.i_volume_pnp),(0,_.TM)(e.i_km_pnp),(0,_.TM)(e.i_income),""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%"],r="A",n="E",o=1;v+=1,l.map(e=>{let t=r+v;f.getCell(t).value=e,f.getCell(t).alignment={horizontal:"center",vertical:"middle"},f.getCell("J:"+v).alignment={horizontal:"right",vertical:"middle"},f.getCell(t).font={size:9,name:a},7!==o&&(f.getCell(n+v).numFmt="#,##0_);(#,##0)",n=w(n),o+=1),r=w(r)})}),null===(n=e.summary)||void 0===n||n.map((e,t)=>{let l=(0,_.TM)(e.i_train_frequency),r=(0,_.TM)(e.i_passenger_seat),n=(0,_.TM)(e.i_td_km),o=(0,_.TM)(e.i_volume_pnp),i=(0,_.TM)(e.i_km_pnp),d=(0,_.TM)(e.i_income),s=""===e.i_o_static?"":0===e.i_o_static?"-":e.i_o_static+"%",c=""===e.i_o_dynamic?"":0===e.i_o_dynamic?"-":e.i_o_dynamic+"%",b="D",m="E",h=1;v+=1,["TOTAL",l,r,n,o,i,d,s,c].map((e,t)=>{if(0==t){let t="A"+v;f.getCell(t).value=e,f.mergeCells("A"+v+":D"+v),f.getCell("A"+v+":D"+v).alignment={horizontal:"center",vertical:"middle"},f.getCell("J:"+v).alignment={horizontal:"right",vertical:"middle"},f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},f.getCell(t).font={size:9,name:a,bold:!0}}else{let t=b+v;f.getCell(t).value=e,f.getCell(t).fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},f.getCell(t).alignment={horizontal:"center",vertical:"middle"},f.getCell("J:"+v).alignment={horizontal:"right",vertical:"middle"},f.getCell(t).font={size:9,name:a,bold:!0},7!==h&&(f.getCell(m+v).numFmt="#,##0_);(#,##0)",m=w(m),h+=1)}b=w(b)})}),x+=1}});var N={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};f.eachRow({includeEmpty:!0},function(e){e._number>3&&e.eachCell({includeEmpty:!0},function(e){e.border=N})}),f.getRow(v+2);let S=null==l?void 0:l.n_position_1.split(" "),j=" ",A=" ";for(let e=0;e<S.length;e++)e<=3?j+=" ".concat(S[e]):A+=" ".concat(S[e]);let P=f.rowCount+1;return f.addRow(["","","","","","","","",j]).font={name:"calibri",bold:!0},f.getCell("I".concat(P)).alignment={vertical:"middle",horizontal:"center"},f.mergeCells("I".concat(P,":L").concat(P)),f.getCell("I".concat(P)).font={size:10,name:a,bold:!0},P=f.rowCount+1,f.addRow(["","","","","","","","",A]).font={name:"calibri",bold:!0},f.getCell("I".concat(P)).alignment={vertical:"middle",horizontal:"center"},f.mergeCells("I".concat(P,":L").concat(P)),f.getCell("I".concat(P)).font={size:10,name:a,bold:!0},f.getCell("I".concat(v+8)).value=null==l?void 0:l.n_name_1,f.getCell("I".concat(v+8)).font={size:10,name:a,bold:!0,underline:!0},f.getCell("I".concat(v+8)).alignment={horizontal:"center",vertical:"middle",wrapText:!0},f.mergeCells("I".concat(v+8," : L").concat(v+8)),f.getCell("I".concat(v+9)).value="Nipp. "+(null==l?void 0:l.i_nipp_1),f.getCell("I".concat(v+9)).font={size:10,name:a,bold:!0},f.getCell("I".concat(v+9)).alignment={horizontal:"center",vertical:"middle"},f.mergeCells("I".concat(v+9," : L").concat(v+9)),f.getRow(6).font={bold:!0,size:10},f.getRow(5).font={bold:!0,size:10},o.xlsx.writeBuffer().then(e=>{let l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(l),n=document.createElement("a");document.body.appendChild(n),n.setAttribute("style","display: none"),n.href=r,n.download="REKAPITULASI KINERJA PER RELASI "+t.toUpperCase()+".xlsx",n.click(),window.URL.revokeObjectURL(r),n.remove()})};function C(){var e,t;let l=(0,o.useContext)(n.Z),i=(0,a.usePathname)(),g=s.Z.useApp(),[f,y]=(0,o.useState)([null,null]),[C,T]=(0,o.useState)(null),[M,w]=(0,o.useState)(),[x,v]=(0,o.useState)(null),[N,S]=(0,o.useState)(!1),[j,A]=(0,o.useState)([1,"month"]),[P,Y]=(0,o.useState)(0),D=null==l?void 0:null===(t=l.dataUser)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.username,E=[[254,249,195],[255,255,255],[121,193,235],["000000"]],K={headerColumn:null==M?void 0:M.n_line_1,reportColumn:null==M?void 0:M.n_line_2,periodeColumn:null==M?void 0:M.n_line_4,periodeColumn2:"Tahun  ",dateColumn:C};(0,o.useEffect)(()=>{if(null!=f){let n="",o="",a=0;if(1==j[0])n=f,o=f;else if(2==j[0]){if(f){n=f;var e=new Date(f);e.setMonth(e.getMonth()+2);var t=d()(e).format("DD"),l=d()(e).format("MM");o=d()(e).format("YYYY")+"-"+l+"-"+t}}else if(4==j[0]&&f){a=1,n=f;var r=d()(f).startOf("year").format("YYYY").toString();n=d()(r).format(),o=d()(r).endOf("year").format()}let i=n,s=o,c=d()(i).format("MMMM YYYY"),b=d()(s).format("MMMM YYYY");T((1==a?"Tahun "+d()(i).format("YYYY"):c==b?c:c+" - "+b).toUpperCase())}S(!0);let n=async()=>{let e="",t="",l="",r="";if(1==j[0])e=d()(f).format("MM"),t=d()(f).format("YYYY"),l=d()(f).format("MM"),r=d()(f).format("YYYY");else if(2==j[0]){if(f){e=d()(f).format("MM"),t=d()(f).format("YYYY");var n=new Date(f);n.setMonth(n.getMonth()+2),l=d()(n).format("MM"),r=d()(n).format("YYYY")}}else f&&(e="01",t=d()(f).format("YYYY"),l="12",r=d()(f).format("YYYY"));let o=e+"_"+l,a=t+"_"+r,i=await (0,b.Z)().get("report-type/RECAP_PERFORMANCE_BY_RELATION"),s=await (0,b.Z)().get("report/recap-performance-by-relation?period_month="+o+"&period_year="+a);(0,p.Z)({res:s,app:g})&&v(s.data),(0,p.Z)({res:i,app:g})&&w(null==i?void 0:i.data),S(!1)};f&&"Invalid Date"!==d()(f).format("YYYY-MM-DD")&&"Invalid Date"!==d()(f).format("YYYY-MM-DD")?(S(!0),n()):v(null)},[f,j,g]);let I=(e,t,r,n)=>{if("pdf"==e)u(t,r,n,E,K,D,l);else{if("excel"!=e)return"";k(t,r,n,E,K)}},{message:z,notification:U,modal:L}=g,[F,R]=(0,o.useState)(!1),O=async e=>{R(!0);let t=async()=>{try{return"pdf"==e?I("pdf",x,C,M):I("excel",x,C,M),!0}catch(e){return console.log(e),!1}};setTimeout(async()=>{await t()?setTimeout(()=>{z.open({type:"success",content:(0,r.jsx)("span",{className:" capitalize",children:"Export Success"})}),R(!1)},1e3):setTimeout(()=>{z.open({type:"error",content:(0,r.jsx)("span",{className:" capitalize",children:"Export Invalid"})}),R(!1)},1e3)},500)};return(0,r.jsx)(h.Z,{pathname:i,globalState:l,children:(0,r.jsxs)(m.Z,{type:j[1],loadingExport:F,childrenInput:(0,r.jsxs)("div",{className:"flex flex-col ml-2",children:[(0,r.jsx)("span",{id:"subject",className:"mb-5 mt-3  text-[14px]",children:"Tipe"}),(0,r.jsx)(c.default,{disabled:F,placeholder:"Select Filter",onChange:e=>{Y(P+1);let t="",l=0;"month"==e?(t="month",l=1):"triwulan"==e?(t="triwulan",l=2):(t="year",l=4),A([l,t])},defaultValue:"month",className:"max-md:w-full",options:[{value:"month",label:"Per Bulan"},{value:"triwulan",label:"Per Triwulan"},{value:"year",label:"Per Tahun"}]})]}),onDelete:()=>v(void 0),data:x,loading:N,dateChange:e=>y(e),downloadPdf:()=>O("pdf"),downloadExcel:()=>O("excel"),onChangeTri:P,children:[_.x4.web.header(M,"".concat(K.periodeColumn+C)),(0,r.jsxs)("div",{className:"overflow-x-auto",children:[(0,r.jsxs)("table",{className:"w-full mb-6 table-auto border-collapse border border-solid dark:border-white border-black uppercase",style:{whiteSpace:"nowrap"},children:[(0,r.jsxs)("thead",{className:"dark:bg-black bg-tbl-header",style:_.wF.web.headerTable,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Asal"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Tujuan"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:"Jarak (Km)"}),(0,r.jsx)("p",{children:" Gapeka"})]})}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Frek KA"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:" Tempat Duduk"}),(0,r.jsx)("p",{children:" Penumpang"})]})}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"TD-KM"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Volume PNP"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"KM-PNP"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Pendapatan"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",colSpan:2,children:"Okupansi"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Statis"}),(0,r.jsx)("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Dinamis"})]}),(0,r.jsx)("tr",{children:(()=>{let e=[];for(let t=0;t<12;t++)e.push((0,r.jsx)("td",{className:"border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),(0,r.jsx)("tbody",{style:_.wF.web.bodyTable,children:null==x?void 0:x.map((e,t)=>{var l,n,a;let i=new Date(null==e?void 0:null===(l=e.summary[0])||void 0===l?void 0:l.d_opr);return d()(i),(0,r.jsxs)(o.Fragment,{children:[0==t&&(null===(n=e.data_rows)||void 0===n?void 0:n.map((e,t)=>{let l=t%2==0?"even-row dark:even-row":"";return(0,r.jsxs)("tr",{className:"text-center ".concat(l),children:[(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:t+1}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.c_station_start)}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.c_station_end)}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_distance,(0,_.Gx)(e.i_distance,".",","))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.uf)(e.i_volume_pnp)}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_km_pnp))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:(0,_.TM)(e.i_income,(0,_.uf)(e.i_income))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_static)?"-":""===(0,_.TM)(e.i_o_static)?(0,_.TM)(""):(0,_.TM)(e.i_o_static)+"%"}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_dynamic)?"-":""===(0,_.TM)(e.i_o_dynamic)?(0,_.TM)(""):(0,_.TM)(e.i_o_dynamic)+"%"})]},t)})),0==t&&(null===(a=e.summary)||void 0===a?void 0:a.map((e,t)=>(0,r.jsxs)("tr",{className:"text-center font-bold dark:bg-black bg-tbl-footer",style:_.wF.web.bodyTotal,children:[(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",colSpan:4,children:"Total"}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_volume_pnp))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_km_pnp,(0,_.uf)(e.i_km_pnp))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:(0,_.TM)(e.i_income,(0,_.uf)(e.i_income))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_static,(0,_.uf)(e.i_o_static))?"-":""===(0,_.TM)(e.i_o_static,(0,_.uf)(e.i_o_static))?(0,_.TM)(""):(0,_.TM)(e.i_o_static,(0,_.uf)(e.i_o_static))+"%"}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_dynamic,(0,_.uf)(e.i_o_dynamic))?"-":""===(0,_.TM)(e.i_o_dynamic,(0,_.uf)(e.i_o_dynamic))?(0,_.TM)(""):(0,_.TM)(e.i_o_dynamic,(0,_.uf)(e.i_o_dynamic))+"%"})]},"summary_".concat(t))))]},t)})})]}),(0,r.jsxs)("table",{className:"w-full mb-5 table-auto border-collapse border border-solid dark:border-white border-black uppercase",style:{whiteSpace:"nowrap"},children:[(0,r.jsxs)("thead",{className:"dark:bg-black bg-tbl-header",style:_.wF.web.headerTable,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black ",rowSpan:2,children:"No"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Asal"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Tujuan"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:"Jarak (Km)"}),(0,r.jsx)("p",{children:" Gapeka"})]})}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Frek KA"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:(0,r.jsxs)("div",{style:{lineHeight:1,padding:3},children:[(0,r.jsx)("p",{children:" Tempat Duduk"}),(0,r.jsx)("p",{children:" Penumpang"})]})}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"TD-KM"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Volume PNP"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"KM-PNP"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",rowSpan:2,children:"Pendapatan"}),(0,r.jsx)("th",{className:" px-2 border border-solid dark:border-white border-black",colSpan:2,children:"Okupansi"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Statis"}),(0,r.jsx)("th",{className:"px-2 border border-solid dark:border-white border-black",children:"Dinamis"})]}),(0,r.jsx)("tr",{children:(()=>{let e=[];for(let t=0;t<12;t++)e.push((0,r.jsx)("td",{className:"border border-solid dark:border-white border-black text-center font-bold",children:t+1},t));return e})()})]}),(0,r.jsx)("tbody",{style:_.wF.web.bodyTable,children:null==x?void 0:x.map((e,t)=>{var l,n,a;let i=new Date(null==e?void 0:null===(l=e.summary[0])||void 0===l?void 0:l.d_opr);return d()(i),(0,r.jsxs)(o.Fragment,{children:[1==t&&(null===(n=e.data_rows)||void 0===n?void 0:n.map((e,t)=>{let l=t%2==0?"even-row dark:even-row":"";return(0,r.jsxs)("tr",{className:"text-center ".concat(l),children:[(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:t+1}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.c_station_start)}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.c_station_end)}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_distance,(0,_.Gx)(e.i_distance,".",","))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.uf)(e.i_volume_pnp)}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_km_pnp))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:(0,_.TM)(e.i_income,(0,_.uf)(e.i_income))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_static)?"-":""===(0,_.TM)(e.i_o_static)?(0,_.TM)(""):(0,_.TM)(e.i_o_static)+"%"}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_dynamic)?"-":""===(0,_.TM)(e.i_o_dynamic)?(0,_.TM)(""):(0,_.TM)(e.i_o_dynamic)+"%"})]},t)})),1==t&&(null===(a=e.summary)||void 0===a?void 0:a.map((e,t)=>(0,r.jsxs)("tr",{className:"text-center font-bold dark:bg-black bg-tbl-footer",style:_.wF.web.bodyTotal,children:[(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",colSpan:4,children:"Total"}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_train_frequency,(0,_.uf)(e.i_train_frequency))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_passenger_seat,(0,_.uf)(e.i_passenger_seat))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_td_km,(0,_.uf)(e.i_td_km))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_volume_pnp,(0,_.uf)(e.i_volume_pnp))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:(0,_.TM)(e.i_km_pnp,(0,_.uf)(e.i_km_pnp))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black text-right",children:(0,_.TM)(e.i_income,(0,_.uf)(e.i_income))}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_static,(0,_.uf)(e.i_o_static))?"-":""===(0,_.TM)(e.i_o_static,(0,_.uf)(e.i_o_static))?(0,_.TM)(""):(0,_.TM)(e.i_o_static,(0,_.uf)(e.i_o_static))+"%"}),(0,r.jsx)("td",{className:"p-2 border border-solid dark:border-white border-black",children:"-"===(0,_.TM)(e.i_o_dynamic,(0,_.uf)(e.i_o_dynamic))?"-":""===(0,_.TM)(e.i_o_dynamic,(0,_.uf)(e.i_o_dynamic))?(0,_.TM)(""):(0,_.TM)(e.i_o_dynamic,(0,_.uf)(e.i_o_dynamic))+"%"})]},"summary_".concat(t))))]},t)})})]})]})]})})}}},function(e){e.O(0,[2505,3113,8173,9141,2470,3919,8348,2100,4309,5053,5458,2034,9155,7824,4746,5141,7642,1105,2971,7023,1744],function(){return e(e.s=60699)}),_N_E=e.O()}]);