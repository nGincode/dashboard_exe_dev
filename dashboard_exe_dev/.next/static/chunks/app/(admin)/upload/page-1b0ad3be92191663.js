(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2962,4527],{51848:function(e,t,l){Promise.resolve().then(l.bind(l,68784))},68784:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eb}});var a=l(57437),s=l(2265),n=l(27233),i=l(68348),o=l(93122),r=l(25057),u=l(46682),d=l(9257),c=l(78421),m=l(24772),p=l(30252),h=l(52943),f=l(90563),v=l(63632),x=l(51935),_=l(37944),g=l(82438),b=l(85313),k=l(44921),w=l(8001),y=l(25858),N=l(95710),j=l(22034),S=l(16463),A=l(62737),M=l.n(A);l(65799);var R=l(66648),C=l(30939),T=l(71275),I=l(65188),P=l(57608),Y=l(18676),O=l(42005),L=l(61438),D=l.n(L),Z=l(60555),E=l.n(Z),F=l(9109).lW;let z=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=F.from(s),i=[],o=[],r=0,u=0,d={keyword:null,header_column:[]};return(await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{let l=e.values;if(1==t)d.keyword=String(l[1]).toUpperCase();else if(5==t)d.header_column=[...d.header_column,...l.filter(e=>e).map(e=>String(e).toUpperCase())];else if(6==t)d.header_column=[...d.header_column,...l.filter(e=>e).map(e=>String(e).toUpperCase())];else if(3==t){var a,s;let e=M()(null==l?void 0:l[2]).format("MM/YYYY").split("/");(null==e?void 0:null===(a=e[0])||void 0===a?void 0:a.length)===2&&(null==e?void 0:null===(s=e[1])||void 0===s?void 0:s.length)===4?(o.push({status:"success",mess:"PERIODE : "+M()(null==l?void 0:l[2]).format("MMMM YYYY").toUpperCase()}),r=Number(e[0]),u=Number(e[1])):o.push({status:"err",mess:"Row : "+t+" PERIODE Not Valid"})}else if(t>=8){let e={i_trainset:null,c_station_from:null,c_station_to:null,i_distance:null,i_freq:null,i_m1:null,i_m2:null,i_m3:null,i_m4:null,i_m5:null,i_m6:null,i_m7:null,i_m8:null,i_m9:null,i_m10:null,i_m11:null,i_m12:null,i_m13:null,i_m14:null,i_m15:null,i_m16:null,i_m17:null,i_m18:null,i_m19:null,i_m20:null,i_m21:null,i_m22:null,i_m23:null,i_m24:null,i_m25:null,i_m26:null,i_m27:null,i_m28:null,i_m29:null,i_m30:null,i_m31:null,i_total_m:null};l.map((t,l)=>{let a=(null==t?void 0:t.result)?t.result:(null==t?void 0:t.richText)?null==t?void 0:t.richText.map(e=>e.text).toString().replaceAll(",",""):t;switch(l){case 2:e.i_trainset=Number(a);break;case 3:e.c_station_from=a;break;case 4:e.c_station_to=a;break;case 5:e.i_distance=a?Number("".concat(a).replaceAll(",",".")):null;break;case 6:e.i_freq=a;break;case 7:e.i_m1=a;break;case 8:e.i_m2=a;break;case 9:e.i_m3=a;break;case 10:e.i_m4=a;break;case 11:e.i_m5=a;break;case 12:e.i_m6=a;break;case 13:e.i_m7=a;break;case 14:e.i_m8=a;break;case 15:e.i_m9=a;break;case 16:e.i_m10=a;break;case 17:e.i_m11=a;break;case 18:e.i_m12=a;break;case 19:e.i_m13=a;break;case 20:e.i_m14=a;break;case 21:e.i_m15=a;break;case 22:e.i_m16=a;break;case 23:e.i_m17=a;break;case 24:e.i_m18=a;break;case 25:e.i_m19=a;break;case 26:e.i_m20=a;break;case 27:e.i_m21=a;break;case 28:e.i_m22=a;break;case 29:e.i_m23=a;break;case 30:e.i_m24=a;break;case 31:e.i_m25=a;break;case 32:e.i_m26=a;break;case 33:e.i_m27=a;break;case 34:e.i_m28=a;break;case 35:e.i_m29=a;break;case 36:e.i_m30=a;break;case 37:e.i_m31=a;break;case 38:e.i_total_m=a}}),e.i_total_m=Number(e.i_m1)+Number(e.i_m2)+Number(e.i_m3)+Number(e.i_m4)+Number(e.i_m5)+Number(e.i_m6)+Number(e.i_m7)+Number(e.i_m8)+Number(e.i_m9)+Number(e.i_m10)+Number(e.i_m11)+Number(e.i_m12)+Number(e.i_m13)+Number(e.i_m14)+Number(e.i_m15)+Number(e.i_m16)+Number(e.i_m17)+Number(e.i_m18)+Number(e.i_m19)+Number(e.i_m20)+Number(e.i_m21)+Number(e.i_m22)+Number(e.i_m23)+Number(e.i_m24)+Number(e.i_m25)+Number(e.i_m26)+Number(e.i_m27)+Number(e.i_m28)+Number(e.i_m29)+Number(e.i_m30)+Number(e.i_m31),E()(e.i_trainset)&&E()(e.i_distance)?e.c_station_from&&e.c_station_to&&e.i_freq&&e.c_station_to&&e.c_station_to?i.push(e):o.push({status:"warning",mess:"Row : "+t+" incomplete (not upload)"}):o.push({status:"warning",mess:"Row : "+t+" Trainset/Jarak only number (not upload)"})}})})}),o.find(e=>"err"===e.status))?{mess:o,data:null,format:d}:{mess:o,data:{data:i,month:r,year:u},format:d}};var U=l(8558),B=l.n(U),W=l(9109).lW;let $=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=W.from(s),i=[],o=[],r="",u="",d=[];await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{let l=e.values;if(2==t&&(u=(null==l?void 0:l[1])?l[1]:""),3==t){if(null==l?void 0:l[2]){let e=V(l[2]);""!==e?(o.push({status:"success",mess:"PRIODE : "+e}),r=e):o.push({status:"err",mess:" PRIODE Not Valid"})}else o.push({status:"err",mess:" PRIODE Cannot empty (ex: 12/2023)"})}i.push(l.map(e=>e))})})});let c=[],m="",p="";if(r){let e=r.split("/");m=e[0],p=e[1]}return(i.map((e,t)=>{let l="";if(5==t&&(d.push(i[t][1]),d.push(i[t][2]),d.push(i[t][3]),d.push(i[t][4]),d.push(i[t][5]),d.push(i[t][6]),d.push(i[t][7]),d.push(i[t][8]),d.push(i[t][9]),d.push(i[t][11]),d.push(i[t][12])),t>5){let e=i[t][2]?H(i[t][2]):"",a=i[t][8]?q(i[t][8]):"",s=i[t][9]?q(i[t][9]):"",n=i[t][11]?q(i[t][11]):"",o=i[t][12]?q(i[t][12]):"";l={i_period_month:m,i_period_year:p,d_opr:e,c_noka:i[t][3],n_train:i[t][4],c_station_start:i[t][5],c_station_end:i[t][6],i_distance:i[t][7],t_p_departure:a,t_p_arrive:s,t_r_departure:n,t_r_arrive:o},null==m||null==p||null==e||null===i[t][3]||void 0===i[t][3]||null===i[t][4]||void 0===i[t][4]||null===i[t][5]||void 0===i[t][5]||null===i[t][6]||void 0===i[t][6]||null===i[t][7]||void 0===i[t][7]||null==a||null==s||null==n||null==o||c.push(l)}}),o.find(e=>"err"===e.status))?{mess:o,data:null,format:{keyword:u,header_column:d}}:{mess:o,data:{data:c,month:m,year:p},format:{keyword:u,header_column:d}}},H=e=>{let t=new Date(e),l=M()(t);return l.isValid()?M()(l).format("YYYY-MM-DD"):""},V=e=>{let t=new Date(e),l=M()(t);return l.isValid()?M()(l).format("MM/YYYY"):""},q=e=>{let t="",l=new Date(e);return M()(l).isValid()?(M().extend(B()),t=M().utc(e).format("HH:mm:ss")):t="",t};var J=l(22599),K=l.n(J),G=l(9109).lW;let X=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=G.from(s),i=[],o=[],r="",u={keyword:null,header_column:[]},d=0,c=!1;await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{if(!c){let s=e.values;if(1==t)u.keyword=String(s[1]).toUpperCase();else if(5==t)u.header_column=[...u.header_column,...s.filter(e=>e).map(e=>String(e).toUpperCase())];else if(3==t){var l,a;let e=M()(null==s?void 0:s[2]).format("MM/YYYY").split("/");(null==e?void 0:null===(l=e[0])||void 0===l?void 0:l.length)===2&&(null==e?void 0:null===(a=e[1])||void 0===a?void 0:a.length)===4?(o.push({status:"success",mess:"PERIODE : "+M()(null==s?void 0:s[2]).format("MMMM YYYY").toUpperCase()}),r=M()(null==s?void 0:s[2]).format("YYYY-MM-DD")):o.push({status:"err",mess:"Row : "+t+" PERIODE Not Valid"})}else(null==s?void 0:s[1])||(null==s?void 0:s[2])||(null==s?void 0:s[3])||(null==s?void 0:s[4])||null==s||!s[5]?t>5&&i.push(s.map(e=>(null==e?void 0:e.result)?e.result:(null==e?void 0:e.richText)?e.richText.map(e=>e.text).toString().replaceAll(",",""):e)):(i.push(s.map(e=>(null==e?void 0:e.result)?e.result:(null==e?void 0:e.richText)?e.richText.map(e=>e.text).toString().replaceAll(",",""):e)),d+=1,String(null==s?void 0:s[5]).toUpperCase().includes("NIPP")?c=!0:String(null==s?void 0:s[6]).toUpperCase().includes("NIPP")&&(c=!0))}})})});for(let e=1;e<=d;e++){let e=i.length-1;i=i.filter((t,l)=>l!=e).map(e=>e.map(e=>""===e?null:e))}let m=[];d=0,c=!1;let p=!1,h=!1;return(await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{let l=e.values;(null==l?void 0:l[1])=="PENDAPATAN NON FAREBOX (PENDAPATAN NON TIKET)"&&(h=!0),!c&&((null==l?void 0:l[1])||(null==l?void 0:l[2])||null==l||!l[3]?h&&m.push(l.map(e=>(null==e?void 0:e.result)?e.result:(null==e?void 0:e.richText)?e.richText.map(e=>e.text).toString().replaceAll(",",""):e)):(d+=1,String(null==l?void 0:l[3]).toUpperCase().includes("NIPP")?(c=!0,p=!0):String(null==l?void 0:l[4]).toUpperCase().includes("NIPP")&&(c=!0,p=!0)))})})}),p)?h?o.find(e=>"err"===e.status)?{mess:K().uniqBy(o,"mess"),data:null,format:u}:{mess:o,data:{data:JSON.stringify([...i,...m]),periode:r},format:u}:(o.push({status:"Format Invalid",mess:" Table 2 Not Valid"}),{mess:K().uniqBy(o,"mess"),data:null}):(o.push({status:"Format Invalid",mess:" Nipp Not Found"}),{mess:K().uniqBy(o,"mess"),data:null})};var Q=l(9109).lW;let ee=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=Q.from(s),i=[],o=[],r=!1,u="",d="",c="",m={keyword:null,header_column:[]};return(await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{var l,a,s,n,p,h,f,v;let x=e.values;if(3==t)m.keyword=x[1];else if(9==t)m.header_column=[...m.header_column,...x.filter(e=>e).map(e=>String(e).toUpperCase())];else if(5==t){if(null==x?void 0:x[2]){let e=M()(null==x?void 0:x[2]).format("MM/YYYY"),t=e.split("/");(null==t?void 0:null===(l=t[0])||void 0===l?void 0:l.length)!==2||(null==t?void 0:null===(a=t[1])||void 0===a?void 0:a.length)!==4?o.push({status:"err",mess:" PRIODE Not Valid"}):(o.push({status:"success",mess:"PRIODE : "+e}),u=e,d=M()(null==x?void 0:x[2]).format("DD"),c=M()(null==x?void 0:x[2]).format("YYYY"))}else o.push({status:"err",mess:" Periode cannot be null"})}if(t>=10&&(((null==x?void 0:null===(s=x[1])||void 0===s?void 0:s.toString().toLowerCase())==="total"||(null==x?void 0:null===(n=x[2])||void 0===n?void 0:n.toString().toLowerCase())==="total")&&(r=!0),!r)){let e={i_trainset:null,i_total:null,i_type:null,i_total_p:null,i_total_r:null};e.i_trainset=null!==(p=null==x?void 0:x[2])&&void 0!==p?p:null,e.i_total=null!==(h=null==x?void 0:x[3])&&void 0!==h?h:null,e.i_type=(null==x?void 0:x[4])?x[4].toUpperCase():null,e.i_total_p=null!==(f=parseInt(null==x?void 0:x[5]))&&void 0!==f?f:null,e.i_total_r=null!==(v=parseInt(null==x?void 0:x[6]))&&void 0!==v?v:null,i.push(e)}})})}),o.find(e=>"err"===e.status))?{mess:K().uniqBy(o,"mess"),data:null,format:m}:{mess:o,data:{data:i,periode:u,month:d,year:c},format:m}};var et=l(9109).lW;let el=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=et.from(s),i=[],o=[],r=0,u=0,d="",c=[];return await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{let l=e.values;if(3==t&&(d=(null==l?void 0:l[1])?null==l?void 0:l[1].toUpperCase():""),4==t&&(null==l?void 0:l[3])){let e=new Date(null==l?void 0:l[3]);r=e.getMonth()+1,u=e.getFullYear()}if(5==t&&(c=Object.values(l)),o=[{status:"success",mess:"PERIODE : "+r+"/"+u}],1970===u&&(o=[{status:"err",mess:"Format Not Valid"}]),r||u||(o=[{status:"err",mess:"PERIODE Not Valid"}]),t>=6&&!l.includes("TOTAL PER BULAN")){let e={i_trainset:null,i_interior_wash:0};l.map((t,l)=>{switch(l){case 2:"object"==typeof t&&(t=t.result),e.i_trainset=t;break;case 3:e.i_interior_wash=t||0}}),null!=e.i_trainset&&i.push(e)}})})}),{mess:o,data:{month:r,year:u,data:i},format:{keyword:d,header_column:c}}};var ea=l(9109).lW;let es=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=ea.from(s),i=[],o=[],r=0,u=0,d="",c=[];return await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{let l=e.values;if(3==t&&(d=(null==l?void 0:l[1])?null==l?void 0:l[1].toUpperCase():""),4==t&&(null==l?void 0:l[3])){let e=new Date(null==l?void 0:l[3]);r=e.getMonth()+1,u=e.getFullYear()}if(5==t&&(c=Object.values(l)),o=[{status:"success",mess:"PERIODE : "+r+"/"+u}],1970===u&&(o=[{status:"err",mess:"Format Not Valid"}]),r||u||(o=[{status:"err",mess:"PERIODE Not Valid"}]),t>=6&&!l.includes("TOTAL")){let e={i_trainset:null,i_total_day:0,i_total_day_otc:0,i_total_freq_day_otc:0};l.map((t,l)=>{switch(l){case 2:"object"==typeof t&&(t=t.result),e.i_trainset=t;break;case 3:e.i_total_day=t||0;break;case 4:e.i_total_day_otc=t||0;break;case 5:e.i_total_freq_day_otc=t||0}}),null!=e.i_trainset&&i.push(e)}})})}),{mess:o,data:{month:r,year:u,data:i},format:{keyword:d,header_column:c}}};var en=l(9109).lW;let ei=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=en.from(s),i=[],o=0,r=0,u=[],d={keyword:null,header_column:[]};return await a.xlsx.load(n).then(()=>{let e=a.getWorksheet();if(!e)throw Error("Worksheet tidak ditemukan.");let t=e.getCell("D4").value;o=M()(t).month()+1,r=M()(t).year();let l=0;e.eachRow({includeEmpty:!1},function(e,t){let a=e.values;2==t?d.keyword=String(a[3]).toUpperCase():5==t&&(d.header_column=[...d.header_column,...a.filter(e=>e).map(e=>String(e).toUpperCase())]);let s=e.getCell("B").value;s&&s.toString().includes("TOTAL PER BULAN")&&(l=t)});for(let t=7;t<l;t++){let l={i_trainset:e.getCell("C".concat(t)).value,i_total_month:e.getCell("D".concat(t)).value};u.push(l)}o||r?i.push({status:"success",mess:"PRIODE "+M()(r+"/"+o).format("MMMM YYYY")}):i.push({status:"err",mess:"PRIODE Not Valid"})}),{mess:i,data:{month:o,year:r,data:u},format:d}};var eo=l(9109).lW;let er=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=eo.from(s),i=[{status:"success",mess:"PRIODE"}],o=0,r=0,u=[],d="",c=[];return await a.xlsx.load(n).then(()=>{let e=a.getWorksheet(1);if(!e)throw Error("Worksheet tidak ditemukan.");let t=new Date(e.getCell("D4").value);o=t.getMonth()+1,r=t.getFullYear();let l=t.toLocaleString("id-ID",{month:"long"}),s=0;e.eachRow({includeEmpty:!1},function(e,t){let l=e.getCell("B").value,a=e.values;2==t&&(d=(null==a?void 0:a[2])?null==a?void 0:a[2].toUpperCase():""),l&&l.toString().includes("TOTAL PER BULAN")&&(s=t),5==t&&(c=Object.values(a))});for(let t=7;t<s;t++){let l={i_trainset:e.getCell("C".concat(t)).value,i_total_month:e.getCell("D".concat(t)).value};u.push(l)}i=[{status:"success",mess:"PRIODE : "+l+" "+r}],1970===r&&(i=[{status:"err",mess:"Format Not Valid"}]),o||r||(i=[{status:"err",mess:"PRIODE Not Valid"}])}),{mess:i,data:{month:o,year:r,data:u},format:{keyword:d,header_column:c}}};var eu=l(9109).lW;let ed=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=eu.from(s);console.log(null==l?void 0:l.user);let i=[],o=[],r="",u="",d="",c=!1,m={keyword:null,header_column:[]};return(await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{var l,a,s;let n=e.values;if(2==t?m.keyword=String(n[1]).toUpperCase():4==t&&(m.header_column=[...n.filter(e=>e).map(e=>String(e).toUpperCase())]),3==t){if(null==n?void 0:n[3]){let e=M()(null==n?void 0:n[3]).format("MM/YYYY"),t=e.split("/");(null==t?void 0:null===(l=t[0])||void 0===l?void 0:l.length)!==2||(null==t?void 0:null===(a=t[1])||void 0===a?void 0:a.length)!==4?o.push({status:"err",mess:" PRIODE Not Valid"}):(o.push({status:"success",mess:"PRIODE : "+e}),r=e,u=null==t?void 0:t[0],d=null==t?void 0:t[1],console.log("periode",r))}else o.push({status:"err",mess:" Periode cannot be null"})}t>=6&&((null==n?void 0:null===(s=n[1])||void 0===s?void 0:s.toString().toLowerCase())==="total"&&(c=!0),c||i.push({i_trainset:null==n?void 0:n[2],i_total_day:null==n?void 0:n[3],i_total_ka:null==n?void 0:n[4],i_freq_ka:null==n?void 0:n[5]}))})})}),console.log("Format",m),o.find(e=>"err"===e.status))?{mess:K().uniqBy(o,"mess"),data:null,format:m}:{mess:o,data:{periode:r,month:u,year:d,user:null==l?void 0:l.username,data:i},format:m}};var ec=l(9109).lW;let em=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=ec.from(s),i=[],o=[],r="",u="",d=[];await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{let l=e.values;if(2==t&&(u=(null==l?void 0:l[1])?l[1]:""),3==t){if(null==l?void 0:l[2]){let e=eh(l[2]);""!==e?(o.push({status:"success",mess:"PRIODE : "+e}),r=e):o.push({status:"err",mess:" PRIODE Not Valid"})}else o.push({status:"err",mess:" PRIODE Cannot empty (ex: 12/2023)"})}i.push(l.map(e=>e))})})});let c=[],m="",p="";if(r){let e=r.split("/");m=e[0],p=e[1]}return(i.map((e,t)=>{let l="";if(4==t&&(d.push(i[t][1]),d.push(i[t][2]),d.push(i[t][3]),d.push(i[t][4]),d.push(i[t][5]),d.push(i[t][6]),d.push(i[t][7]),d.push(i[t][8]),d.push(i[t][9]),d.push(i[t][10]),d.push(i[t][11]),d.push(i[t][12]),d.push(i[t][13]),d.push(i[t][14]),d.push(i[t][15])),t>5){let e=i[t][3]?ep(i[t][3]):"",a=i[t][4]?ef(i[t][4]):"";i[t][15],i[t][16],l={i_period_month:m,i_period_year:p,c_noka:i[t][2],d_opr:e,t_departure:a,c_station_start:i[t][5],c_station_end:i[t][6],i_distance:i[t][7],i_fare:i[t][8],i_daily_frequency:i[t][9],i_train_frequency:i[t][10],i_passenger_seat:i[t][11],i_td_km:i[t][12],i_volume_pnp:i[t][13],i_km_pnp:i[t][14],i_income:i[t][15]},null===i[t][2]||void 0===i[t][2]||null===i[t][3]||void 0===i[t][3]||null===i[t][4]||void 0===i[t][4]||null===i[t][5]||void 0===i[t][5]||null===i[t][6]||void 0===i[t][6]||null===i[t][7]||void 0===i[t][7]||null===i[t][9]||void 0===i[t][9]||null===i[t][11]||void 0===i[t][11]||null===i[t][12]||void 0===i[t][12]||null===i[t][13]||void 0===i[t][13]||null===i[t][14]||void 0===i[t][14]||null===i[t][15]||void 0===i[t][15]||c.push(l)}}),o.find(e=>"err"===e.status))?{mess:o,data:null,format:{keyword:u,header_column:d}}:{mess:o,data:{data:c,month:m,year:p},format:{keyword:u,header_column:d}}},ep=e=>{let t=new Date(e),l=M()(t);return l.isValid()?M()(l).format("YYYY-MM-DD"):""},eh=e=>{let t=new Date(e),l=M()(t);return l.isValid()?M()(l).format("MM/YYYY"):""},ef=e=>{let t,l="";t=new Date("string"==typeof e?"1970-01-01 "+e:e);let a=M()(t);return a.isValid()?"string"==typeof e?l=a.format("HH:mm:ss"):(M().extend(B()),l=M().utc(e).format("HH:mm:ss")):l="",l};var ev=l(9109).lW;let ex=e=>(null==e?void 0:e.result)?e.result:(null==e?void 0:e.richText)?e.richText.map(e=>e.text).toString().replaceAll(",",""):e,e_=async e=>{let{file:t,user:l}=e,a=new(D()).Workbook,s=await t.arrayBuffer(),n=ev.from(s);console.log(null==l?void 0:l.user);let i=[],o=[],r="",u="",d="",c=!1,m={keyword:null,header_column:[]},p="";return(await a.xlsx.load(n).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{var l,a,s;let n=e.values;if(1==t?m.keyword=String(n[1]).toUpperCase():4==t&&(m.header_column=[...n.filter((e,t)=>3!=t).map(e=>String(e).toUpperCase())],p=n[3]),3==t){if(null==n?void 0:n[2]){let e=M()(null==n?void 0:n[2]).format("MM/YYYY"),t=e.split("/");(null==t?void 0:null===(l=t[0])||void 0===l?void 0:l.length)!==2||(null==t?void 0:null===(a=t[1])||void 0===a?void 0:a.length)!==4?o.push({status:"err",mess:" PERIODE Not Valid"}):(o.push({status:"success",mess:"PERIODE : "+e}),r=e,u=null==t?void 0:t[0],d=null==t?void 0:t[1],console.log("periode",r))}else o.push({status:"err",mess:" Periode cannot be null"})}if(t>=6){(null==n?void 0:null===(s=n[2])||void 0===s?void 0:s.toString())||(c=!0);for(let e=3;e<11;e++)(null==n?void 0:n[e])=="-"&&(n[e]=0);c||i.push({i_distance:ex(null==n?void 0:n[2]),i_kontrak_peak:ex(null==n?void 0:n[5]),i_kontrak_offpeak:ex(null==n?void 0:n[6]),i_realisasi_peak:ex(null==n?void 0:n[7]),i_realisasi_offpeak:ex(null==n?void 0:n[8]),i_selisih_peak:ex(null==n?void 0:n[9]),i_selisih_offpeak:ex(null==n?void 0:n[10]),tarif_km:ex(null==n?void 0:n[3]),tarif_km_offpeak:ex(null==n?void 0:n[4]),header_km:ex(p)})}})})}),console.log("Format",m),o.find(e=>"err"===e.status))?{mess:K().uniqBy(o,"mess"),data:null,format:m}:{mess:o,data:{periode:r,month:u,year:d,user:null==l?void 0:l.username,data:i},format:m}};M().locale("id");let{Dragger:eg}=n.default;function eb(){var e,t;let l=i.Z.useApp(),n=(0,s.useContext)(T.Z),[A,L]=(0,s.useState)(),D=(0,S.usePathname)(),[Z,E]=o.ZP.useMessage(),{token:F}=r.default.useToken(),[U,B]=(0,s.useState)(0),[W,H]=(0,s.useState)([]),[V,q]=(0,s.useState)(!1),[J,K]=(0,s.useState)(),[G,Q]=(0,s.useState)(),[et,ea]=(0,s.useState)(),en=()=>{B(U+1)},eo=()=>{B(U-1)};(0,s.useEffect)(()=>{H([]),K(void 0),q(void 0),ea(void 0)},[G]);let eu=[{label:"Realisasi Pendapatan & Biaya",code:"INCOME_COST",path:"/incomeCosts",apiPost:"/report-upload/income-cost",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI PENDAPATAN & BIAYA.xlsx",function:X},{label:"Stamformasi Trainset",code:"SF_TRAINSET",path:"/sfTrainset",apiPost:"/report-upload/sf-trainset",urlFormat:"/assets/format/FORMAT LAPORAN SFTRAINSET.xlsx",function:z},{label:"Realisasi Perawatan Sarana",code:"FACILTY_MAINTENACE",path:"/facilityMaintenance",apiPost:"/report-upload/facility_maintenance",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI PERAWATAN SARANA.xlsx",function:ee},{label:"Realisasi Polsuska/PAM/Walka",code:"POLSUSKA",path:"/polsuska",apiPost:"/report-upload/polsuska",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI POLSUSKA.xlsx",function:ed},{label:"Kelambatan Rata-Rata",code:"AVG_DELAY",path:"/averageDelay",apiPost:"/report-upload/average-delay",urlFormat:"/assets/format/FORMAT LAPORAN KETERLAMBATAN RATA RATA.xlsx",function:$},{label:"Realisasi Cuci Sarana KA",code:"WASHING_FACILITIES",path:"/washingFacilities",apiPost:"/report-upload/washing-facilities",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI CUCI SARANA.xlsx",function:el},{label:"Realisasi OTC (On Train Cleaning)",code:"OTC",path:"/otc",apiPost:"/report-upload/otc",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI OTC.xlsx",function:es},{label:"Realisasi Fumigasi",code:"FUMIGASI",path:"/fumigasi",apiPost:"/report-upload/fumigasi",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI FUMIGASI.xlsx",function:er},{label:"Realiasi Pest Control",code:"PEST_CONTROL",path:"/pestControl",apiPost:"/report-upload/pest-control",urlFormat:"/assets/format/FORMAT LAPORAN REALISASI PEST.xlsx",function:ei},{label:"Kinerja Per NO KA",path:"/performanceByTrainNumber",code:"PERFORMANCE_BY_TRAIN_NUMBER",apiPost:"/report-upload/performance-by-train-number",urlFormat:"/assets/format/FORMAT LAPORAN KINERJA PER NO KA.xlsx",function:em},{label:"Realisasi Tarif",code:"TARIF",path:"/volFare",apiPost:"/report-upload/vol-fare",urlFormat:"/assets/format/FORMAT LAPORAN TARIF.xlsx",function:e_}].filter(e=>{var t,l,a,s;let i=[];null==n||null===(s=n.dataUser)||void 0===s||null===(a=s.menuList)||void 0===a||null===(l=a.filter(e=>"Report"==e.title))||void 0===l||null===(t=l[0])||void 0===t||t.submenuItems.map(e=>{e.submenuItems?e.submenuItems.map(e=>{e.permission.includes("import")&&i.push(e)}):e.permission.includes("import")&&i.push(e)});let o=!1;return e.path&&(null==i||i.map(t=>{t.path==e.path&&(o=!0)})),!!o}),ec=[{title:"Choice Document Type",content:(0,a.jsx)("div",{className:"w-full p-5 pb-1 ",children:(0,a.jsx)(Y.Z,{onChange:e=>Q(e),placeholder:"Select..",id:"type",value:null!=G?G:null,label:"Type Report",className:"w-full",options:null===(e=eu.map(e=>({label:e.label,value:e.label})))||void 0===e?void 0:e.sort((e,t)=>e.label.localeCompare(t.label))})})},{title:"Download Format",content:(0,a.jsx)("a",{href:null===(t=eu.find(e=>e.label==G))||void 0===t?void 0:t.urlFormat,children:(0,a.jsx)(u.ZP,{icon:(0,a.jsx)(j.WlY,{}),children:"Format Import"})})},{title:"Upload Document",content:(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(eg,{name:"file",accept:".xlsx",maxCount:1,onRemove:e=>{let t=W.indexOf(e),l=W.slice();l.splice(t,1),H(l),K(void 0),q(void 0),ea(void 0)},defaultFileList:[...W],onDrop:e=>{var t;let l=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];H([]),K(void 0),q(void 0),ea(void 0),l?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!==l.type&&(q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," File is not a xlsx file"]})})}]),B(U+1)):(q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," File Not Valid"]})})}]),B(U+1))},beforeUpload:e=>("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type?(L(!0),H([e]),B(U+1),(async()=>{var t,s,i,o,r,u,c,m,p,h;let f=eu.find(e=>e.label==G),v=await (null==f?void 0:f.function({file:e,user:null==n?void 0:null===(t=n.dataUser)||void 0===t?void 0:t.user}));q(v.mess),K(v.data);let x=null===(i=v.data)||void 0===i?void 0:null===(s=i.periode)||void 0===s?void 0:s.split("/"),_=(null==x?void 0:x[1])?(null==x?void 0:x[1])+"-"+(null==x?void 0:x[0])+"-01":null===(o=v.data)||void 0===o?void 0:o.periode,g=_?M()(_,"YYYY-MM-DD").format("M"):null===(r=v.data)||void 0===r?void 0:r.month,b=_?M()(_,"YYYY-MM-DD").format("YYYY"):null===(u=v.data)||void 0===u?void 0:u.year,k=await (0,O.Z)().post("report/check-format",{code:null==f?void 0:f.code});if((0,C.Z)({res:k,app:l})){if(JSON.stringify(k.data)==JSON.stringify(v.format)){if(g&&b&&v.mess.length){if(v.mess.find(e=>"Format Invalid"==e.mess))q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," Format Invalid"]})})}]);else{let e=await (0,O.Z)().post("report/check",{code:null==f?void 0:f.code,month:Number(g),year:Number(b)});"00"==e.code?B(U+1):(null==e?void 0:null===(m=e.response)||void 0===m?void 0:null===(c=m.data)||void 0===c?void 0:c.code)=="407"?(ea(e.response.data.message),B(U+1)):(null==e?void 0:null===(h=e.response)||void 0===h?void 0:null===(p=h.data)||void 0===p?void 0:p.code)=="411"?(q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-green-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),"\xa0",e.response.data.message]})})}]),B(U+1),K(void 0),ea(void 0),H([])):((0,C.Z)({res:e,app:l}),H([]),K(void 0),q(void 0),ea(void 0),B(0))}}else H([]),K(void 0),ea(void 0),v.mess.length?v.mess.find(e=>"Format Invalid"==e.mess)?q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," Format Invalid"]})})}]):q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," Data Month / Year Required"]})})},...v.mess]):q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," Format Invalid"]})})}])}else H([]),K(void 0),ea(void 0),q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," Format Invalid"]})})}])}else H([]),K(void 0),ea(void 0),q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" capitalize text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," Server Unreachable"]})})}]);L(!1),d.Z.destroyAll()})()):(q([{mess:(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:" text-red-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0"," File is not a xlsx file"]})})}]),B(U+1)),!1),children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(v.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"Click or drag file import to this area to upload"}),(0,a.jsx)("p",{className:"ant-upload-hint",children:"Support for a single. Strictly prohibited from uploading company data or other banned files."})]})})},{title:"Finish",content:(0,a.jsx)(a.Fragment,{children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{indicator:(0,a.jsx)(x.Z,{style:{fontSize:25},spin:!0})})," Processing Data..."]}):(0,a.jsx)(a.Fragment,{children:V?(0,a.jsx)(a.Fragment,{children:(et?[{mess:"duplicate_data"},...V]:V).length?(0,a.jsx)(m.Z,{bordered:!0,dataSource:et?[{mess:"duplicate_data"},...V]:V,renderItem:e=>"duplicate_data"==e.mess?(0,a.jsx)(m.Z.Item,{children:(0,a.jsxs)("span",{className:" capitalize text-orange-600 animate-pulse text-3xl font-bold flex justify-center w-full",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-9 h-9",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"\xa0",et||null]})}):"success"==e.status?(0,a.jsxs)(m.Z.Item,{children:[(0,a.jsx)(p.default.Text,{children:(0,a.jsx)(_.Z,{twoToneColor:"#52c41a"})})," ",e.mess]}):"warning"==e.status?(0,a.jsxs)(m.Z.Item,{children:[(0,a.jsx)(p.default.Text,{children:(0,a.jsx)(g.Z,{className:"text-yellow-600"})})," ",(0,a.jsx)("span",{className:"text-yellow-600 font-bold",children:e.mess})]}):(0,a.jsxs)(m.Z.Item,{children:[e.status?(0,a.jsxs)(p.default.Text,{children:[" ",(0,a.jsx)(g.Z,{className:"text-red-600"})]}):null," ",(0,a.jsx)("span",{className:"text-red-600 font-bold",children:e.mess})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{})," Upload your file "]})}):(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)(b.Z,{})," Upload your file"]})})})}],ep=ec.map(e=>({key:e.title,title:e.title})),[eh,ef]=d.Z.useModal(),ev=async()=>{eh.confirm({title:et?"Do you want to modify import data?":"Do you want to import data?",icon:(0,a.jsx)(k.Z,{}),content:"You will import data to database",footer:(0,a.jsxs)("div",{className:"text-right mt-3",children:[(0,a.jsx)(u.ZP,{onClick:()=>{d.Z.destroyAll(),L(!1)},id:"confirm_modal_cancel",children:"Cancel"}),(0,a.jsx)(u.ZP,{className:"ml-2",onClick:()=>e(),id:"confirm_modal_ok",type:"primary",children:"Yes"}),(0,a.jsx)(u.ZP,{className:"ml-2",style:{display:"none"},id:"confirm_modal_loading",type:"primary",children:(0,a.jsx)(c.Z,{indicator:(0,a.jsx)(x.Z,{style:{fontSize:24,color:"white"},spin:!0})})})]})});let e=async()=>{var e,t,s,n,i,o;L(!0),document.getElementById("confirm_modal_cancel").style.display="none",document.getElementById("confirm_modal_ok").style.display="none",document.getElementById("confirm_modal_loading").style.display="unset";let r=[];if(Array.isArray(J.data)?(i=J.data,o="20000",Array.from({length:Math.ceil(i.length/o)},(e,t)=>{let l=t*o;return i.slice(l,l+o)})).map(e=>{r.push({...J,data:e})}):r=J,Array.isArray(r)){let n=[];if(r.length>0){for(let i=0;i<r.length;i++){let o=await (0,O.Z)().post(null===(e=eu.find(e=>e.label==G))||void 0===e?void 0:e.apiPost,r[i]);(0,C.Z)({res:o,app:l})?Z.open({key:"importStep",type:"loading",duration:500,content:(0,a.jsx)(h.Z,{strokeColor:{"0%":"#108ee9","100%":"#87d068"},className:"w-56",percent:Math.round((i+1)/r.length*100)})}):(null===(s=o.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.code)?n.push("Code:".concat(o.response.data.code," | Message:").concat(o.response.data.message)):n.push("Server not responding")}d.Z.destroyAll(),n.length?Z.open({key:"importStep",type:"error",duration:10,content:(0,a.jsx)("span",{className:"capitalize",children:n.map((e,t)=>" ".concat(t+1,") ").concat(e," \n"))})}):Z.open({key:"importStep",type:"success",content:(0,a.jsx)("span",{className:"capitalize",children:"Success Import"})}),H([]),K(void 0),q(void 0),ea(void 0),Q(void 0),L(!1),B(0)}else d.Z.destroyAll(),Z.open({type:"error",content:(0,a.jsx)("span",{className:"capitalize",children:"Data not found"})}),L(!1)}else{let e=await (0,O.Z)().post(null===(n=eu.find(e=>e.label==G))||void 0===n?void 0:n.apiPost,J);(0,C.Z)({res:e,app:l})&&(H([]),K(void 0),q(void 0),ea(void 0),Q(void 0),Z.open({key:"import",type:"success",content:(0,a.jsx)("span",{className:"capitalize",children:e.message})}),L(!1),B(0),d.Z.destroyAll())}L(!1)}};return(0,a.jsx)(I.Z,{pathname:D,globalState:n,children:(0,a.jsx)(P.Zb,{className:"border-none p-5 w-full shadow-lg",children:(null==eu?void 0:eu.length)?(0,a.jsxs)(a.Fragment,{children:[E,ef,(0,a.jsx)(f.Z,{current:U,items:ep,className:"mt-5"}),(0,a.jsx)("div",{style:{lineHeight:"260px",textAlign:"center",color:F.colorTextTertiary,backgroundColor:F.colorFillAlter,borderRadius:F.borderRadiusLG,border:"1px dashed ".concat(F.colorBorder),marginTop:16},children:ec[U].content}),(0,a.jsxs)("div",{style:{marginTop:24},children:[U>0&&!A&&(0,a.jsx)(u.ZP,{style:{margin:"0 8px"},icon:(0,a.jsx)(w.Z,{}),onClick:()=>eo(),children:"Prev"}),U<ec.length-1&&G&&(2==U?J?(0,a.jsx)(u.ZP,{type:"dashed",icon:(0,a.jsx)(y.Z,{}),loading:A,onClick:()=>en(),children:"Next"}):null:(0,a.jsx)(u.ZP,{type:"dashed",icon:(0,a.jsx)(y.Z,{}),loading:A,onClick:()=>en(),children:"Next"})),U===ec.length-1&&J&&!A&&(0,a.jsx)(u.ZP,{type:"primary",icon:(0,a.jsx)(N.Z,{}),loading:A,onClick:()=>ev(),children:"Import"})]})]}):(0,a.jsxs)("div",{className:"min-h-screen flex flex-col justify-center items-center overflow-x-hidden overflow-y-auto py-5",children:[(0,a.jsx)(R.default,{alt:"ilustrations",height:0,width:0,quality:70,src:"/assets/illustrations/maintenance.svg",className:"w-80 md:w-[28rem] 2xl:w-[40rem] shadow-sm  object-cover"}),(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold tracking-tight text-center",children:"Not Permission Upload"}),(0,a.jsx)("span",{className:"text-center mt-1 mb-5 text-zinc-600 dark:text-zinc-400 md:w-9/12 break-all px-10 sm:px-0",children:"Create Your Permission Upload"})]})})})}},60728:function(e,t,l){"use strict";l.d(t,{un:function(){return c},zx:function(){return d}});var a=l(57437),s=l(2265),n=l(71538),i=l(12218),o=l(13498),r=l(46682);let u=(0,i.j)("inline-flex items-center justify-center rounded-lg text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-400 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-zinc-950 dark:focus-visible:ring-zinc-800",{variants:{variant:{default:"bg-zinc-900 text-zinc-50 hover:bg-zinc-900/90 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/90",destructive:"bg-red-500 text-zinc-50 hover:bg-red-500/90 dark:bg-red-900 dark:text-red-50 dark:hover:bg-red-900/90",outline:"border border-zinc-200 bg-white hover:bg-zinc-100 hover:text-zinc-900 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",secondary:"bg-zinc-100 text-zinc-900 hover:bg-zinc-100/80 dark:bg-zinc-800 dark:text-zinc-50 dark:hover:bg-zinc-800/80",ghost:"hover:bg-zinc-100 hover:text-zinc-900 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",link:"text-zinc-900 underline-offset-4 hover:underline dark:text-zinc-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-lg px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:l,variant:s,size:i,asChild:r=!1,...d}=e,c=r?n.g7:"button";return(0,a.jsx)(c,{className:(0,o.cn)(u({variant:s,size:i,className:l})),ref:t,...d})});d.displayName="Button";let c=e=>{let{type:t,icon:l,loading:s,label:n,style:i,className:o}=e;return(0,a.jsx)(r.ZP,{htmlType:t,type:i,icon:l,loading:s,className:o,children:n})}},57608:function(e,t,l){"use strict";l.d(t,{Ol:function(){return o},SZ:function(){return u},Zb:function(){return i},aY:function(){return d},ll:function(){return r}});var a=l(57437),s=l(2265),n=l(13498);let i=s.forwardRef((e,t)=>{let{className:l,classNameFalse:s,...i}=e;return(0,a.jsx)("div",{ref:t,className:s?l:(0,n.cn)("rounded-2xl my-2 border border-zinc-200 bg-white text-zinc-950 shadow dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",l),...i})});i.displayName="Card",s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-2xl border border-zinc-200 bg-white text-zinc-950 shadow dark:border-zinc-800 dark:bg-zinc-900 dark:text-zinc-50",l),...s})}).displayName="Card900";let o=s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 px-6 py-3  rounded-t-2xl  bg-white dark:bg-black",l),...s})});o.displayName="CardHeader";let r=s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",l),...s})});r.displayName="CardTitle";let u=s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-zinc-500 dark:text-zinc-400 ",l),...s})});u.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-5 bg-white dark:bg-black rounded-b-2xl",l),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",l),...s})}).displayName="CardFooter"},18676:function(e,t,l){"use strict";var a=l(57437),s=l(73454),n=l(72100);t.Z=e=>{let{disabled:t,mode:l,type:i,value:o,placeholder:r,id:u,label:d,className:c,options:m,name:p,rules:h,onChange:f}=e,v=(e,t)=>{var l,a,s,n,i;return("object"==typeof(null==t?void 0:t.label)&&(null==t?void 0:t.label)!==null?null!==(n=null==t?void 0:null===(s=t.label)||void 0===s?void 0:null===(a=s.props)||void 0===a?void 0:null===(l=a.children)||void 0===l?void 0:l[2])&&void 0!==n?n:"":null!==(i=null==t?void 0:t.label)&&void 0!==i?i:"").toLowerCase().includes(e.toLowerCase())},x=e=>{console.log("search:",e)},_=e=>{f&&f(e)};return i?(0,a.jsx)(s.Z.Item,{name:p,label:d,hasFeedback:!0,rules:h,children:(0,a.jsx)(n.default,{disabled:t,showSearch:!0,placeholder:"Select..",className:c,options:m,optionFilterProp:"children",onSearch:x,filterOption:v,onChange:_,allowClear:!0,mode:l})}):(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(s.Z.Item,{name:p,label:d,hasFeedback:!0,rules:h,children:(0,a.jsx)(n.default,{disabled:t,showSearch:!0,placeholder:"Select..",className:c,options:m,optionFilterProp:"children",onSearch:x,filterOption:v,onChange:_,allowClear:!0,defaultValue:o})})})}},71275:function(e,t,l){"use strict";let a=l(2265).createContext({});t.Z=a},65188:function(e,t,l){"use strict";var a=l(57437),s=l(60728),n=l(66648),i=l(42005);t.Z=e=>{var t,l;let{children:o,pathname:r,globalState:u}=e;return(0,a.jsx)(a.Fragment,{children:(0,i.Z)().cekPermission(null!==(l=null==u?void 0:null===(t=u.dataUser)||void 0===t?void 0:t.menuList)&&void 0!==l?l:[],r)&&(null==u?void 0:u.permission.indexOf("view"))!=-1?o:(0,a.jsxs)("div",{className:" flex flex-col justify-center items-center overflow-x-hidden overflow-y-auto py-5",children:[(0,a.jsx)(n.default,{alt:"permission",height:0,width:0,quality:70,src:"/assets/illustrations/maintenance.svg",className:"w-80 md:w-[28rem] 2xl:w-[40rem] shadow-sm  object-cover"}),(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold tracking-tight text-center",children:"Not Permission"}),(0,a.jsx)("span",{className:"text-center mt-1 mb-5 text-zinc-600 dark:text-zinc-400 md:w-9/12 break-all px-10 sm:px-0",children:"It looks like the page you are looking for doesnt have permission"}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("a",{onClick:()=>window.location.href="/",children:(0,a.jsx)(s.zx,{variant:"outline",children:"Back to Home"})})})]})})}},30939:function(e,t,l){"use strict";var a=l(57437);t.Z=e=>{var t,l,s,n,i,o,r;let{res:u,app:d,type:c,msgTrue:m,msgFalse:p,key:h}=e,{message:f,notification:v,modal:x}=d;if(u)return(null==u?void 0:u.response)?(null==u?void 0:null===(t=u.response.data)||void 0===t?void 0:t.code)=="00"?(m&&!p&&("message"==c?f:"notification"==c?v:"modal"==c?x:f).open({key:null!=h?h:null==u?void 0:u.response.data.code,type:"success",content:(0,a.jsxs)("span",{className:" capitalize",children:[" ",null==u?void 0:u.response.data.message]})}),!0):(p||((null==u?void 0:null===(l=u.response.data)||void 0===l?void 0:l.code)?(null==u?void 0:u.response.data.code)=="403"||("message"==c?f:"notification"==c?v:"modal"==c?x:f).open({key:null!=h?h:u.code,type:"error",content:(0,a.jsxs)("span",{className:" capitalize",children:[" ",null==u?void 0:u.response.data.message]})}):("message"==c?f:"notification"==c?v:"modal"==c?x:f).open({key:null!=h?h:null==u?void 0:null===(s=u.response.data)||void 0===s?void 0:s.code,type:"error",content:(0,a.jsxs)("span",{className:" capitalize",children:[" ",null==u?void 0:null===(i=u.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.message]})})),!1):(null==u?void 0:u.code)=="00"?(m&&!p&&("message"==c?f:"notification"==c?v:"modal"==c?x:f).open({key:null!=h?h:u.code,type:"success",content:(0,a.jsxs)("span",{className:" capitalize",children:[" ",u.message]})}),!0):(p||((null==u?void 0:u.code)?"403"==u.code||("message"==c?f:"notification"==c?v:"modal"==c?x:f).open({key:null!=h?h:u.code,type:"error",content:(0,a.jsxs)("span",{className:" capitalize",children:[" ",u.message]})}):("message"==c?f:"notification"==c?v:"modal"==c?x:f).open({key:null!=h?h:null==u?void 0:u.code,type:"error",content:(0,a.jsxs)("span",{className:" capitalize",children:[" ",null==u?void 0:null===(r=u.response)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.message]})})),!1)}},42005:function(e,t,l){"use strict";var a=l(38472),s=l(62737),n=l.n(s),i=l(51470),o=l.n(i),r=l(9109).lW;n().extend(o()),t.Z=(e,t)=>{let l=a.Z.create({baseURL:"http://devbackend-psolrtjabodebek.kai.id/api/v1/",headers:e||{Accept:"application/json","Content-Type":"application/json"},...t});l.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e.headers["request-startTime"]=new Date().getTime(),e.headers["request-date"]=n()(),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>{let t=new Date().getTime(),l=e.config.headers["request-startTime"];return e.headers["request-duration"]=t-l,e});let s=()=>{var e,t;let l=!!(e=localStorage.getItem("accessToken"))&&JSON.parse(new r((null==e?void 0:null===(t=e.split("."))||void 0===t?void 0:t[1]).replace(/-/g,"+").replace(/_/g,"/"),"base64").toString("ascii"));return!!l&&l.token_id},i=async()=>l.get("/user/".concat(s())).then(e=>{let t=e.data.data.role_id;return l.post("/menu/list/",{role_id:t}).then(e=>e.data)}).catch(e=>e);return{idUser:s,login:async e=>l.post("/auth/login",e).then(e=>{let{data:t}=e;return localStorage.setItem("accessToken",t.data.accessToken),localStorage.setItem("refreshToken",t.data.refreshToken),sessionStorage.setItem("auth",JSON.stringify(t.data.user)),t}).catch(e=>{var t,l;return null!==(l=null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)&&void 0!==l?l:e}),get:async(e,t)=>l.get(e).then(e=>t?e:e.data).catch(e=>e),post:async(e,t,a)=>l.post(e,t,a).then(e=>e.data).catch(e=>e),menuUsers:i,menuApp:async()=>l.post("/menu/list/").then(e=>e.data).catch(e=>e),refresh_Token:async()=>{let e=localStorage.getItem("refreshToken");return!!e&&(l.interceptors.request.use(t=>(t.headers["refresh-token"]=e,t),e=>Promise.reject(e)),l.get("/auth/refresh-token").then(e=>{let{data:t}=e;return localStorage.setItem("accessToken",t.data.accessToken),localStorage.setItem("refreshToken",t.data.refreshToken),t}).catch(e=>!1))},cekPermission:(e,t)=>{let l=!1,a="",s=e=>{e.submenuItems.map(e=>{e.submenuItems?(""!==a&&(a=e.submenuItems[0].path),s(e)):e.path==t.replace("/admin","")&&(l=!0)})};return null==e||e.map(n=>{n.submenuItems?(""!==a&&(a=n.submenuItems[0].path),n.submenuItems.map(e=>{e.submenuItems?(""!==a&&(a=e.submenuItems[0].path),s(e)):e.path==t.replace("/admin","")&&(l=!0)})):(""==n.path?l=!0:""!==a&&e[0].path,n.path==t.replace("/admin","")&&(l=!0))}),!!l},put:async(e,t)=>l.put(e,t).then(e=>e.data).catch(e=>e),del:async(e,t)=>(console.log("data delete",t),l.delete(e,{data:t}).then(e=>e).catch(e=>e)),menuPso:async e=>l.post("/pso/",{start:e[0],end:e[1]}).then(e=>e.data).catch(e=>e)}}},13498:function(e,t,l){"use strict";l.d(t,{cn:function(){return n}});var a=l(44839),s=l(96164);function n(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];return(0,s.m6)((0,a.W)(t))}},25858:function(e,t,l){"use strict";l.d(t,{Z:function(){return o}});var a=l(22988),s=l(2265),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},i=l(25636),o=s.forwardRef(function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n}))})},65799:function(e,t,l){var a;a=function(e){"use strict";var t={name:"id",weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(e){return e+"."}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(t,null,!0),t},e.exports=a(l(62737))},8558:function(e){var t;t=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(a,s,n){var i=s.prototype;n.utc=function(e){var t={date:e,utc:!0,args:arguments};return new s(t)},i.utc=function(t){var l=n(this.toDate(),{locale:this.$L,utc:!0});return t?l.add(this.utcOffset(),e):l},i.local=function(){return n(this.toDate(),{locale:this.$L,utc:!1})};var o=i.parse;i.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var r=i.init;i.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else r.call(this)};var u=i.utcOffset;i.utcOffset=function(a,s){var n=this.$utils().u;if(n(a))return this.$u?0:n(this.$offset)?u.call(this):this.$offset;if("string"==typeof a&&null===(a=function(e){void 0===e&&(e="");var a=e.match(t);if(!a)return null;var s=(""+a[0]).match(l)||["-",0,0],n=s[0],i=60*+s[1]+ +s[2];return 0===i?0:"+"===n?i:-i}(a)))return this;var i=16>=Math.abs(a)?60*a:a,o=this;if(s)return o.$offset=i,o.$u=0===a,o;if(0!==a){var r=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(i+r,e)).$offset=i,o.$x.$localOffset=r}else o=this.utc();return o};var d=i.format;i.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,t)},i.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var c=i.toDate;i.toDate=function(e){return"s"===e&&this.$offset?n(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():c.call(this)};var m=i.diff;i.diff=function(e,t,l){if(e&&this.$u===e.$u)return m.call(this,e,t,l);var a=this.local(),s=n(e).local();return m.call(a,s,t,l)}}},e.exports=t()},13414:function(e,t,l){var a=l(2381).Symbol;e.exports=a},12731:function(e,t,l){var a=l(13414),s=l(37363),n=l(68391),i=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?s(e):n(e)}},93330:function(e,t,l){var a="object"==typeof l.g&&l.g&&l.g.Object===Object&&l.g;e.exports=a},37363:function(e,t,l){var a=l(13414),s=Object.prototype,n=s.hasOwnProperty,i=s.toString,o=a?a.toStringTag:void 0;e.exports=function(e){var t=n.call(e,o),l=e[o];try{e[o]=void 0;var a=!0}catch(e){}var s=i.call(e);return a&&(t?e[o]=l:delete e[o]),s}},68391:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},2381:function(e,t,l){var a=l(93330),s="object"==typeof self&&self&&self.Object===Object&&self,n=a||s||Function("return this")();e.exports=n},60555:function(e,t,l){var a=l(12731),s=l(50561);e.exports=function(e){return"number"==typeof e||s(e)&&"[object Number]"==a(e)}},50561:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}}},function(e){e.O(0,[3113,1866,9929,8173,9141,2470,3919,8348,2100,4309,428,8421,8028,3454,9689,252,1289,45,2971,7023,1744],function(){return e(e.s=51848)}),_N_E=e.O()}]);